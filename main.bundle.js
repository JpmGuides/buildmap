webpackJsonp([1],{0:function(n,l,e){n.exports=e("rl7j")},rl7j:function(n,l,e){"use strict";function t(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,0,"i",[["class","fa fa-times "],["style","font-size: 14pt"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.resetToDefault()&&t}return t},null,null))],null,null)}function o(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,36,"div",[["class","root"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275and"](16777216,null,null,1,null,t)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,null,null,12,"div",[["class","font-size-margin"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[["for","fontSize"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["font size:"])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,6,"input",[["class","form-control"],["id","fontSize"],["max","64"],["min","5"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,11)._handleInput(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,11).onTouched()&&t}if("compositionstart"===l){t=!1!==I["\u0275nov"](n,11)._compositionStart()&&t}if("compositionend"===l){t=!1!==I["\u0275nov"](n,11)._compositionEnd(e.target.value)&&t}if("change"===l){t=!1!==I["\u0275nov"](n,12).onChange(e.target.value)&&t}if("input"===l){t=!1!==I["\u0275nov"](n,12).onChange(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,12).onTouched()&&t}if("change"===l){t=!1!==o.setProperty("fontSize")&&t}if("ngModelChange"===l){t=!1!==(o.fontSize=e)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.c,[I.Renderer2,I.ElementRef,[2,B.a]],null,null),I["\u0275did"](16384,null,0,B.l,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n,l){return[n,l]},[B.c,B.l]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},{update:"ngModelChange"}),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n\n  "])),(n()(),I["\u0275eld"](0,null,null,7,"div",[["class","text-prop-colors"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,22).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,22).onClick()&&t}if("colorPickerChange"===l){t=!1!==(o.fill=e)&&t}if("colorPickerChange"===l){t=!1!==o.setProperty("fill")&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Text color"])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n\n  "])),(n()(),I["\u0275eld"](0,null,null,7,"div",[["class","text-prop-colors"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,31).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,31).onClick()&&t}if("colorPickerChange"===l){t=!1!==o.setProperty("stroke")&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Shadow color"])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n\n"]))],function(n,l){var e=l.component;n(l,3,0,e.defaults),n(l,14,0,e.fontSize),n(l,22,0,e.fill),n(l,31,0,e.stroke)},function(n,l){var e=l.component;n(l,10,0,I["\u0275nov"](l,16).ngClassUntouched,I["\u0275nov"](l,16).ngClassTouched,I["\u0275nov"](l,16).ngClassPristine,I["\u0275nov"](l,16).ngClassDirty,I["\u0275nov"](l,16).ngClassValid,I["\u0275nov"](l,16).ngClassInvalid,I["\u0275nov"](l,16).ngClassPending),n(l,21,0,e.fill),n(l,30,0,e.stroke)})}function i(n){return I["\u0275vid"](0,[(n()(),I["\u0275and"](16777216,null,null,1,null,o)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n"]))],function(n,l){n(l,1,0,l.component.properties)},null)}function r(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"text-prop",[],null,null,null,i,K)),I["\u0275did"](376832,null,0,G,[U.ColorPickerService,I.KeyValueDiffers],null,null)],function(n,l){n(l,1,0)},null)}function a(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,0,"i",[["class","fa fa-times pull-right"],["style","font-size: 14pt"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.resetToDefault()&&t}return t},null,null))],null,null)}function u(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,3,"option",[["class","form-control"]],null,null,null,null,null)),I["\u0275did"](147456,null,0,B.i,[I.ElementRef,I.Renderer2,[2,B.j]],{value:[0,"value"]},null),I["\u0275did"](147456,null,0,B.o,[I.ElementRef,I.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),I["\u0275ted"](null,["",""]))],function(n,l){n(l,1,0,l.context.$implicit),n(l,2,0,l.context.$implicit)},function(n,l){n(l,3,0,l.context.$implicit)})}function s(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,3,"option",[["class","form-control"],["required",""]],null,null,null,null,null)),I["\u0275did"](147456,null,0,B.i,[I.ElementRef,I.Renderer2,[2,B.j]],{value:[0,"value"]},null),I["\u0275did"](147456,null,0,B.o,[I.ElementRef,I.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),I["\u0275ted"](null,["",""]))],function(n,l){n(l,1,0,l.context.$implicit.name),n(l,2,0,l.context.$implicit.name)},function(n,l){n(l,3,0,l.context.$implicit.name)})}function d(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,61,"div",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275and"](16777216,null,null,1,null,a)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n   "])),(n()(),I["\u0275eld"](0,null,null,15,"div",[["class","input-form-control-margin"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Transport:"])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,9,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,l,e){var t=!0,o=n.component;if("change"===l){t=!1!==I["\u0275nov"](n,11).onChange(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,11).onTouched()&&t}if("change"===l){t=!1!==o.setTravelMean(e.target.value)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.j,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275and"](16777216,null,null,1,null,u)),I["\u0275did"](802816,null,0,W.NgForOf,[I.ViewContainerRef,I.TemplateRef,I.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,null,null,12,"div",[["class","input-form-control-margin"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[["for","lineWidth"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Line width:"])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,6,"input",[["class","form-control"],["id","lineWidth"],["max","10"],["min","0"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,28)._handleInput(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,28).onTouched()&&t}if("compositionstart"===l){t=!1!==I["\u0275nov"](n,28)._compositionStart()&&t}if("compositionend"===l){t=!1!==I["\u0275nov"](n,28)._compositionEnd(e.target.value)&&t}if("change"===l){t=!1!==I["\u0275nov"](n,29).onChange(e.target.value)&&t}if("input"===l){t=!1!==I["\u0275nov"](n,29).onChange(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,29).onTouched()&&t}if("change"===l){t=!1!==o.changeEvent()&&t}if("ngModelChange"===l){t=!1!==(o.lineWidth=e)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.c,[I.Renderer2,I.ElementRef,[2,B.a]],null,null),I["\u0275did"](16384,null,0,B.l,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n,l){return[n,l]},[B.c,B.l]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},{update:"ngModelChange"}),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n\n  "])),(n()(),I["\u0275eld"](0,null,null,7,"div",[["class","edge-prop-colors"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,39).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,39).onClick()&&t}if("colorPickerChange"===l){t=!1!==(o.lineColor=e)&&t}if("colorPickerChange"===l){t=!1!==o.colorChanged()&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Line color"])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n\n  "])),(n()(),I["\u0275eld"](0,null,null,15,"div",[["class","input-form-control-margin"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Line style:"])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,9,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,l,e){var t=!0,o=n.component;if("change"===l){t=!1!==I["\u0275nov"](n,51).onChange(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,51).onTouched()&&t}if("change"===l){t=!1!==o.setLineStyle(e.target.value)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.j,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275and"](16777216,null,null,1,null,s)),I["\u0275did"](802816,null,0,W.NgForOf,[I.ViewContainerRef,I.TemplateRef,I.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n"]))],function(n,l){var e=l.component;n(l,3,0,e.defaults),n(l,13,0,e.travelMean),n(l,18,0,e.allTravelMeans),n(l,31,0,e.lineWidth),n(l,39,0,e.lineColor),n(l,53,0,e.lineStyle),n(l,58,0,e.allLineStyles)},function(n,l){var e=l.component;n(l,10,0,I["\u0275nov"](l,15).ngClassUntouched,I["\u0275nov"](l,15).ngClassTouched,I["\u0275nov"](l,15).ngClassPristine,I["\u0275nov"](l,15).ngClassDirty,I["\u0275nov"](l,15).ngClassValid,I["\u0275nov"](l,15).ngClassInvalid,I["\u0275nov"](l,15).ngClassPending),n(l,27,0,I["\u0275nov"](l,33).ngClassUntouched,I["\u0275nov"](l,33).ngClassTouched,I["\u0275nov"](l,33).ngClassPristine,I["\u0275nov"](l,33).ngClassDirty,I["\u0275nov"](l,33).ngClassValid,I["\u0275nov"](l,33).ngClassInvalid,I["\u0275nov"](l,33).ngClassPending),n(l,38,0,e.lineColor),n(l,50,0,I["\u0275nov"](l,55).ngClassUntouched,I["\u0275nov"](l,55).ngClassTouched,I["\u0275nov"](l,55).ngClassPristine,I["\u0275nov"](l,55).ngClassDirty,I["\u0275nov"](l,55).ngClassValid,I["\u0275nov"](l,55).ngClassInvalid,I["\u0275nov"](l,55).ngClassPending)})}function p(n){return I["\u0275vid"](0,[(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,d)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n"]))],function(n,l){n(l,2,0,l.component.properties)},null)}function c(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"edge-prop",[],null,null,null,p,on)),I["\u0275did"](376832,null,0,en,[I.KeyValueDiffers],null,null)],function(n,l){n(l,1,0)},null)}function h(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,4,"div",[["class","alert fade in alert-danger"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,null,null,1,"button",[["class","close"],["data-dismiss","alert"],["type","button"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==(o._errorMessage=null)&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["\xd7"])),(n()(),I["\u0275ted"](null,["\n  ","\n"]))],null,function(n,l){n(l,4,0,l.component._errorMessage)})}function f(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,4,"div",[["class","alert fade in alert-success"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,null,null,1,"button",[["class","close"],["data-dismiss","alert"],["type","button"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==(o._infoMessage=null)&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["\xd7"])),(n()(),I["\u0275ted"](null,["\n  ","\n"]))],null,function(n,l){n(l,4,0,l.component._infoMessage)})}function g(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Please add at least one location in a day or event settings"]))],null,null)}function v(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Loading..."]))],null,null)}function m(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,7,"div",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["No map created yet."])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,null,null,1,"button",[["class","btn btn-primary"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.fetchLocationsAndGenerateMap()&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["Create map"])),(n()(),I["\u0275ted"](null,["\n"]))],null,null)}function y(n){return I["\u0275vid"](0,[(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,0,"i",[["class","fa fa-file"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "]))],null,null)}function C(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,3,"option",[["class","form-control"],["required",""]],null,null,null,null,null)),I["\u0275did"](147456,null,0,B.i,[I.ElementRef,I.Renderer2,[2,B.j]],{value:[0,"value"]},null),I["\u0275did"](147456,null,0,B.o,[I.ElementRef,I.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),I["\u0275ted"](null,["",""]))],function(n,l){n(l,1,0,l.context.$implicit.key()),n(l,2,0,l.context.$implicit.key())},function(n,l){n(l,3,0,l.context.$implicit.name)})}function P(n){return I["\u0275vid"](0,[(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,0,"i",[["class","glyphicon glyphicon-map-marker"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "]))],null,null)}function b(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,37,"div",[["class","btn-group"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,4,"div",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,1,"text-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,l,e){var t=!0,o=n.component;if("propertiesChange"===l){t=!1!==(n.parent.parent.context.$implicit.node.properties=e)&&t}if("onChange"===l){t=!1!==o.nodePropertiesChanged()&&t}return t},i,K)),I["\u0275did"](376832,null,0,G,[U.ColorPickerService,I.KeyValueDiffers],{properties:[0,"properties"],defaults:[1,"defaults"]},{onChange:"onChange"}),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,17,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,6,"label",[["btnCheckbox",""],["class","btn btn-default map-btn"]],[[2,"active",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==I["\u0275nov"](n,11).onClick()&&t}if("click"===l){t=!1!==o.toggleProperty(n.parent.parent.context.$implicit.node,"landing")&&t}return t},null,null)),I["\u0275did"](81920,null,0,J.a,[],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[J.a]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275eld"](0,null,null,0,"img",[["alt","Landing"],["height","16px"],["src","/ng-map/assets/landing.svg"],["width","16px"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n           "])),(n()(),I["\u0275eld"](0,null,null,6,"label",[["btnCheckbox",""],["class","btn btn-default map-btn"]],[[2,"active",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==I["\u0275nov"](n,19).onClick()&&t}if("click"===l){t=!1!==o.toggleProperty(n.parent.parent.context.$implicit.node,"takeoff")&&t}return t},null,null)),I["\u0275did"](81920,null,0,J.a,[],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[J.a]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275eld"](0,null,null,0,"img",[["alt","Take-off"],["height","16px"],["src","/ng-map/assets/takeoff.svg"],["width","16px"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275ted"](null,["\n\n          "])),(n()(),I["\u0275eld"](0,null,null,9,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,6,"label",[["btnCheckbox",""],["class","btn btn-default map-btn"]],[[2,"active",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==I["\u0275nov"](n,30).onClick()&&t}if("click"===l){t=!1!==o.setProperty(n.parent.parent.context.$implicit.node,"markStyle","first"===n.parent.parent.context.$implicit.node.properties.markStyle?"normal":"first")&&t}return t},null,null)),I["\u0275did"](81920,null,0,J.a,[],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[J.a]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-circle"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n           "])),(n()(),I["\u0275ted"](null,["\n        "]))],function(n,l){var e=l.component;n(l,5,0,l.parent.parent.context.$implicit.node.properties,e._seqTrip._tripData.defaultTextProp),n(l,11,0),n(l,13,0,l.parent.parent.context.$implicit.node.properties.landing),n(l,19,0),n(l,21,0,l.parent.parent.context.$implicit.node.properties.takeoff),n(l,30,0),n(l,32,0,"first"===l.parent.parent.context.$implicit.node.properties.markStyle)},function(n,l){n(l,10,0,I["\u0275nov"](l,11).state,I["\u0275nov"](l,15).ngClassUntouched,I["\u0275nov"](l,15).ngClassTouched,I["\u0275nov"](l,15).ngClassPristine,I["\u0275nov"](l,15).ngClassDirty,I["\u0275nov"](l,15).ngClassValid,I["\u0275nov"](l,15).ngClassInvalid,I["\u0275nov"](l,15).ngClassPending),n(l,18,0,I["\u0275nov"](l,19).state,I["\u0275nov"](l,23).ngClassUntouched,I["\u0275nov"](l,23).ngClassTouched,I["\u0275nov"](l,23).ngClassPristine,I["\u0275nov"](l,23).ngClassDirty,I["\u0275nov"](l,23).ngClassValid,I["\u0275nov"](l,23).ngClassInvalid,I["\u0275nov"](l,23).ngClassPending),n(l,29,0,I["\u0275nov"](l,30).state,I["\u0275nov"](l,34).ngClassUntouched,I["\u0275nov"](l,34).ngClassTouched,I["\u0275nov"](l,34).ngClassPristine,I["\u0275nov"](l,34).ngClassDirty,I["\u0275nov"](l,34).ngClassValid,I["\u0275nov"](l,34).ngClassInvalid,I["\u0275nov"](l,34).ngClassPending)})}function _(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,26,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"nodeSkipped",null],[2,"panel-open",null]],null,null,X.b,X.a)),I["\u0275did"](245760,[["group",4]],0,Y.a,[Q.a],null,null),(n()(),I["\u0275ted"](1,["\n        "])),(n()(),I["\u0275eld"](0,null,0,19,"div",[["accordion-heading",""]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,2,"i",[["class","fa fa-right-margin"],["style","font-size: 14pt"]],null,null,null,null,null)),I["\u0275did"](278528,null,0,W.NgClass,[I.IterableDiffers,I.KeyValueDiffers,I.ElementRef,I.Renderer],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),I["\u0275pod"]({"fa-caret-down":0,"fa-caret-right":1}),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,5,"input",[["class","form-control-input"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"],[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,10)._handleInput(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,10).onTouched()&&t}if("compositionstart"===l){t=!1!==I["\u0275nov"](n,10)._compositionStart()&&t}if("compositionend"===l){t=!1!==I["\u0275nov"](n,10)._compositionEnd(e.target.value)&&t}if("click"===l){t=!1!==e.stopPropagation()&&t}if("change"===l){t=!1!==o.setNodeLabel(n.parent.context.$implicit.node,e.target.value)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.c,[I.Renderer2,I.ElementRef,[2,B.a]],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.c]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n\n          "])),(n()(),I["\u0275eld"](0,null,null,5,"input",[["class","pull-right in-margin-top float-xs-right"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"],[null,"change"],[null,"blur"]],function(n,l,e){var t=!0,o=n.component;if("change"===l){t=!1!==I["\u0275nov"](n,17).onChange(e.target.checked)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,17).onTouched()&&t}if("click"===l){o.toggleSkipNode(n.parent.context.$implicit.node);t=!1!==e.stopPropagation()&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.b,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.b]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n\n        "])),(n()(),I["\u0275ted"](1,["\n        "])),(n()(),I["\u0275and"](16777216,null,1,1,null,b)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](1,["\n      "]))],function(n,l){var e=l.component;n(l,1,0);n(l,6,0,"fa fa-right-margin",n(l,7,0,null==I["\u0275nov"](l,1)?null:I["\u0275nov"](l,1).isOpen,!(null==I["\u0275nov"](l,1)?null:I["\u0275nov"](l,1).isOpen))),n(l,12,0,e.isSkipped(l.parent.context.$implicit.node),l.parent.context.$implicit.node.label),n(l,19,0,!e.isSkipped(l.parent.context.$implicit.node)),n(l,25,0,!e.isSkipped(l.parent.context.$implicit.node))},function(n,l){var e=l.component;n(l,0,0,l.parent.context.$implicit.node&&e.isSkipped(l.parent.context.$implicit.node),I["\u0275nov"](l,1).isOpen),n(l,9,0,I["\u0275nov"](l,14).ngClassUntouched,I["\u0275nov"](l,14).ngClassTouched,I["\u0275nov"](l,14).ngClassPristine,I["\u0275nov"](l,14).ngClassDirty,I["\u0275nov"](l,14).ngClassValid,I["\u0275nov"](l,14).ngClassInvalid,I["\u0275nov"](l,14).ngClassPending),n(l,16,0,I["\u0275nov"](l,21).ngClassUntouched,I["\u0275nov"](l,21).ngClassTouched,I["\u0275nov"](l,21).ngClassPristine,I["\u0275nov"](l,21).ngClassDirty,I["\u0275nov"](l,21).ngClassValid,I["\u0275nov"](l,21).ngClassInvalid,I["\u0275nov"](l,21).ngClassPending)})}function x(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,22,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"nodeSkipped",null],[2,"panel-open",null]],null,null,X.b,X.a)),I["\u0275did"](245760,[["group2",4]],0,Y.a,[Q.a],null,null),(n()(),I["\u0275ted"](1,["\n        "])),(n()(),I["\u0275eld"](0,null,0,15,"div",[["accordion-heading",""]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,2,"i",[["class","fa"],["style","font-size: 14pt"]],null,null,null,null,null)),I["\u0275did"](278528,null,0,W.NgClass,[I.IterableDiffers,I.KeyValueDiffers,I.ElementRef,I.Renderer],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),I["\u0275pod"]({"fa-caret-down":0,"fa-caret-right":1}),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[["class","italic"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,[""," - ",""])),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,5,"input",[["class","pull-right"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"],[null,"change"],[null,"blur"]],function(n,l,e){var t=!0,o=n.component;if("change"===l){t=!1!==I["\u0275nov"](n,13).onChange(e.target.checked)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,13).onTouched()&&t}if("click"===l){o.toggleHideEdge(n.parent.context.$implicit.edge);t=!1!==e.stopPropagation()&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.b,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.b]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n        "])),(n()(),I["\u0275ted"](1,["\n        "])),(n()(),I["\u0275eld"](0,null,1,1,"edge-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,l,e){var t=!0,o=n.component;if("propertiesChange"===l){t=!1!==(n.parent.context.$implicit.edge.properties=e)&&t}if("onChange"===l){t=!1!==o.edgePropertiesChanged(n.parent.context.$implicit.edge)&&t}return t},p,on)),I["\u0275did"](376832,null,0,en,[I.KeyValueDiffers],{properties:[0,"properties"],defaults:[1,"defaults"]},{onChange:"onChange"}),(n()(),I["\u0275ted"](1,["\n      "]))],function(n,l){var e=l.component;n(l,1,0);n(l,6,0,"fa",n(l,7,0,null==I["\u0275nov"](l,1)?null:I["\u0275nov"](l,1).isOpen,!(null==I["\u0275nov"](l,1)?null:I["\u0275nov"](l,1).isOpen))),n(l,15,0,!l.parent.context.$implicit.edge.properties.hidden),n(l,21,0,l.parent.context.$implicit.edge.properties,e._seqTrip._tripData.defaultEdgeProp)},function(n,l){var e=l.component;n(l,0,0,l.parent.context.$implicit.edge.properties.hidden,I["\u0275nov"](l,1).isOpen),n(l,10,0,e.origin(l.parent.context.$implicit.edge).label,e.destination(l.parent.context.$implicit.edge).label),n(l,12,0,I["\u0275nov"](l,17).ngClassUntouched,I["\u0275nov"](l,17).ngClassTouched,I["\u0275nov"](l,17).ngClassPristine,I["\u0275nov"](l,17).ngClassDirty,I["\u0275nov"](l,17).ngClassValid,I["\u0275nov"](l,17).ngClassInvalid,I["\u0275nov"](l,17).ngClassPending)})}function w(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,7,null,null,null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275and"](16777216,null,null,1,null,_)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275and"](16777216,null,null,1,null,x)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n      "]))],function(n,l){n(l,3,0,l.context.$implicit.node),n(l,6,0,l.context.$implicit.edge)},null)}function k(n){return I["\u0275vid"](0,[(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,0,"span",[["aria-hidden","true"],["class","glyphicon glyphicon-globe"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "]))],null,null)}function T(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,9,"div",[["class","panel-body"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.selectCountry(n.context.$implicit)&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["\n           "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,3).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,3).onClick()&&t}if("colorPickerChange"===l){t=!1!==o.setCountryColor(n.context.$implicit,""+e)&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"],cpToggle:[1,"cpToggle"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n           "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["",""])),(n()(),I["\u0275ted"](null,["\n           "])),(n()(),I["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-times"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.setCountryColor(n.context.$implicit,"default")&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["\n         "]))],function(n,l){var e=l.component;n(l,3,0,e.countryColor(l.context.$implicit),l.context.$implicit===e._selectedCountry)},function(n,l){n(l,2,0,l.component.countryColor(l.context.$implicit)),n(l,6,0,l.context.$implicit)})}function L(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,23,"ul",[["class","dropdown-menu dropdown-menu-right"],["role","menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.uiSetFrame()&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["Auto scroll/zoom"])),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.placeLabels()&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["Auto place labels"])),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.resetCurves()&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["Reset curves"])),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,0,"li",[["class","divider dropdown-divider"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.download("pdf")&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["Export PDF"])),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("click"===l){t=!1!==o.download("svg")&&t}return t},null,null)),(n()(),I["\u0275ted"](null,["Export SVG"])),(n()(),I["\u0275ted"](null,["\n    "]))],null,null)}function M(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,0,"div",[["class","spin-loader"]],null,null,null,null,null))],null,null)}function S(n){return I["\u0275vid"](0,[I["\u0275qud"](402653184,1,{canvas:0}),(n()(),I["\u0275eld"](0,null,null,0,"link",[["href","https://fonts.googleapis.com/css?family=PT+Sans"],["rel","stylesheet"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,h)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,f)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,g)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,v)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,m)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275eld"](0,null,null,185,"div",[],[[2,"hidden",null]],null,null,null,null)),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275eld"](0,null,null,161,"div",[["class","maptabset"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275eld"](0,null,null,158,"tabset",[["type","pills"]],[[2,"tab-container",null]],null,null,rn.b,rn.a)),I["\u0275did"](180224,null,0,an.a,[un.a],{vertical:[0,"vertical"],type:[1,"type"]},null),(n()(),I["\u0275ted"](0,["\n  "])),(n()(),I["\u0275eld"](0,null,0,117,"tab",[],[[2,"active",null],[2,"tab-pane",null]],null,null,null,null)),I["\u0275did"](212992,null,0,sn.a,[an.a,I.ElementRef,I.Renderer],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275and"](0,null,null,1,null,y)),I["\u0275did"](16384,null,0,dn.a,[I.TemplateRef,sn.a],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,110,"div",[["class","panel panel-default"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,107,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n        "])),(n()(),I["\u0275eld"](0,null,null,38,"div",[["class","panel panel-default"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,18,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,4,"div",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,1,"label",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Format/orientation"])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,9,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,l,e){var t=!0,o=n.component;if("change"===l){t=!1!==I["\u0275nov"](n,46).onChange(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,46).onTouched()&&t}if("change"===l){t=!1!==o.uiSetPageSize(e.target.value)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.j,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n               "])),(n()(),I["\u0275and"](16777216,null,null,1,null,C)),I["\u0275did"](802816,null,0,W.NgForOf,[I.ViewContainerRef,I.TemplateRef,I.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275ted"](null,["\n\n          "])),(n()(),I["\u0275eld"](0,null,null,15,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,4,"div",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,1,"label",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Zoom / center"])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275ted"](null,["\n\n            "])),(n()(),I["\u0275eld"](0,null,null,6,"input",[["id","scaleSlider"],["max","8"],["min","0"],["step","0.000001"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,66)._handleInput(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,66).onTouched()&&t}if("compositionstart"===l){t=!1!==I["\u0275nov"](n,66)._compositionStart()&&t}if("compositionend"===l){t=!1!==I["\u0275nov"](n,66)._compositionEnd(e.target.value)&&t}if("change"===l){t=!1!==I["\u0275nov"](n,67).onChange(e.target.value)&&t}if("input"===l){t=!1!==I["\u0275nov"](n,67).onChange(e.target.value)&&t}if("blur"===l){t=!1!==I["\u0275nov"](n,67).onTouched()&&t}if("change"===l){t=!1!==o.setScale(e.target.value)&&t}if("input"===l){t=!1!==o.setScale(e.target.value)&&t}return t},null,null)),I["\u0275did"](16384,null,0,B.c,[I.Renderer2,I.ElementRef,[2,B.a]],null,null),I["\u0275did"](16384,null,0,B.m,[I.Renderer2,I.ElementRef],null,null),I["\u0275prd"](1024,null,B.e,function(n,l){return[n,l]},[B.c,B.m]),I["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),I["\u0275prd"](2048,null,B.f,null,[B.h]),I["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275ted"](null,["\n        "])),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,64,"div",[["id","accordion-menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n        "])),(n()(),I["\u0275eld"](0,null,null,35,"div",[["class","menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,2,"p",[],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-map-o"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Map colors"])),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,28,"div",[["class","content collapsable-menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n\n            "])),(n()(),I["\u0275eld"](0,null,null,7,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n              "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,88).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,88).onClick()&&t}if("colorPickerChange"===l){t=!1!==o.setLandColor(e)&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n              "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Land color"])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,7,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n              "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,97).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,97).onClick()&&t}if("colorPickerChange"===l){t=!1!==o.setSeaColor(e)&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n              "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Sea color"])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275eld"](0,null,null,7,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n              "])),(n()(),I["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,l,e){var t=!0,o=n.component;if("input"===l){t=!1!==I["\u0275nov"](n,106).inputChange(e.target.value)&&t}if("click"===l){t=!1!==I["\u0275nov"](n,106).onClick()&&t}if("colorPickerChange"===l){t=!1!==o.setBorderColor(e)&&t}return t},null,null)),I["\u0275did"](606208,null,0,j.ColorPickerDirective,[I.Injector,I.ComponentFactoryResolver,I.ApplicationRef,I.ViewContainerRef,I.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),I["\u0275ted"](null,["\n              "])),(n()(),I["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Border color"])),(n()(),I["\u0275ted"](null,["\n            "])),(n()(),I["\u0275ted"](null,["\n\n      "])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n\n        "])),(n()(),I["\u0275eld"](0,null,null,11,"div",[["class","menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,2,"p",[],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-font"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Default text properties"])),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,4,"div",[["class","content collapsable-menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n\n            "])),(n()(),I["\u0275eld"](0,null,null,1,"text-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,l,e){var t=!0,o=n.component;if("propertiesChange"===l){t=!1!==(o._seqTrip._tripData.defaultTextProp=e)&&t}if("onChange"===l){t=!1!==o.nodePropertiesChanged()&&t}return t},i,K)),I["\u0275did"](376832,null,0,G,[U.ColorPickerService,I.KeyValueDiffers],{properties:[0,"properties"]},{onChange:"onChange"}),(n()(),I["\u0275ted"](null,["\n\n      "])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n\n\n        "])),(n()(),I["\u0275eld"](0,null,null,11,"div",[["class","menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,2,"p",[],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-arrows-h"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Default line properties"])),(n()(),I["\u0275ted"](null,["\n          "])),(n()(),I["\u0275eld"](0,null,null,4,"div",[["class","content collapsable-menu"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n\n\n\n            "])),(n()(),I["\u0275eld"](0,null,null,1,"edge-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,l,e){var t=!0,o=n.component;if("propertiesChange"===l){t=!1!==(o._seqTrip._tripData.defaultEdgeProp=e)&&t}if("onChange"===l){t=!1!==o.edgePropertiesChanged()&&t}return t},p,on)),I["\u0275did"](376832,null,0,en,[I.KeyValueDiffers],{properties:[0,"properties"]},{onChange:"onChange"}),(n()(),I["\u0275ted"](null,["\n\n      "])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n\n\n      "])),(n()(),I["\u0275ted"](null,["\n\n\n      "])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](0,["\n\n\n\n  "])),(n()(),I["\u0275eld"](0,null,0,13,"tab",[],[[2,"active",null],[2,"tab-pane",null]],null,null,null,null)),I["\u0275did"](212992,null,0,sn.a,[an.a,I.ElementRef,I.Renderer],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275and"](0,null,null,1,null,P)),I["\u0275did"](16384,null,0,dn.a,[I.TemplateRef,sn.a],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,6,"accordion",[["class","panel-group"],["id","long-accord"],["role","tablist"],["style","display: block"]],[[1,"aria-multiselectable",0]],null,null,xn.b,xn.a)),I["\u0275did"](49152,null,0,Q.a,[wn.a],null,null),(n()(),I["\u0275ted"](0,["\n      "])),(n()(),I["\u0275and"](16777216,null,0,1,null,w)),I["\u0275did"](802816,null,0,W.NgForOf,[I.ViewContainerRef,I.TemplateRef,I.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),I["\u0275ted"](0,["  "])),(n()(),I["\u0275ted"](0,["\n    "])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](0,["\n\n  "])),(n()(),I["\u0275eld"](0,null,0,20,"tab",[],[[2,"active",null],[2,"tab-pane",null]],null,null,null,null)),I["\u0275did"](212992,null,0,sn.a,[an.a,I.ElementRef,I.Renderer],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275and"](0,null,null,1,null,k)),I["\u0275did"](16384,null,0,dn.a,[I.TemplateRef,sn.a],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,13,"div",[["class","panel panel-default"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,10,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n        "])),(n()(),I["\u0275eld"](0,null,null,1,"label",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Country colors"])),(n()(),I["\u0275ted"](null,["\n        "])),(n()(),I["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["Click on a country to select its color"])),(n()(),I["\u0275ted"](null,["\n        "])),(n()(),I["\u0275and"](16777216,null,null,1,null,T)),I["\u0275did"](802816,null,0,W.NgForOf,[I.ViewContainerRef,I.TemplateRef,I.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](0,["\n\n"])),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275ted"](null,["\n\n"])),(n()(),I["\u0275eld"](0,null,null,3,"div",[["class","floatleft"]],[[4,"width","px"]],null,null,null,null)),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275eld"](0,[[1,0],["mapCanvas",1]],null,0,"canvas",[],[[4,"width","px"],[4,"height","px"],[1,"width",0],[1,"height",0]],null,null,null,null)),(n()(),I["\u0275ted"](null,["\n"])),(n()(),I["\u0275ted"](null,["\n\n  "])),(n()(),I["\u0275eld"](16777216,null,null,14,"span",[["class","floatright btn-group"],["dropdown",""],["style","width:auto;"]],[[2,"dropup",null],[2,"open",null],[2,"show",null]],null,null,null,null)),I["\u0275prd"](512,null,kn.a,kn.a,[]),I["\u0275did"](212992,null,0,Tn.a,[I.ElementRef,I.Renderer,I.ViewContainerRef,Ln.a,Mn.a,kn.a],null,null),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275eld"](0,null,null,6,"button",[["class","btn btn-default dropdown-toggle thinbutton"],["dropdownToggle",""],["type","button"]],[[1,"aria-haspopup",0],[1,"disabled",0],[1,"aria-expanded",0]],[[null,"click"],["document","click"],[null,"keyup.esc"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==I["\u0275nov"](n,193).onClick()&&t}if("document:click"===l){t=!1!==I["\u0275nov"](n,193).onDocumentClick(e)&&t}if("keyup.esc"===l){t=!1!==I["\u0275nov"](n,193).onEsc()&&t}return t},null,null)),I["\u0275did"](147456,null,0,Sn.a,[kn.a,I.ElementRef],null,null),(n()(),I["\u0275ted"](null,["\n      "])),(n()(),I["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-cogs"]],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,0,"br",[],null,null,null,null,null)),(n()(),I["\u0275eld"](0,null,null,0,"span",[["class","caret"]],null,null,null,null,null)),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275ted"](null,["\n    "])),(n()(),I["\u0275and"](16777216,null,null,1,null,L)),I["\u0275did"](16384,null,0,Rn.a,[kn.a,I.ViewContainerRef,I.TemplateRef],null,null),(n()(),I["\u0275ted"](null,["\n  "])),(n()(),I["\u0275ted"](null,["\n\n\n"])),(n()(),I["\u0275ted"](null,["\n\n"])),(n()(),I["\u0275and"](16777216,null,null,1,null,M)),I["\u0275did"](16384,null,0,W.NgIf,[I.ViewContainerRef,I.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),I["\u0275ted"](null,["\n"]))],function(n,l){var e=l.component;n(l,4,0,e._errorMessage),n(l,7,0,e._infoMessage),n(l,10,0,!e._loadingMap&&0==e._numLocations),n(l,13,0,e._loadingMap),n(l,16,0,e._numLocations>0&&!e._visitedPlaceList.length);n(l,23,0,!0,"pills"),n(l,26,0),n(l,48,0,e._pageSizeName),n(l,53,0,e._pageSizes),n(l,69,0,e.scale()),n(l,88,0,e._seqTrip.landColor()),n(l,97,0,e._seqTrip.seaColor()),n(l,106,0,e._seqTrip.borderColor()),n(l,123,0,e._seqTrip._tripData.defaultTextProp),n(l,136,0,e._seqTrip._tripData.defaultEdgeProp),n(l,145,0),n(l,154,0,e._interleaved),n(l,160,0),n(l,176,0,e.tunedCountries()),n(l,190,0),n(l,206,0,e._showSpinner)},function(n,l){var e=l.component;n(l,18,0,!e._visitedPlaceList.length),n(l,22,0,I["\u0275nov"](l,23).clazz),n(l,25,0,I["\u0275nov"](l,26).active,I["\u0275nov"](l,26).addClass),n(l,45,0,I["\u0275nov"](l,50).ngClassUntouched,I["\u0275nov"](l,50).ngClassTouched,I["\u0275nov"](l,50).ngClassPristine,I["\u0275nov"](l,50).ngClassDirty,I["\u0275nov"](l,50).ngClassValid,I["\u0275nov"](l,50).ngClassInvalid,I["\u0275nov"](l,50).ngClassPending),n(l,65,0,I["\u0275nov"](l,71).ngClassUntouched,I["\u0275nov"](l,71).ngClassTouched,I["\u0275nov"](l,71).ngClassPristine,I["\u0275nov"](l,71).ngClassDirty,I["\u0275nov"](l,71).ngClassValid,I["\u0275nov"](l,71).ngClassInvalid,I["\u0275nov"](l,71).ngClassPending),n(l,87,0,e._seqTrip.landColor()),n(l,96,0,e._seqTrip.seaColor()),n(l,105,0,e._seqTrip.borderColor()),n(l,144,0,I["\u0275nov"](l,145).active,I["\u0275nov"](l,145).addClass),n(l,150,0,I["\u0275nov"](l,151).closeOthers),n(l,159,0,I["\u0275nov"](l,160).active,I["\u0275nov"](l,160).addClass),n(l,183,0,e._canvasWidth),n(l,185,0,e._canvasWidth,e._canvasHeight,e._canvasWidth*e.pixelRatio(),e._canvasHeight*e.pixelRatio()),n(l,188,0,I["\u0275nov"](l,190).dropup,I["\u0275nov"](l,190).isOpen,I["\u0275nov"](l,190).isOpen&&I["\u0275nov"](l,190).isBs4);n(l,192,0,!0,I["\u0275nov"](l,193).isDisabled,I["\u0275nov"](l,193).isOpen)})}function R(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"trip-map",[],null,[["window","beforeunload"]],function(n,l,e){var t=!0;if("window:beforeunload"===l){t=!1!==I["\u0275nov"](n,1).doSomething(e)&&t}return t},S,En)),I["\u0275did"](4440064,null,0,_n,[pn.e],null,null)],function(n,l){n(l,1,0)},null)}function D(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"trip-map",[],null,[["window","beforeunload"]],function(n,l,e){var t=!0;if("window:beforeunload"===l){t=!1!==I["\u0275nov"](n,1).doSomething(e)&&t}return t},S,En)),I["\u0275did"](4440064,null,0,_n,[pn.e],null,null),(n()(),I["\u0275ted"](null,["\n"]))],function(n,l){n(l,1,0)},null)}function E(n){return I["\u0275vid"](0,[(n()(),I["\u0275eld"](0,null,null,1,"app-root",[],null,null,null,D,On)),I["\u0275did"](49152,null,0,z,[],null,null)],null,null)}Object.defineProperty(l,"__esModule",{value:!0});var I=e("/oeL"),O=function(){function n(){}return n}(),z=function(){function n(){}return n}(),N=e("A6LD"),F=e("DdBX"),q=[""],A=[".maptabset[_ngcontent-%COMP%]    .panel-title{font-size:12px}.maptabset[_ngcontent-%COMP%]    .panel-heading{padding:10px 15px}.maptabset[_ngcontent-%COMP%]    .panel{margin-bottom:1px}tabset[_ngcontent-%COMP%]    .nav-stacked{float:left}tabset[_ngcontent-%COMP%]    .tab-content{float:left;width:305px;margin-right:6px}.inline[_ngcontent-%COMP%]{display:inline-block}.floatleft[_ngcontent-%COMP%]{float:left}.floatright[_ngcontent-%COMP%]{float:right}.nodeSelected[_ngcontent-%COMP%]{font-weight:700}.nodeSkipped[_ngcontent-%COMP%]{color:gray}.small[_ngcontent-%COMP%]{width:25px;height:25px}button.delete[_ngcontent-%COMP%]{margin-top:2px;margin-right:.8em;background-color:#d3d3d3;color:red}div.maptabset[_ngcontent-%COMP%]{float:left}tab[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:100%} .square{width:10px;height:10px;display:inline-block;margin:3px}.hidden[_ngcontent-%COMP%]{display:none}.global-buttons[_ngcontent-%COMP%]{margin-bottom:20px}.maptabset[_ngcontent-%COMP%]    .nav-pills{margin-right:6px}.maptabset[_ngcontent-%COMP%]    .nav-item{border-right:1px solid #ddd;margin:0}.maptabset[_ngcontent-%COMP%]    .nav-item.active{border-top:1px solid #ddd;border-bottom:1px solid #ddd;border-left:1px solid #ddd;border-right:0}.maptabset[_ngcontent-%COMP%]    .nav-item.active  a{color:#428bca;background-color:#fff}.maptabset[_ngcontent-%COMP%]    .tab-content  button{width:100%}.spin-loader[_ngcontent-%COMP%]{position:absolute;bottom:-20px;left:0;right:0;top:-20px;z-index:10000;background:url(/assets/loader.gif) 50% no-repeat;background-size:80px 80px;background-color:rgba(0,0,0,.6);display:block}.map-colors[_ngcontent-%COMP%]{position:relative;padding:5px 0}.map-colors[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:40px;top:11px}.map-btn[_ngcontent-%COMP%]{margin-top:10px}.in-margin-top[_ngcontent-%COMP%]{margin-top:11px}.fa-right-margin[_ngcontent-%COMP%]{margin-right:7px}.form-control-input[_ngcontent-%COMP%]{display:inline-block;width:220px;height:34px;padding:6px 12px;font-size:12px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.italic[_ngcontent-%COMP%]{font-style:italic;padding-left:12px}.btn-group[_ngcontent-%COMP%]{width:100%}.form-control[_ngcontent-%COMP%]{margin-top:5px}#accordion-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding-top:5px}#accordion-menu[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{margin-right:10px;color:#428bca}#accordion-menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;cursor:pointer;padding:10px 20px;margin:0;border-top-left-radius:4px;border-top-right-radius:4px;border:1px solid #ddd;box-shadow:0 1px 1px rgba(0,0,0,.05)}#accordion-menu[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{border:1px solid #ddd;padding:20px 15px 10px;color:#333;background-color:#fff;border-color:#ddd;display:none;margin:0}#accordion-menu[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none}#accordion-menu[_ngcontent-%COMP%]   .collapsable-menu[_ngcontent-%COMP%]{display:none}#accordion-menu[_ngcontent-%COMP%]   .uncollapsable-menu[_ngcontent-%COMP%]{display:block}#long-accord[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto;padding-right:5px}#long-accord[_ngcontent-%COMP%]::-webkit-scrollbar{background-color:#eee;width:6px}#long-accord[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#999;border-radius:6px}.thinbutton[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}"],B=e("bm2B"),V=[".small[_ngcontent-%COMP%]{width:25px;height:25px}.root[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative}input[_ngcontent-%COMP%]{display:inline-block}.text-prop-colors[_ngcontent-%COMP%]{position:relative;padding:5px 0}.text-prop-colors[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:40px;top:7px}.font-size-margin[_ngcontent-%COMP%]{margin:5px 0 8px}"],W=e("qbdv"),j=e("ZHSE"),U=e("QMm5"),H=e("XB9w"),G=function(){function n(n,l){this.cpService=n,this.differs=l,this.onChange=new I.EventEmitter,this.defaultsDiffer=l.find({}).create(null),this.propertiesDiffer=l.find({}).create(null)}return n.prototype.ngOnInit=function(){},n.prototype.changeEvent=function(){this.onChange.emit(this.properties)},n.prototype.ngDoCheck=function(){var n=this.defaultsDiffer.diff(this.defaults)||this.propertiesDiffer.diff(this.properties);return n&&this.readProperties(),n},n.prototype.readProperties=function(){for(var n=0,l=["fill","stroke","fontSize"];n<l.length;n++){var e=l[n];this.properties&&e in this.properties?this[e]=this.properties[e]:this.defaults&&e in this.defaults?this[e]=this.defaults[e]:this[e]=void 0}},n.prototype.setProperty=function(n){this.properties[n]=this[n],this.changeEvent()},n.prototype.resetToDefault=function(){for(var n=0,l=Object.keys(this.properties);n<l.length;n++){var e=l[n];"firstVisited"!=e&&delete this.properties[e]}this.readProperties(),this.changeEvent()},n.ctorParameters=function(){return[{type:H.ColorPickerService},{type:I.KeyValueDiffers}]},n}(),Z=[V],K=I["\u0275crt"]({encapsulation:0,styles:Z,data:{}}),J=(I["\u0275ccf"]("text-prop",G,r,{properties:"properties",defaults:"defaults"},{properties:"properties",onChange:"onChange"},[]),e("QO87")),X=e("uDoG"),Y=e("2dRj"),Q=e("m6EG"),nn=[".small[_ngcontent-%COMP%]{width:25px;height:25px}.edge-prop-colors[_ngcontent-%COMP%]{position:relative;padding:5px 0}.edge-prop-colors[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:40px;top:7px}.input-form-control-margin[_ngcontent-%COMP%]{margin:10px 0}"],ln=function(){function n(n,l){this.name=n.replace(/-/g,"\u2501").replace(/ /g," \xa0"),this.style=l}return n.prototype.key=function(){return name},n}(),en=function(){function n(n){this.differs=n,this.onChange=new I.EventEmitter,this.defaultsDiffer=n.find({}).create(null),this.propertiesDiffer=n.find({}).create(null),this.allLineStyles=[new ln("------",[]),new ln("- - - ",[4,4]),new ln("--  --",[8,8])],this.allTravelMeans=["Unspecified","Bike","Boat","Bus","Car","Helicopter","Plane","Train","Walk"]}return n.prototype.changeEvent=function(){this.setProp("lineWidth"),this.onChange.emit(this.properties)},n.prototype.ngOnInit=function(){this.readProperties()},n.prototype.ngDoCheck=function(){var n=this.defaultsDiffer.diff(this.defaults)||this.propertiesDiffer.diff(this.properties);return n&&this.readProperties(),n},n.prototype.readProperties=function(){for(var n={lineColor:"#000000",lineWidth:2,travelMean:"Unspecified"},l=0,e=Object.keys(n);l<e.length;l++){var t=e[l];this.properties&&t in this.properties?this[t]=this.properties[t]:this.defaults&&t in this.defaults?this[t]=this.defaults[t]:this[t]=n[t]}var o;if(this.properties&&this.properties.dashed?o=this.properties.dashed:this.defaults&&this.defaults.dashed&&(o=this.defaults.dashed),o)for(var i=0,r=this.allLineStyles;i<r.length;i++){var a=r[i];this.sameStyles(a.style,o)&&(this.lineStyle=a.name)}else this.lineStyle=this.allLineStyles[0].name},n.prototype.sameStyles=function(n,l){if(!n||!l)return!1;if(n===l)return!0;if(n.length!=l.length)return!1;for(var e=0;e<n.length;++e)if(n[e]!=l[e])return!1;return!0},n.prototype.setProp=function(n){this.properties&&(this.defaults&&this[n]===this.defaults[n]?this.properties[n]&&delete this.properties[n]:this.properties[n]=this[n])},n.prototype.colorChanged=function(){this.setProp("lineColor"),this.changeEvent()},n.prototype.resetToDefault=function(){for(var n=0,l=Object.keys(this.properties);n<l.length;n++){var e=l[n];delete this.properties[e]}this.readProperties(),this.changeEvent()},n.prototype.setLineStyle=function(n){for(var l=0,e=this.allLineStyles;l<e.length;l++){var t=e[l];t.name===n&&(this.properties.dashed=t.style)}this.changeEvent()},n.prototype.setTravelMean=function(n){this.travelMean=n,this.setProp("travelMean"),this.changeEvent()},n.ctorParameters=function(){return[{type:I.KeyValueDiffers}]},n}(),tn=[nn],on=I["\u0275crt"]({encapsulation:0,styles:tn,data:{}}),rn=(I["\u0275ccf"]("edge-prop",en,c,{properties:"properties",defaults:"defaults"},{properties:"properties",onChange:"onChange"},[]),e("UbUN")),an=e("1sP3"),un=e("5bcs"),sn=e("Fw80"),dn=e("Djd0"),pn=e("CPp0"),cn=function(){function n(n,l){if("number"==typeof n&&"number"==typeof l?(this.x=n,this.y=l):Array.isArray(n)?(this.x=n[0],this.y=n[1]):"object"==typeof n&&(this.x=n.x,this.y=n.y),void 0===this.x||void 0===this.y)throw new Error("invalid point")}return n.minus=function(l,e){return new n(l.x-e.x,l.y-e.y)},n.plus=function(l,e){return new n(l.x+e.x,l.y+e.y)},n.times=function(l,e){return new n(l*e.x,l*e.y)},n.min=function(l,e){return new n(Math.min(l.x,e.x),Math.min(l.y,e.y))},n.max=function(l,e){return new n(Math.max(l.x,e.x),Math.max(l.y,e.y))},n.dist=function(n,l){var e=n.x-l.x,t=n.y-l.y;return Math.sqrt(e*e+t*t)},n.norm=function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},n.nearest=function(l,e){for(var t,o,i=0,r=e;i<r.length;i++){var a=r[i],u=n.dist(a,l);(void 0===t||u<o)&&(o=u,t=a)}return t},n.prototype.add=function(n){return this.x+=n.x,this.y+=n.y,this},n.prototype.sub=function(n){return this.x-=n.x,this.y-=n.y,this},n.prototype.mul=function(n){return this.x*=n,this.y*=n,this},n.prototype.norm=function(){return n.norm(this)},n}(),hn=function(){function n(n){n&&(n.min&&(this.min=new cn(n.min)),n.max&&(this.max=new cn(n.max)))}return n.closestPoint=function(n,l){var e=new cn(0,0);for(var t in e)n[t]<l.min[t]?e[t]=l.min[t]:n[t]>l.max[t]?e[t]=l.max[t]:e[t]=n[t];return e},n.overlaps=function(n,l){return!(n.max.x<l.min.x||n.min.x>l.max.x||n.max.y<l.min.y||n.min.y>l.max.y)},n.contains=function(n,l){return l.x>=n.min.x&&l.x<=n.max.x&&l.y>=n.min.y&&l.y<=n.max.y},n.prototype.addPoint=function(n){this.min=void 0===this.min?n:cn.min(this.min,n),this.max=void 0===this.max?n:cn.max(this.max,n)},n.prototype.addArray=function(n){for(var l=0,e=n;l<e.length;l++){var t=e[l];this.addPoint(t)}},n.prototype.overlaps=function(l){return n.overlaps(this,l)},n.prototype.contains=function(l){return n.contains(this,l)},n}(),fn=function(){function n(n){var l=n||{};this.nodes=l.node||{},this.edges=l.edges||[]}return n.generateControlPoints=function(n,l,e,t){var o=cn.minus(e,l).mul(1/3),i=new cn(-o.y,o.x);return[cn.plus(cn.plus(l,o),i),cn.plus(cn.minus(e,o),i)]},n.bezierFromPoints=function(n){for(var l=[],e=0;e<4;++e)l.push(n[e].x),l.push(n[e].y);return new Bezier(l)},n.bezierThroughPoints=function(l){for(var e=[],t=1;t<l.length;++t){var o=1===t?l[t-1]:l[t-2],i=l[t-1],r=l[t],a=t===l.length-1?l[t]:l[t+1];e.push(n.bezierFromPoints([i,cn.plus(i,cn.times(.2,cn.minus(r,o))),cn.plus(r,cn.times(.2,cn.minus(i,a))),r]))}return e},n.placeLeaderLine=function(n){n.properties||(n.properties={});var l,e=n.properties.leaderLine||"bestAnchor",t=n.properties.labelBbox;if("center"===e){var o=(t.max.x,t.min.x,new cn((t.min.x+t.max.x)/2,(t.min.y+t.max.y)/2)),i=cn.minus(n.coord,o);i.mul(.02),l=cn.plus(o,i)}else l="closestOnBbox"===e?hn.closestPoint(n.coord,t):d3.labeler.closestLineAnchorPoint(n.coord,{left:t.min.x,right:t.max.x,top:t.min.y,bottom:t.max.y,cx:(t.min.x+t.max.x)/2,cy:(t.min.y+t.max.y)/2});n.properties.leaderLineAnchor=l},n.prototype.createDefaultBezier=function(){for(var l in this.edges){var e=this.edges[l],t=this.nodes[e.from],o=this.nodes[e.to];e.controlPoints=n.generateControlPoints(void 0,t.coord,o.coord,void 0)}},n.prototype.bezier=function(l){if(!l.controlPoints||l.properties.hidden)return[];if(2===l.controlPoints.length){var e=[this.nodes[l.from].coord,l.controlPoints[0],l.controlPoints[1],this.nodes[l.to].coord];return[n.bezierFromPoints(e)]}if(5===l.controlPoints.length){var t=[this.nodes[l.from].coord,l.controlPoints[0],l.controlPoints[1],l.controlPoints[2]],o=[l.controlPoints[2],l.controlPoints[3],l.controlPoints[4],this.nodes[l.to].coord];return[n.bezierFromPoints(t),n.bezierFromPoints(o)]}var i=[this.nodes[l.from].coord].concat(l.controlPoints,[this.nodes[l.to].coord]);return n.bezierThroughPoints(i)},n.prototype.bounds=function(){var n=new hn;for(var l in this.nodes)n.addPoint(this.nodes[l].coord);return n},n.prototype.frame=function(n,l){var e=this.bounds();if(l=l||1.1,e.max&&e.min){if(e.min.x===e.max.x){var t=new cn(1/32,1/32);e.addPoint(cn.plus(e.min,t)),e.addPoint(cn.minus(e.min,t))}}else e.min=new cn(0,0),e.max=new cn(1,1),l=1;n=n||(e.max.x-e.min.x)/(e.max.y-e.min.y);var o="number"==typeof l?new cn(l,l):l,i=cn.minus(e.max,e.min);i.x*=o.x,i.y*=o.y;var r,a=i.y*n;r=i.x>a?new cn(i.x,i.x/n):new cn(i.y*n,i.y),r.mul(.5);var u=cn.times(.5,cn.plus(e.max,e.min)),s=new hn;return s.addPoint(cn.minus(u,r)),s.addPoint(cn.plus(u,r)),s},n.prototype.location=function(n,l){var e=this.frame(n,l);e.max.x,e.min.x;return{x:(e.max.x+e.min.x)/2,y:(e.max.y+e.min.y)/2,scale:Math.max(1/32768,e.max.x-e.min.x)}},n}(),gn=function(){function n(n,l){this.graph=l,this.renderer=n}return n.prototype.acceptTouchEvent=function(n,l,e){if("wheel"===e)return!1;this.startWorldPos=new cn(l);var t=this.findLabelAtWorldPos(this.startWorldPos);if(t){this.selectLabel(t);var o=t.properties;return this.applyDelta=function(n){o.labelCoord.x+=n.x,o.labelCoord.y+=n.y,o.labelBbox.min.x+=n.x,o.labelBbox.min.y+=n.y,o.labelBbox.max.x+=n.x,o.labelBbox.max.y+=n.y,fn.placeLeaderLine(t),this.onLabelMoved&&this.onLabelMoved(t)},!0}var i=this.closestBezier(l),r=this.renderer.pinchZoom.worldDistanceFromViewerDistance(10*this.renderer.pixelRatio);if(i&&i.d<r){var a=this,u=function(n){a.applyDelta=function(l){for(var e=Array.isArray(n)?n:[n],t=0,o=e;t<o.length;t++){var r=o[t];r.x+=l.x,r.y+=l.y}this.onBezierMoved&&this.onBezierMoved(i)}},s=function(n,l,e){a.applyDelta=function(e){n.x+=e.x,n.y+=e.y,l.x+=e.x/2,l.y+=e.y/2}};return 2===i.edge.controlPoints.length?u(i.edge.controlPoints[i.t<.5?0:1]):5===i.edge.controlPoints.length?i.bezier.points[1].x===i.edge.controlPoints[0].x&&i.bezier.points[1].y===i.edge.controlPoints[0].y?i.t<.5?u(i.edge.controlPoints[0]):i.t<.9?s(i.edge.controlPoints[1],i.edge.controlPoints[2],i.edge.controlPoints[3]):u([i.edge.controlPoints[1],i.edge.controlPoints[2],i.edge.controlPoints[3]]):i.t<.1?u([i.edge.controlPoints[1],i.edge.controlPoints[2],i.edge.controlPoints[3]]):i.t<.5?s(i.edge.controlPoints[3],i.edge.controlPoints[2],i.edge.controlPoints[1]):u(i.edge.controlPoints[4]):u(cn.nearest(l,i.edge.controlPoints)),this.selectBezier(i),!0}return this.applyDelta=void 0,!1},n.prototype.selectLabel=function(n){this.selectedLabel&&delete this.selectedLabel.properties.frame,this.selectedLabel=void 0,this.selectBezier(),this.selectedLabel=n,this.onLabelSelect&&this.onLabelSelect(n),n&&(n.properties=n.properties||{},n.properties.frame="#000000"),this.renderer.refreshIfNotMoving()},n.prototype.deselectLabel=function(){return this.selectLabel()},n.prototype.handleMouseDown=function(n){n.preventDefault()},n.prototype.handleMouseMove=function(n){n.preventDefault();var l=Utils.eventPosInElementCoordinates(n,n.srcElement);this.handleMotion(l)},n.prototype.handleMotion=function(n){if(this.applyDelta){var l=this.renderer.pinchZoom.worldPosFromViewerPos(n.x,n.y),e={x:l.x-this.startWorldPos.x,y:l.y-this.startWorldPos.y};this.startWorldPos=l,this.applyDelta(e),this.renderer.refreshIfNotMoving()}},n.prototype.handleMouseUp=function(n){n.preventDefault(),this.applyDelta=void 0},n.prototype.handleMouseWheel=function(n){n.preventDefault()},n.prototype.handleStart=function(n){n.preventDefault()},n.prototype.handleEnd=function(n){n.preventDefault(),this.applyDelta=void 0},n.prototype.handleMove=function(n){if(n.preventDefault(),1!==n.touches.length)return void(this.applyDelta=void 0);var l=Utils.eventPosInElementCoordinates(n.touches[0],n.srcElement);this.handleMotion(l)},n.prototype.closestBezier=function(n){for(var l,e=0,t=this.graph.edges;e<t.length;e++)for(var o=t[e],i=this.graph.bezier(o),r=0,a=i;r<a.length;r++){var u=a[r],s=u.project(n);(!l||s.d<l.d)&&(l=s,l.edge=o,l.bezier=u)}return l},n.prototype.findLabelAtWorldPos=function(n){var l=this.graph.nodes;for(var e in l)if(l.hasOwnProperty(e)){var t=this.graph.nodes[e];if(t.properties&&t.properties.labelBbox&&hn.contains(t.properties.labelBbox,n))return t}},n.prototype.selectBezier=function(n){if(this.selectedBezier){var l=this.selectedBezier.edge;delete l.drawMiddlePoint,void 0!==l.properties._lineWidth?(l.properties.lineWidth=l.properties._lineWidth,delete l.properties._lineWidth):delete l.properties.lineWidth}if(this.selectedBezier=n,n){var l=n.edge;l.drawMiddlePoint=!0,void 0!==l.properties._lineWidth&&(l.properties._lineWidth=l.properties.lineWidth),l.properties.lineWidth=5}this.selectedLabel&&this.deselectLabel(),this.onBezierSelect&&this.onBezierSelect(this.selectedBezier),this.renderer.refreshIfNotMoving()},n}(),vn=function(){function n(n){if(this.params=n,this.renderer=n.renderer,this.defaultRadius=n.defaultRadius||6,this.icons={},this.defaultTextProp={fontSize:n.defaultFontSize||20,stroke:"rgba(255,255,255,.8)",fill:"#000000"},this.defaultEdgeProp={lineWidth:1,lineColor:"#000000"},!this.renderer)throw new Error("TripGraphLayer: no renderer !");this.graph=n.graph||new fn}return n.prototype.draw=function(n,l,e,t){for(var o=this.graph,i=n.getContext("2d"),r=this.renderer.pixelRatio,a=0,u=o.edges;a<u.length;a++){var s=u[a];this.drawEdge(i,l,s,r)}i.setLineDash([]);for(var d in o.nodes){var p=o.nodes[d];p.viewerPos=l.viewerPosFromWorldPos(p.coord)}for(var d in o.nodes){var p=o.nodes[d];this.drawNodePoint(i,l,p)}for(var d in o.nodes){var p=o.nodes[d];this.drawLeaderLine(i,l,p)}for(var d in o.nodes){var p=o.nodes[d];this.drawNodeLabel(i,l,p)}},n.prototype.drawEdge=function(n,l,e,t){this.setEdgeStrokeStyle(n,e);for(var o=this.graph.bezier(e),i=0,r=o;i<r.length;i++){var a=r[i];this.drawBezier(n,l,a,t,e)}if(o.length>1&&e.drawMiddlePoint)for(var u in o){var s=l.viewerPosFromWorldPos(o[u].points[3]),d=5*t;n.beginPath(),n.arc(s.x,s.y,d,0,2*Math.PI,!1),n.fillStyle="#000000",n.fill()}},n.prototype.drawBezier=function(n,l,e,t,o){n.save();for(var i=new Array(8),r=e.points,a=0;a<4;++a){var u=l.viewerPosFromWorldPos(r[a]);i[2*a]=u.x,i[2*a+1]=u.y}var s=new Bezier(i),d=s.length(),p=Math.min(2,Math.floor(d/(40*t))),c=s.points;n.beginPath(),n.moveTo(c[0].x,c[0].y),n.bezierCurveTo(c[1].x,c[1].y,c[2].x,c[2].y,c[3].x,c[3].y),n.stroke();for(var h=1;h<p;++h){var f=h/p,u=new cn(s.get(f)),g=new cn(s.normal(f)),v=new cn(s.derivative(f));this.drawEdgeMark(u,g,v,n,t,o)}n.restore()},n.prototype.drawEdgeMark=function(l,e,t,o,i,r){switch(this.edgeProperty(r,"travelMean")){case"Bike":case"Boat":case"Bus":case"Car":case"Helicopter":case"Plane":case"Train":case"Walk":this.drawEdgeMarkIcon(l,e,t,o,i,r);break;case"Unspecified":default:n.drawEdgeMarkTriangle(l,e,t,o,i)}},n.drawEdgeMarkTriangle=function(n,l,e,t,o){var i=10*o;e.mul(i/e.norm()),n=cn.plus(n,cn.times(.5,e));var r=cn.minus(n,e);t.beginPath(),t.moveTo(r.x+i/2*l.x,r.y+i/2*l.y),t.lineTo(n.x,n.y),t.lineTo(r.x-i/2*l.x,r.y-i/2*l.y),t.closePath(),t.fill()},n.prototype.drawEdgeMarkIcon=function(n,l,e,t,o,i){t.fillStyle="#fff",t.setLineDash([]),t.lineWidth=1*o;var r=10*o,a=6*o;e=e.mul(1/e.norm());var u=cn.plus(n,cn.times((r+a)/2,e)),s=cn.minus(n,cn.times((r+a)/2,e)),d=cn.plus(s,cn.times(r,e)),p=new cn(-e.y,e.x).mul(4*o),c=cn.plus(d,p),h=cn.minus(d,p),f=cn.minus(c,s),g=Math.atan2(f.y,f.x),v=cn.minus(h,s),m=Math.atan2(v.y,v.x);t.beginPath(),t.arc(s.x,s.y,r,g,m),t.lineTo(u.x,u.y),t.closePath(),t.fill(),t.stroke(),t.fillStyle="#000",t.textAlign="center",t.textBaseline="middle",t.font="10px FontAwesome";var y={Bike:"\uf206",Boat:"\uf21a",Bus:"\uf207",Car:"\uf1b9",Helicopter:"H",Plane:"\uf072",Train:"\uf238",Walk:"\uf183"},C=this.edgeProperty(i,"travelMean");t.fillText(y[C],s.x,s.y)},n.prototype.edgeProperty=function(n,l){return n.properties[l]||this.defaultEdgeProp[l]},n.prototype.setEdgeStrokeStyle=function(n,l){var e=this.edgeProperty(l,"lineColor");n.strokeStyle=e,n.fillStyle=e,n.lineWidth=this.renderer.pixelRatio*this.edgeProperty(l,"lineWidth"),this.setDashStyle(n,this.edgeProperty(l,"dashed"))},n.prototype.nodeRadius=function(n){var l=this.defaultRadius;return n.properties&&n.properties.radius&&(l=n.properties.radius),l*this.renderer.pixelRatio},n.prototype.drawNodePoint=function(n,l,e){if(!e.properties||0!=e.properties.point){var t=e.viewerPos;this.drawPoint(n,t,this.renderer.pixelRatio,e.properties||{})}},n.prototype.drawNodeLabel=function(l,e,t){if(t.label||t.labelIcon){var o=e.viewerPosFromWorldPos(t.properties&&t.properties.labelCoord?t.properties.labelCoord:t.coord);if(t.label&&n.drawText(l,t.label,o,this.renderer.pixelRatio,t.properties||{},this.defaultTextProp),t.labelIcon&&t.labelIcon.url in this.icons){if(void 0!=t.labelIcon.autorotate&&t.properties.labelCoord){var i=new cn(t.coord);t.labelIcon.angle=t.labelIcon.autorotate+Math.atan2(i.y-t.properties.labelCoord.y,i.x-t.properties.labelCoord.x)}n.drawIcon(l,this.icons[t.labelIcon.url],t.labelIcon,o,this.renderer.pixelRatio)}if(t.properties&&t.properties.frame&&t.label){var r=n.measureText(l,t.label,this.renderer.pixelRatio,t.properties||{},this.defaultTextProp);l.strokeStyle=t.properties.frame,r.width+=3*this.renderer.pixelRatio,r.height+=3*this.renderer.pixelRatio,l.rect(o.x-r.width/2,o.y-r.height/2,r.width,r.height),l.stroke()}}},n.prototype.setDashStyle=function(n,l){var e=[];if(l)for(var t=0,o=l;t<o.length;t++){var i=o[t];e.push(this.renderer.pixelRatio*i)}n.setLineDash(e)},n.prototype.drawLeaderLine=function(n,l,e){if(e.properties&&e.properties.leaderLineAnchor){var t=this.renderer.pixelRatio,o=l.viewerPosFromWorldPos(e.properties.leaderLineAnchor);n.lineWidth=(e.properties.leaderLineWidth||1)*t,n.beginPath();var i=l.viewerPosFromWorldPos(e.coord),r=this.nodeRadius(e),a=l.viewerPosFromWorldPos(hn.closestPoint(new cn(e.coord),e.properties.labelBbox));cn.dist(a,i)>3*r&&(e.properties.dashed&&this.setDashStyle(n,e.properties.dashed),n.moveTo(o.x,o.y),n.lineTo(i.x,i.y),n.strokeStyle=e.properties.leaderLineColor||"#000000",n.stroke(),e.properties.dashed&&n.setLineDash([]))}},n.prototype.drawPoint=function(n,l,e,t){n.strokeStyle="rgba(0,0,0,1)",n.fillStyle="rgba(255,255,255,1)",n.lineWidth=2*e,n.beginPath();var o=(t.radius||this.defaultRadius)*e;n.arc(l.x,l.y,o,0,2*Math.PI,!1),n.stroke(),n.fill();var i=t.markStyle;!i&&t.firstVisited&&(i="first"),"first"===i&&(n.fillStyle="rgba(0, 0, 0, 1)",n.beginPath(),n.arc(l.x,l.y,.6*o,0,2*Math.PI,!1),n.fill())},n.measureText=function(l,e,t,o,i){var r=e.split("\n"),a=n.setTextStyle(l,t,o,i),u={width:0,height:a*r.length};for(var s in r)u.width=Math.max(u.width,l.measureText(r[s]).width);return u},n.setTextStyle=function(n,l,e,t){e=e||{};var o=e.fontSize||t.fontSize;return o*=l,n.font=o+"px "+(e.font||"'PT Sans', sans-serif"),n.strokeStyle=e.stroke||t.stroke,n.lineWidth=(e.haloWidth||4)*l,n.fillStyle=e.fill||t.fill,parseInt(""+o)},n.drawText=function(l,e,t,o,i,r){var a,u,s=(void 0!=i.textOffset?i.textOffset:20)*o,d=((i.textPlacement||"S")+"").toUpperCase();switch(d){default:case"C":case"N":case"S":l.textAlign="center",a=0;break;case"E":case"NE":l.textAlign="start",a=s;break;case"O":case"W":l.textAlign="end",a=-s}switch(d){case"C":case"E":case"W":case"O":l.textBaseline="middle",u=0;break;case"N":case"NE":l.textBaseline="bottom",u=-s;break;default:case"S":l.textBaseline="top",u=s}var p=t.x+a,c=t.y+u,h=n.setTextStyle(l,o,i,r),f=e.split("\n");l.shadowBlur=3*o,l.shadowColor="#ffffff",l.lineWidth=2*o;for(var g=(f.length-1)/2,v=0;v<f.length;++v){var m=c+(v-g)*h;l.strokeText(f[v],p,m),l.fillText(f[v],p,m)}l.shadowColor="transparent"},n.drawIcon=function(n,l,e,t,o){if(l){var i=e.width?e.width*o:16*o,r=e.height?e.height*o:i,a="ratioX"in e?e.ratioX:.5,u="ratioY"in e?e.ratioY:.5,s=i*a,d=r*u;e.angle?(n.save(),n.translate(t.x,t.y),n.rotate(e.angle),n.drawImage(l,-s,-d,i,r),n.restore()):n.drawImage(l,t.x-s,t.y-d,i,r)}},n.prototype.getLabelIconSize=function(n,l){var e=this.renderer.pixelRatio,t=l.labelIcon;return{width:(t.width||16)*e,height:(t.height||t.width||16)*e}},n.prototype.placeLabels=function(l){var e=this.renderer.pinchZoom,t=this.renderer.pixelRatio,o=[],i=[];for(var r in this.graph.nodes){var a=this.graph.nodes[r];if(a.label||a.labelIcon){var u=e.viewerPosFromWorldPos(a.coord),s=this.defaultRadius;a.properties&&a.properties.radius&&(s=a.properties.radius),i.push({x:u.x,y:u.y,r:s*t});var d=2*t,p=void 0,c=void 0;a.label?(p=n.measureText(l,a.label,t,a.properties,this.defaultTextProp),c=a.label):a.labelIcon&&(p=this.getLabelIconSize(l,a),c="icon:"+a.labelIcon.url),o.push({x:u.x,y:u.y,name:c,width:p.width+2*d,height:p.height+2*d,node:a})}}var h=d3.labeler().label(o).anchor(i).width(this.renderer.canvas.width).height(this.renderer.canvas.height),f=h.alt_energy(),g=[],v=[],m=[];for(var y in this.graph.edges){var C=this.graph.bezier(this.graph.edges[y]);for(var r in C){var P=C[r];g.push(P);var b=P.bbox();v.push({min:e.viewerPosFromWorldPos(b.x.min,b.y.min),max:e.viewerPosFromWorldPos(b.x.max,b.y.max)});var _=P.getLUT(30),x=[];for(var w in _)x.push(e.viewerPosFromWorldPos(_[w]));m.push(x)}}h.alt_energy(function(n,l,e){var t=0,o=h.boxOfLabel(n),i=new hn;i.addPoint(new cn(o.left,o.top)),i.addPoint(new cn(o.right,o.bottom));for(var r in g)if(hn.overlaps(v[r],i)){var a=m[r];for(var u in a)i.contains(a[u])&&t++}return 10*t+f(n)});h.start(5e3,1);for(var r in o){var k=o[r];k.node.properties||(k.node.properties={});var T=k.node.properties,L=cn.times(.5,new cn(k.width,k.height));T.labelCoord=e.worldPosFromViewerPos(k),T.labelBbox={min:e.worldPosFromViewerPos(cn.minus(k,L)),max:e.worldPosFromViewerPos(cn.plus(k,L))},fn.placeLeaderLine(k.node),T.textPlacement="C",T.textOffset=0}},n.shallowCopy=function(n){var l,e=Object.create(Object.getPrototypeOf(n)),t=Object.getOwnPropertyNames(n);for(l=0;l<t.length;l++)Object.defineProperty(e,t[l],Object.getOwnPropertyDescriptor(n,t[l]));return e},n.prototype.makeFusedGraph=function(l){l=l||this.graph;var e={},t=function(n){for(var l=n;l in e;)l=e[l];return l},o=this.renderer.pinchZoom;for(var i in l.nodes){var r=l.nodes[i];r.viewerPos=o.viewerPosFromWorldPos(r.coord)}var a=[];for(var u in l.nodes){var r=l.nodes[u];if(r.label){var s=this.nodeRadius(r),d=!0;for(var i in a){var p=a[i];if(cn.dist(p.viewerPos,r.viewerPos)<this.nodeRadius(p)+s){a[i]=function(l,t){var o=n.shallowCopy(l);return o.name=l.name+","+t.name,o.label=l.label+"\n"+t.label,e[l.name]=e[t.name]=o.name,o}(p,r),d=!1;break}}d&&a.push(r)}}for(var u in l.nodes){var r=l.nodes[u];r.label||a.push(r)}var c=new fn;for(var i in a){var p=a[i];c.nodes[p.name]=p}for(var i in l.edges){var h=l.edges[i],f=t(h.from),g=t(h.to);if(f!=g){var v=n.shallowCopy(h);v.from=f,v.to=g,v.originalEdge=h,c.edges.push(v)}}return c},n.prototype.forEachNode=function(n){for(var l in this.graph.nodes)n(this.graph.nodes[l])},n.prototype.loadIcons=function(n){var l=this;this.iconsToLoad=1,this.failedIcons=0;var e=function(){l.iconsToLoad--,n&&0===l.iconsToLoad&&(l.failedIcons>0?n(new Error(l.failedIcons+" icons failed to load.")):n())};this.forEachNode(function(n){if(n.labelIcon){var t=n.labelIcon.url;l.iconsToLoad++,l.renderer.loadImage(n.labelIcon.url,function(n){l.icons[t]=n,e()},function(n){console.log("Failed to load: "+t),l.failedIcons++,e()})}}),e()},n}(),mn=function(){function n(){this.allPlaces=[]}return n.parse=function(l){var e=new n;e.coord=new cn(l.coord),l.place&&(l.place=n.parse(l.place)),l.viewerPos&&(e.viewerPos=new cn(l.viewerPos));for(var t=0,o=["dbid","name","label","labelIcon","properties"];t<o.length;t++){var i=o[t];l[i]&&(e[i]=l[i])}return e.name||(void 0!==e.dbid?e.name=""+e.dbid:e.label&&(e.name=e.label)),e.properties?(e.properties.labelBbox&&(e.properties.labelBbox=new hn(e.properties.labelBbox)),e.properties.leaderLineAnchor&&(e.properties.leaderLineAnchor=new cn(e.properties.leaderLineAnchor)),e.properties.labelCoord&&(e.properties.labelCoord=new cn(e.properties.labelCoord))):e.properties={},e},n.prototype.isSkipped=function(){return!(this.label&&(!this.properties||void 0===this.properties.skip))&&this.properties.skip},n}(),yn=function(){function n(l){if(this.properties={},l){if(l.controlPoints){this.controlPoints=[];for(var e=0;e<l.controlPoints.length;++e)this.controlPoints[e]=new cn(l.controlPoints[e])}l.originalEdge&&(this.originalEdge=new n(l.originalEdge));for(var t=0,o=["from","to","drawMiddlePoint","properties","fromDbId"];t<o.length;t++){var i=o[t];i in l&&(this[i]=l[i])}}}return n.prototype.propagateToOriginal=function(){if(this.originalEdge)for(var n=0,l=["controlPoints","drawMiddlePoint"];n<l.length;n++){var e=l[n];e in this&&(this.originalEdge[e]=this[e])}},n}(),Cn=function(){function n(){this.reset()}return n.makePlaneIcon=function(n,l){var e=new mn;return e.name=l.dbid+"-"+n,e.labelIcon={url:"/ng-map/assets/plane.png",width:20,autorotate:Math.PI/2*("landing"===n?1:-1),ratioX:.5,ratioY:"landing"===n?0:1},e.coord=l.coord,e.properties={point:!1,leaderLine:"center",dashed:[5,3],leaderLineWidth:2},e},n.prototype.places=function(){return this._tripData.places},n.prototype.stages=function(){return this._tripData.stages},n.prototype.setLocation=function(n){this._tripData.location=n},n.prototype.location=function(){return this._tripData.location},n.prototype.width_mm=function(){return this._tripData.width},n.prototype.height_mm=function(){return this._tripData.height},n.prototype.pageSizeName=function(){return this._tripData.pageSizeName},n.prototype.world=function(){return this._tripData.world||(this._tripData.world={}),this._tripData.world},n.prototype.setSize=function(n,l,e){this._tripData.width=l,this._tripData.height=e,this._tripData.pageSizeName=n},n.prototype.defaultRadius=function(){return this._tripData.defaultRadius},n.prototype.defaultTextProp=function(){return this._tripData.defaultTextProp||(this._tripData.defaultTextProp={}),this._tripData.defaultTextProp},n.prototype.defaultEdgeProp=function(){return this._tripData.defaultEdgeProp||(this._tripData.defaultEdgeProp=n.defaultTrip().defaultEdgeProp),this._tripData.defaultEdgeProp},n.prototype.reset=function(){this._tripData=n.defaultTrip()},n.defaultTrip=function(){return{places:[],stages:[],additionalPlaces:[],location:{x:.5,y:.5,scale:1/8},defaultRadius:8,width:128,height:190,pageSizeName:"Full page",borderColor:"#fefefe",landColor:"#cecece",seaColor:"#c4e3ff",world:{},defaultTextProp:{fontSize:12,font:"'PT Sans', sans-serif",stroke:"rgba(255,255,255,.8)",fill:"#000000"},defaultEdgeProp:{lineWidth:2,lineColor:"#000000"}}},n.prototype.setPlaces=function(n){this._tripData.places.splice.apply(this._tripData.places,[0,this._tripData.places.length].concat(n)),this.updateStages(),this.updateLandingsAndTakeoff()},n.prototype.stagesAsDict=function(){for(var n={},l=0,e=this._tripData.stages;l<e.length;l++){var t=e[l];t.from in n||(n[t.from]={}),n[t.from][t.to]=t}return n},n.prototype.updateStages=function(){for(var n=this._tripData.places,l=n.length-1,e=(this._tripData.stages,[]),t=this.stagesAsDict(),o=1;o<=l;++o){var i=n[o-1].dbid,r=n[o].dbid;if(t[i]&&t[i][r]){var a=t[i][r];a.to=n[o].name,e.push(a)}else e.push(new yn({from:n[o-1].name,to:n[o].name,fromDbId:i,controlPoints:fn.generateControlPoints(o>=2?n[o-2].coord:void 0,n[o-1].coord,n[o].coord,o+1<n.length?n[o+1].coord:void 0)}))}this._tripData.stages.splice.apply(this._tripData.stages,[0,this._tripData.stages.length].concat(e))},n.prototype.updateLandingsAndTakeoff=function(){for(var l={},e=this._tripData.additionalPlaces,t=0;t<e.length;++t)l[e[t].name]=t;for(var o=[],i={},r=["landing","takeoff"],a=0,u=this._tripData.places;a<u.length;a++)for(var s=u[a],d=0,p=r;d<p.length;d++){var c=p[d],h=s.dbid+"-"+c;s.properties[c]?h in l||o.push(n.makePlaneIcon(c,s)):h in l&&(i[h]=!0)}var f=e.filter(function(n){return!(n.name in i)}).concat(o);this._tripData.additionalPlaces.splice.apply(this._tripData.additionalPlaces,[0,this._tripData.additionalPlaces.length].concat(f))},n.prototype.nodeRadius=function(n,l){var e=this._tripData.defaultRadius;return n.properties&&n.properties.radius&&(e=n.properties.radius),e*l},n.prototype.makeGraph=function(n){for(var l={},e=(function(n){for(var e=n;e in l;)e=l[e];return e}),t=0,o=this._tripData.places;t<o.length;t++){var i=o[t];if(!i.name)throw new Error("nodes should have names and labels")}var r=[];if(n){for(var a=n.renderer.pinchZoom,u=n.renderer.pixelRatio,s=0,d=this._tripData.places;s<d.length;s++){var p=d[s];p.viewerPos=a.viewerPosFromWorldPos(p.coord)}for(var c=0,h=this._tripData.places;c<h.length;c++){var p=h[c];if(!(!p.label||p.properties&&p.properties.skip)){for(var f=this.nodeRadius(p,u),g=!0,v=0;v<r.length;++v){var i=r[v];if(cn.dist(i.viewerPos,p.viewerPos)<this.nodeRadius(i,u)+f){r[v]=function(n,e){var t=mn.parse(n);t.name=n.name+","+e.name,t.allPlaces=n.allPlaces.concat([e]);var o=n.label.split("\n");return o.indexOf(e.label)<0&&o.push(e.label),t.label=o.join("\n"),l[n.name]=l[e.name]=t.name,t}(i,p),g=!1;break}}if(g){p.properties||(p.properties={});var m=mn.parse(p);m.place=p,m.allPlaces=[p],r.push(m)}}}}else for(var y=0,C=this._tripData.places;y<C.length;y++){var p=C[y],m=mn.parse(p);m.place=p,m.allPlaces=[p],r.push(m)}for(var P=this._tripData.places,b={},v=0;v<P.length;++v){var i=P[v];b[i.name]=v}for(var _=new fn,x=0,w=r;x<w.length;x++){var i=w[x];_.nodes[i.name]=i}this.updateLandingsAndTakeoff();for(var k=0,T=this._tripData.additionalPlaces;k<T.length;k++){var i=T[k];_.nodes[i.name]=i}for(var L=0,M=this._tripData.stages;L<M.length;L++){var S=M[L];if(!S.properties.hidden&&!P[b[S.from]].isSkipped()){for(var R=e(S.from),D=b[S.to];D<P.length&&P[D].isSkipped();)++D;if(!(D>=P.length||P[D].isSkipped())){var E=e(P[D].name);if(R!==E){var I=vn.shallowCopy(S);I.from=R,I.to=E,I.originalEdge=S,_.edges.push(I)}}}}return _},n.prototype.save=function(){return this._tripData},n.prototype.load=function(n){if(!n||!n.places||!n.stages)throw new Error("no data");var l=n,e=function(n){for(var l=0;l<n.length;++l)n[l]=mn.parse(n[l])};e(l.places);for(var t=l.stages,o=0;o<t.length;++o)t[o]=new yn(t[o]);e(l.additionalPlaces),this._tripData=l,this.defaultEdgeProp(),this.setSize(n.pageSizeName,n.width,n.height)},n.prototype.seaColor=function(){return this._tripData.seaColor},n.prototype.setSeaColor=function(n){this._tripData.seaColor=n},n.prototype.landColor=function(){return this._tripData.landColor},n.prototype.setLandColor=function(n){this._tripData.landColor=n},n.prototype.borderColor=function(){return this._tripData.borderColor},n.prototype.setBorderColor=function(n){this._tripData.borderColor=n},n.prototype.placeByName=function(n){for(var l=0,e=this._tripData.places;l<e.length;l++){var t=e[l];if(n===t.name)return t}},n.prototype.markFirstLocation=function(){for(var n=!0,l=0,e=this._tripData.places;l<e.length;l++){var t=e[l];!t.label||t.properties&&t.properties.skip||(n?t.properties.firstVisited=!0:"firstVisited"in t.properties&&delete t.properties.firstVisited,n=!1)}},n}(),Pn=function(){function n(n,l,e){this.name=n,this.width_mm=l,this.height_mm=e}return n.fromPt=function(l,e,t){return new n(l,e/n.mmToPoint,t/n.mmToPoint)},n.prototype.widthPt=function(){return Math.round(this.width_mm*n.mmToPoint)},n.prototype.heightPt=function(){return Math.round(this.height_mm*n.mmToPoint)},n.prototype.key=function(){return Math.round(this.width_mm)+"x"+Math.round(this.height_mm)},n}();Pn.mmToPoint=2.83465;var bn;!function(n){n[n.Location=1]="Location",n[n.Node=2]="Node",n[n.NodeStyle=3]="NodeStyle",n[n.Edge=4]="Edge",n[n.PageSize=5]="PageSize",n[n.MapColor=6]="MapColor",n[n.Frame=7]="Frame",n[n.LabelMoved=8]="LabelMoved",n[n.CurveMoved=9]="CurveMoved",n[n.Label=10]="Label",n[n.LabelProperties=11]="LabelProperties",n[n.EdgeProperties=12]="EdgeProperties"}(bn||(bn={}));var _n=function(){function n(n){this.http=n,this._canvasWidth=512,this._canvasHeight=512,this._selectedCountry="",this._loadingMap=!1,this._graph=new fn;this._pageSizes=[new Pn("Full page",128,190),new Pn("Full page rotated",190,128),new Pn("Square",128,128),new Pn("Landscape",128,95)],this._pageSizeMap={};for(var l=0,e=this._pageSizes;l<e.length;l++){var t=e[l];this._pageSizeMap[t.key()]=t}this._numLocations=0,this._showSpinner=!1,this._seqTrip=new Cn,this._tripLayer&&(this._tripLayer.defaultTextProp=this._seqTrip.defaultTextProp(),this._tripLayer.defaultEdgeProp=this._seqTrip.defaultEdgeProp()),this._visitedPlaceList=this._seqTrip.places(),this._stages=this._seqTrip.stages(),this._interleaved=this.interleavedPlacesAndEvents(),this.setPageSize(this._pageSizes[0].key())}return n.prototype.fetchLocations=function(){var n=this;return this._numLocations=0,new Promise(function(l,e){$.getJSON(thisTripApi.locationsUrl,function(t){Array.isArray(t)?(n._numLocations=t.length,l(t)):e("bad map data")},function(n){e(n)})})},n.prototype.generateFromLocations=function(n){this._seqTrip.reset(),this.updateWithLocations(n,!0),this._tripLayer&&(this._tripLayer.defaultTextProp=this._seqTrip.defaultTextProp(),this._tripLayer.defaultEdgeProp=this._seqTrip.defaultEdgeProp()),this.saveMap()},n.prototype.updateWithLocations=function(n,l){for(var e={},t=0,o=this._seqTrip.places();t<o.length;t++){var i=o[t];"dbid"in i&&(e[i.dbid]=i)}for(var r=[],a=0,u=n;a<u.length;a++){var s=u[a],d=function(n,l){var e=Utils.latLonToWorld([l,n]);return new cn(e)}(s.latitude,s.longitude),p=""+s.id;if(p in e){var c=e[p];c.coord=d,r.push(c)}else r.push(mn.parse({dbid:p,name:p,label:s.label,coord:d}))}this._seqTrip.setPlaces(r),l&&this._seqTrip.setLocation(this._seqTrip.makeGraph().location(this._seqTrip.width_mm()/this._seqTrip.height_mm(),1.2)),this._visitedPlaceList=this._seqTrip.places(),this._stages=this._seqTrip.stages(),this._interleaved=this.interleavedPlacesAndEvents(),this.pushSeqTripToCanvas(l)},n.prototype.destination=function(n){return this._tripLayer.graph.nodes[n.to]||this._seqTrip.placeByName(n.to)},n.prototype.origin=function(n){return this._tripLayer.graph.nodes[n.from]||this._seqTrip.placeByName(n.from)},n.prototype.ngOnInit=function(){this.loadMap()},n.prototype.pixelRatio=function(){return this._renderer&&this._renderer.pixelRatio?this._renderer.pixelRatio:1},n.prototype.pushSeqTripToCanvas=function(n){this.prepareCanvas();for(var l=0,e=["seaColor","borderColor","landColor"];l<e.length;l++){var t=e[l];this._worldLayer.params[t]=this._seqTrip[t]()}this._tripLayer.defaultRadius=this._seqTrip.defaultRadius(),this._tripLayer.defaultTextProp=this._seqTrip.defaultTextProp(),this._tripLayer.defaultEdgeProp=this._seqTrip.defaultEdgeProp(),this._worldLayer.params.countryStyle=this._seqTrip.world();var o=new Pn(this._seqTrip.pageSizeName(),this._seqTrip.width_mm(),this._seqTrip.height_mm());this._pageSizeMap[o.key()]||(this._pageSizeMap[o.key()]=o,this._pageSizes.push(o)),this.setPageSize(o.key(),!1),this._renderer.setLocation(this._seqTrip.location()),this.clearSelection(),!0===n?this.reset():this.makeGraph(),this._renderer.refresh()},n.prototype.ngAfterViewInit=function(){},n.prototype.scale=function(){var n=this._seqTrip.location();return Math.log2(1/n.scale)},n.prototype.setScale=function(n){var l=this._renderer;if(l){var e=l.getLocation();e.scale=1/Math.pow(2,n),l.setLocation(e),this._seqTrip.setLocation(this._renderer.getLocation()),this.modified(bn.Location)}},n.prototype.prepareCanvas=function(){var n=this;this.canvas&&this.canvas.nativeElement&&!this._renderer&&(this._renderer=new CanvasTilesRenderer({canvas:this.canvas.nativeElement,url:"https://tiles.wmflabs.org/bw-mapnik/$scale/$x/$y.png",initialLocation:{x:.5196633492226737,y:.2519760172389177,scale:.0814},onLocationChange:function(l){n._loadingMap||(n.modified(bn.Location),n._seqTrip.setLocation(l.getLocation()))}}),this._worldLayer=new WorldBackgroundLayer({renderer:this._renderer,onCountryClic:function(l){n._editor.deselectLabel(),n.selectCountry(l.id)},onSeaClic:function(){n._editor.deselectLabel(),n.selectCountry("")},landColor:"",borderColor:"",seaColor:"",countryStyle:{}}),this._renderer.layers[0]=this._worldLayer,this._tripLayer=new vn({renderer:this._renderer,graph:this._graph}),this._renderer.addLayer(this._tripLayer),setTimeout(function(){n.clearSelection(),n._editor=new gn(n._renderer,n._graph),n._renderer.pinchZoom.touchEventHandlers.push(n._editor),n._editor.onLabelMoved=function(l){n.modified(bn.LabelMoved)},n._editor.onBezierMoved=function(l){n.modified(bn.CurveMoved)},n._editor.onLabelSelect=function(l){n.selectNode(l)},n._editor.onBezierSelect=function(l){l?n.selectEdge(l.edge):n.clearSelection()},n.pushSeqTripToCanvas()},10))},n.prototype.ngOnDestroy=function(){this._autoRefresh&&clearInterval(this._autoRefresh)},n.prototype.clearSelection=function(){this._selectedCountry=void 0,this._selectedNode=void 0,this._selectedEdge=void 0},n.prototype.clearAndSaveSelection=function(){var n={_selectedCountry:this._selectedCountry,_selectedNode:this._selectedNode,_selectedEdge:this._selectedEdge};return this.clearSelection(),n},n.prototype.restoreSelection=function(n){this._selectedCountry=n._selectedCountry,this._selectedNode=n._selectedNode,this._selectedEdge=n._selectedEdge},n.prototype.selectCountry=function(n){this.clearSelection(),this._selectedCountry=n,this.setCountryColor(n,this.countryColor(n))},n.prototype.setCountryColor=function(n,l){if(n){var e="default"==l,t=!1,o=this._worldLayer.params.countryStyle[n];o?e?(t=!!o.color,delete o.color,0==Object.keys(o).length&&delete this._worldLayer.params.countryStyle[n]):(t=o.color!==l,o.color=l):e||(t=!0,o=this._worldLayer.params.countryStyle[n]={color:l}),t&&this.modified(bn.MapColor)}},n.prototype.countryColor=function(n){return this._worldLayer&&this._worldLayer.params.countryStyle[n]&&this._worldLayer.params.countryStyle[n].color?this._worldLayer.params.countryStyle[n].color:this._seqTrip.landColor()},n.prototype.tunedCountries=function(){return this._worldLayer?Object.keys(this._worldLayer.params.countryStyle):[]},n.prototype.selectNode=function(n){if(this.clearSelection(),n&&(n.properties||(n.properties={}),n.name in this._graph.nodes&&(this._selectedNode=this._graph.nodes[n.name]),n!==this._editor.selectedLabel)){var l=this._editor.onLabelSelect,e=this._editor.onBezierSelect;this._editor.onLabelSelect=function(){},this._editor.onBezierSelect=function(){},n.name in this._editor.graph.nodes?this._editor.selectLabel(n):this._editor.deselectLabel(),this._editor.onLabelSelect=l,this._editor.onBezierSelect=e}},n.prototype.selectEdge=function(n){this.clearSelection(),this._selectedEdge=n},n.prototype.nodeNames=function(){return Object.keys(this._graph.nodes)},n.prototype.nodeArray=function(){for(var n=[],l=0,e=Object.keys(this._graph.nodes);l<e.length;l++){var t=e[l];n.push(this._graph.nodes[t])}return n},n.prototype.isSkipped=function(n){return!(!n.properties||void 0===n.properties.skip)&&n.properties.skip},n.prototype.toggleHideEdge=function(n){if(n.properties.hidden){delete n.properties.hidden;for(var l=0,e=this._visitedPlaceList;l<e.length;l++){var t=e[l];t.name!=n.from&&t.name!=n.to||!this.isSkipped(t)||this.toggleSkipNode(t)}}else n.properties.hidden=!0;this.modified(bn.Edge)},n.prototype.toggleSkipNode=function(n){if(this.isSkipped(n))delete n.properties.skip;else{n.properties?n.properties.skip=!0:n.properties={skip:!0};for(var l=0,e=this._stages;l<e.length;l++){var t=e[l];t.from!=n.name&&t.to!=n.name||(t.properties.hidden=!0)}}this._seqTrip.markFirstLocation(),this.modified(bn.Node)},n.prototype.toggleProperty=function(n,l){n.properties[l]=!n.properties[l],this.modified(bn.Node)},n.prototype.setProperty=function(n,l,e,t){void 0!==e?n.properties[l]=e:l in n.properties&&delete n.properties[l],this._seqTrip.markFirstLocation(),this.modified(bn.NodeStyle)},n.prototype.setNodeLabel=function(n,l){var e=n.label;if(e!==l){n.label=l;var t=this._graph;for(var o in t.nodes){var i=t.nodes[o];(i.place===n||i.allPlaces.indexOf(n)>=0)&&(i.label=i.label.replace(e,l))}this.modified(bn.Label)}},n.prototype.removeEdge=function(n){var l=function(l){return l.from!==n.from||l.to!==n.to};this._graph.edges=this._graph.edges.filter(l),this._editor.graph.edges=this._editor.graph.edges.filter(l)},n.prototype.uiSetFrame=function(n,l){this.setFrame(n,l),this.modified(bn.Frame)},n.prototype.setFrame=function(n,l){if(this._renderer){var e=this._renderer.canvas,t=n||e.width,o=l||e.height,i=this._graph.location(t/o,1.2);this._seqTrip.setLocation(i),this._renderer.setLocation(i)}},n.prototype.placeLabels=function(){var n=this;this.runBlockingTask(function(l){n._tripLayer.placeLabels(n._renderer.canvas.getContext("2d")),n.modified(bn.LabelMoved),n._renderer.refresh(),l()})},n.prototype.runBlockingTask=function(n){var l=this;this._showSpinner=!0,setTimeout(function(){try{n(function(){l._showSpinner=!1})}catch(n){l._showSpinner=!1,console.log(n)}},30)},n.prototype.update=function(){this.placeLabels()},n.prototype.resetCurves=function(){var n=this._graph;n.createDefaultBezier(),this._tripLayer.graph=this._tripLayer.makeFusedGraph(n),this._editor.graph=this._tripLayer.graph,this._tripLayer.placeLabels(this._renderer.canvas.getContext("2d")),this._renderer.refresh()},n.prototype.makeGraph=function(){var n=this;this._graph=this._seqTrip.makeGraph(this._tripLayer),this._tripLayer&&(this._tripLayer.graph=this._graph,this._tripLayer.loadIcons(function(l){n._renderer.refresh()})),this._editor&&(this._editor.graph=this._graph)},n.prototype.recreate=function(){this._visitedPlaceList.length&&(this.makeGraph(),this.placeLabels())},n.prototype.reset=function(){this._visitedPlaceList.length&&(this.makeGraph(),this.setFrame(),this.placeLabels())},n.prototype.uiSetPageSize=function(n,l){this.setPageSize(n,l),this.modified(bn.PageSize)},n.prototype.setPageSize=function(n,l){var e=this,t=this._pageSizeMap[n];t&&(this._pageSizeName=n,this._canvasWidth=t.widthPt(),this._canvasHeight=t.heightPt(),this._seqTrip.setSize(t.name,t.width_mm,t.height_mm),!1!==l&&(this.setFrame(this._canvasWidth,this._canvasHeight),setTimeout(function(){e.placeLabels()},20)))},n.prototype.setSeaColor=function(n){n!=this._seqTrip.seaColor()&&(this._seqTrip.setSeaColor(n),this._worldLayer.params.seaColor=n,this.modified(bn.MapColor))},n.prototype.setBorderColor=function(n){n!=this._seqTrip.borderColor()&&(this._seqTrip.setBorderColor(n),this._worldLayer.params.borderColor=n,this.modified(bn.MapColor))},n.prototype.setLandColor=function(n){n!=this._seqTrip.landColor()&&(this._seqTrip.setLandColor(n),this._worldLayer.params.landColor=n,this.modified(bn.MapColor))},n.prototype.fetchMap=function(){return new Promise(function(n,l){$.getJSON(thisTripApi.mapUrl,function(l){n(l)},function(n){l(n)})})},n.prototype.loadMap=function(){var n=this;this._loadingMap=!0,this.fetchMap().then(function(l){try{return n._seqTrip.load(l),n._saved=!0,n._visitedPlaceList=n._seqTrip.places(),n._stages=n._seqTrip.stages(),n._interleaved=n.interleavedPlacesAndEvents(),n.prepareCanvas(),n.fetchLocations().then(function(l){n.updateWithLocations(l)})}catch(l){return n.fetchLocationsAndGenerateMap()}}).then(function(){setTimeout(function(){n._loadingMap=!1},100)}).catch(function(l){n._loadingMap=!1,n.handleError(l)})},n.prototype.fetchLocationsAndGenerateMap=function(){var n=this;return this.fetchLocations().then(function(l){l.length>0&&(n.generateFromLocations(l),n.prepareCanvas())})},n.prototype.saveMap=function(){var n=this,l=this.clearAndSaveSelection();if(this._editor&&this._editor.deselectLabel(),this._graph)for(var e=0,t=this._graph.edges;e<t.length;e++){var o=t[e];o.propagateToOriginal()}$.ajax({type:"PUT",url:thisTripApi.mapUrl,dataType:"text",contentType:"application/json",data:JSON.stringify({_method:"PUT",map_data:JSON.stringify(this._seqTrip.save())}),success:function(){n._saved=!0,n._errorMessage=void 0},error:function(l,e,t){n.handleError("Error: Can't save map. Please check your internet connection.")}}),this.restoreSelection(l)},n.prototype.handleError=function(n){var l=""+n;console.error(l),this._infoMessage=void 0,this._errorMessage=l},n.prototype.nodePropertiesChanged=function(){this.modified(bn.LabelProperties)},n.prototype.edgePropertiesChanged=function(n){this.modified(bn.EdgeProperties)},n.prototype.modified=function(n){var l=this;if(!this._loadingMap){switch(this._saved=!1,n){case bn.LabelMoved:case bn.CurveMoved:case bn.Location:break;case bn.NodeStyle:case bn.Label:case bn.LabelProperties:case bn.EdgeProperties:case bn.MapColor:this._renderer.refreshIfNotMoving();break;case bn.Node:case bn.Edge:case bn.Frame:this.recreate();break;case bn.PageSize:}this._saveTimeout&&clearTimeout(this._saveTimeout),this._saveTimeout=setTimeout(function(){l._loadingMap||l.saveMap()},500)}},n.prototype.interleavedPlacesAndEvents=function(){for(var n=[],l=this._seqTrip.stagesAsDict(),e={},t=this._visitedPlaceList,o=t.length-1,i=0;i<t.length;++i){var r=t[i],a=void 0;i<o&&(a=t[i+1].dbid,r.dbid===a)||(!function(l){l.dbid in e?n.push({node:e[l.dbid]}):(e[l.dbid]=l,n.push({node:l}))}(r),void 0!==a&&(r.dbid in l&&a in l[r.dbid]?n.push({edge:l[r.dbid][a]}):console.log("No edge from "+r.dbid+" to "+a)))}return n},n.prototype.download=function(n){var l=this,e=function(n){return Math.round(Math.pow(36,n+1)-Math.random()*Math.pow(36,n)).toString(36).slice(1)}(16),t="http://cssservice-staging.herokuapp.com/mapgen/"+e,o=t+"/"+n,i=new pn.d({"content-type":"application/json"}),r=new pn.g({headers:i});this.http.post(t,JSON.stringify(this._seqTrip.save()),r).subscribe(function(n){window.open(o)},function(n){l.handleError(n.text())})},n.prototype.doSomething=function(n){!this._loadingMap&&this._numLocations>0&&!this._saved&&(n.returnValue="Your data will be lost!")},n.ctorParameters=function(){return[{type:pn.e}]},n}(),xn=e("pYHX"),wn=e("DmCJ"),kn=e("4zAq"),Tn=e("rxZd"),Ln=e("poDJ"),Mn=e("pBJ6"),Sn=e("2VFp"),Rn=e("iDwB"),Dn=[A],En=I["\u0275crt"]({encapsulation:0,styles:Dn,data:{}}),In=(I["\u0275ccf"]("trip-map",_n,R,{},{},[]),[q]),On=I["\u0275crt"]({encapsulation:0,styles:In,data:{}}),zn=I["\u0275ccf"]("app-root",z,E,{},{},[]),Nn=e("fc+i"),Fn=e("BhHz"),qn=e("4Vp2"),An=e("x/Up"),Bn=e("G8gw"),Vn=e("xHno"),Wn=e("yroR"),$n=e("bIam"),jn=I["\u0275cmf"](O,[z],function(n){return I["\u0275mod"]([I["\u0275mpd"](512,I.ComponentFactoryResolver,I["\u0275CodegenComponentFactoryResolver"],[[8,[N.a,F.a,zn]],[3,I.ComponentFactoryResolver],I.NgModuleRef]),I["\u0275mpd"](5120,I.LOCALE_ID,I["\u0275m"],[[3,I.LOCALE_ID]]),I["\u0275mpd"](4608,W.NgLocalization,W.NgLocaleLocalization,[I.LOCALE_ID]),I["\u0275mpd"](4608,I.Compiler,I.Compiler,[]),I["\u0275mpd"](5120,I.APP_ID,I["\u0275f"],[]),I["\u0275mpd"](5120,I.IterableDiffers,I["\u0275k"],[]),I["\u0275mpd"](5120,I.KeyValueDiffers,I["\u0275l"],[]),I["\u0275mpd"](4608,Nn.b,Nn.s,[W.DOCUMENT]),I["\u0275mpd"](6144,I.Sanitizer,null,[Nn.b]),I["\u0275mpd"](4608,Nn.e,Nn.f,[]),I["\u0275mpd"](5120,Nn.c,function(n,l,e,t){return[new Nn.k(n),new Nn.o(l),new Nn.n(e,t)]},[W.DOCUMENT,W.DOCUMENT,W.DOCUMENT,Nn.e]),I["\u0275mpd"](4608,Nn.d,Nn.d,[Nn.c,I.NgZone]),I["\u0275mpd"](135680,Nn.m,Nn.m,[W.DOCUMENT]),I["\u0275mpd"](4608,Nn.l,Nn.l,[Nn.d,Nn.m]),I["\u0275mpd"](6144,I.RendererFactory2,null,[Nn.l]),I["\u0275mpd"](6144,Nn.p,null,[Nn.m]),I["\u0275mpd"](4608,I.Testability,I.Testability,[I.NgZone]),I["\u0275mpd"](4608,Nn.g,Nn.g,[W.DOCUMENT]),I["\u0275mpd"](4608,Nn.i,Nn.i,[W.DOCUMENT]),I["\u0275mpd"](4608,B.n,B.n,[]),I["\u0275mpd"](4608,pn.c,pn.c,[]),I["\u0275mpd"](4608,pn.h,pn.b,[]),I["\u0275mpd"](5120,pn.j,pn.k,[]),I["\u0275mpd"](4608,pn.i,pn.i,[pn.c,pn.h,pn.j]),I["\u0275mpd"](4608,pn.g,pn.a,[]),I["\u0275mpd"](5120,pn.e,pn.l,[pn.i,pn.g]),I["\u0275mpd"](4608,U.ColorPickerService,U.ColorPickerService,[]),I["\u0275mpd"](4608,wn.a,wn.a,[]),I["\u0275mpd"](4608,un.a,un.a,[]),I["\u0275mpd"](4608,Fn.a,Fn.a,[]),I["\u0275mpd"](4608,Ln.a,Ln.a,[I.ComponentFactoryResolver,I.NgZone,I.Injector,Fn.a,I.ApplicationRef]),I["\u0275mpd"](4608,kn.a,kn.a,[]),I["\u0275mpd"](512,W.CommonModule,W.CommonModule,[]),I["\u0275mpd"](1024,I.ErrorHandler,Nn.q,[]),I["\u0275mpd"](1024,I.APP_INITIALIZER,function(n,l){return[Nn.r(n,l)]},[[2,Nn.h],[2,I.NgProbeToken]]),I["\u0275mpd"](512,I.ApplicationInitStatus,I.ApplicationInitStatus,[[2,I.APP_INITIALIZER]]),I["\u0275mpd"](131584,I["\u0275e"],I["\u0275e"],[I.NgZone,I["\u0275Console"],I.Injector,I.ErrorHandler,I.ComponentFactoryResolver,I.ApplicationInitStatus]),I["\u0275mpd"](2048,I.ApplicationRef,null,[I["\u0275e"]]),I["\u0275mpd"](512,I.ApplicationModule,I.ApplicationModule,[I.ApplicationRef]),I["\u0275mpd"](512,Nn.a,Nn.a,[[3,Nn.a]]),I["\u0275mpd"](512,B.k,B.k,[]),I["\u0275mpd"](512,B.d,B.d,[]),I["\u0275mpd"](512,pn.f,pn.f,[]),I["\u0275mpd"](512,qn.ColorPickerModule,qn.ColorPickerModule,[]),I["\u0275mpd"](512,An.a,An.a,[]),I["\u0275mpd"](512,Bn.a,Bn.a,[]),I["\u0275mpd"](512,Vn.a,Vn.a,[]),I["\u0275mpd"](512,Wn.a,Wn.a,[]),I["\u0275mpd"](512,$n.a,$n.a,[]),I["\u0275mpd"](512,O,O,[]),I["\u0275mpd"](256,Mn.a,{autoClose:!0},[])])});Object(I.enableProdMode)(),Object(Nn.j)().bootstrapModuleFactory(jn)},z1vh:function(n,l){function e(n){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+n+"'.")})}e.keys=function(){return[]},e.resolve=e,n.exports=e,e.id="z1vh"}},[0]);