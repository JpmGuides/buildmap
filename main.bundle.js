webpackJsonp([1],{0:function(n,e,l){n.exports=l("rl7j")},rl7j:function(n,e,l){"use strict";function t(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,0,"i",[["class","fa fa-recycle"],["style","font-size: 14pt"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.resetToDefault()&&t}return t},null,null))],null,null)}function o(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,36,"div",[["class","root"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275eld"](0,null,null,15,"div",[["class","font-size-margin"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[["for","fontSize"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Font size:"])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,6,"input",[["class","form-control"],["id","fontSize"],["max","64"],["min","5"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,8)._handleInput(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,8).onTouched()&&t}if("compositionstart"===e){t=!1!==O["\u0275nov"](n,8)._compositionStart()&&t}if("compositionend"===e){t=!1!==O["\u0275nov"](n,8)._compositionEnd(l.target.value)&&t}if("change"===e){t=!1!==O["\u0275nov"](n,9).onChange(l.target.value)&&t}if("input"===e){t=!1!==O["\u0275nov"](n,9).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,9).onTouched()&&t}if("change"===e){t=!1!==o.setProperty("fontSize")&&t}if("ngModelChange"===e){t=!1!==(o.fontSize=l)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.c,[O.Renderer2,O.ElementRef,[2,B.a]],null,null),O["\u0275did"](16384,null,0,B.l,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n,e){return[n,e]},[B.c,B.l]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},{update:"ngModelChange"}),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n\n    "])),(n()(),O["\u0275and"](16777216,null,null,1,null,t)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](0,null,null,7,"div",[["class","text-prop-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,22).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,22).onClick()&&t}if("colorPickerChange"===e){t=!1!==(o.fill=l)&&t}if("colorPickerChange"===e){t=!1!==o.setProperty("fill")&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Text color"])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](0,null,null,7,"div",[["class","text-prop-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,31).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,31).onClick()&&t}if("colorPickerChange"===e){t=!1!==(o.stroke=l)&&t}if("colorPickerChange"===e){t=!1!==o.setProperty("stroke")&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Shadow color"])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n"]))],function(n,e){var l=e.component;n(e,11,0,l.fontSize),n(e,16,0,!l.hasDefault()&&!l.noReset),n(e,22,0,l.fill),n(e,31,0,l.stroke)},function(n,e){var l=e.component;n(e,7,0,O["\u0275nov"](e,13).ngClassUntouched,O["\u0275nov"](e,13).ngClassTouched,O["\u0275nov"](e,13).ngClassPristine,O["\u0275nov"](e,13).ngClassDirty,O["\u0275nov"](e,13).ngClassValid,O["\u0275nov"](e,13).ngClassInvalid,O["\u0275nov"](e,13).ngClassPending),n(e,21,0,l.fill),n(e,30,0,l.stroke)})}function i(n){return O["\u0275vid"](0,[(n()(),O["\u0275and"](16777216,null,null,1,null,o)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n"]))],function(n,e){n(e,1,0,e.component.properties)},null)}function r(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"text-prop",[],null,null,null,i,K)),O["\u0275did"](376832,null,0,G,[U.ColorPickerService,O.KeyValueDiffers],null,null)],function(n,e){n(e,1,0)},null)}function a(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,0,"i",[["class","fa fa-recycle pull-right"],["style","font-size: 14pt"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.resetToDefault()&&t}return t},null,null))],null,null)}function u(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,3,"option",[["class","form-control"]],null,null,null,null,null)),O["\u0275did"](147456,null,0,B.i,[O.ElementRef,O.Renderer2,[2,B.j]],{value:[0,"value"]},null),O["\u0275did"](147456,null,0,B.o,[O.ElementRef,O.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),O["\u0275ted"](null,["",""]))],function(n,e){n(e,1,0,e.context.$implicit),n(e,2,0,e.context.$implicit)},function(n,e){n(e,3,0,e.context.$implicit)})}function s(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,3,"option",[["class","form-control"],["required",""]],null,null,null,null,null)),O["\u0275did"](147456,null,0,B.i,[O.ElementRef,O.Renderer2,[2,B.j]],{value:[0,"value"]},null),O["\u0275did"](147456,null,0,B.o,[O.ElementRef,O.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),O["\u0275ted"](null,["",""]))],function(n,e){n(e,1,0,e.context.$implicit.name),n(e,2,0,e.context.$implicit.name)},function(n,e){n(e,3,0,e.context.$implicit.name)})}function d(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,97,"div",[["class","form-horizontal"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275and"](16777216,null,null,1,null,a)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n   "])),(n()(),O["\u0275eld"](0,null,null,18,"div",[["class","form-group"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Transport:"])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,12,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,9,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==O["\u0275nov"](n,13).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,13).onTouched()&&t}if("change"===e){t=!1!==o.setTravelMean(l.target.value)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.j,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275and"](16777216,null,null,1,null,u)),O["\u0275did"](802816,null,0,W.NgForOf,[O.ViewContainerRef,O.TemplateRef,O.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](0,null,null,15,"div",[["class","form-group"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"div",[["class","col-md-4"],["for","lineWidth"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Line width:"])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,9,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,6,"input",[["class","form-control"],["id","lineWidth"],["max","10"],["min","0"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,33)._handleInput(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,33).onTouched()&&t}if("compositionstart"===e){t=!1!==O["\u0275nov"](n,33)._compositionStart()&&t}if("compositionend"===e){t=!1!==O["\u0275nov"](n,33)._compositionEnd(l.target.value)&&t}if("change"===e){t=!1!==O["\u0275nov"](n,34).onChange(l.target.value)&&t}if("input"===e){t=!1!==O["\u0275nov"](n,34).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,34).onTouched()&&t}if("change"===e){t=!1!==o.changeEvent()&&t}if("ngModelChange"===e){t=!1!==(o.lineWidth=l)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.c,[O.Renderer2,O.ElementRef,[2,B.a]],null,null),O["\u0275did"](16384,null,0,B.l,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n,e){return[n,e]},[B.c,B.l]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},{update:"ngModelChange"}),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](0,null,null,18,"div",[["class","form-group"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Line style:"])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,12,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,9,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==O["\u0275nov"](n,50).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,50).onTouched()&&t}if("change"===e){t=!1!==o.setLineStyle(l.target.value)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.j,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275and"](16777216,null,null,1,null,s)),O["\u0275did"](802816,null,0,W.NgForOf,[O.ViewContainerRef,O.TemplateRef,O.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](0,null,null,25,"div",[["class","form-group"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Line shape:"])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,19,"div",[["class","col-md-4"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,16,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==O["\u0275nov"](n,70).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,70).onTouched()&&t}if("change"===e){t=!1!==o.setGeom(l.target.value)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.j,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,3,"option",[["class","form-control"]],null,null,null,null,null)),O["\u0275did"](147456,null,0,B.i,[O.ElementRef,O.Renderer2,[2,B.j]],{value:[0,"value"]},null),O["\u0275did"](147456,null,0,B.o,[O.ElementRef,O.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),O["\u0275ted"](null,["Straight"])),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,3,"option",[["class","form-control"]],null,null,null,null,null)),O["\u0275did"](147456,null,0,B.i,[O.ElementRef,O.Renderer2,[2,B.j]],{value:[0,"value"]},null),O["\u0275did"](147456,null,0,B.o,[O.ElementRef,O.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),O["\u0275ted"](null,["Curved"])),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](0,null,null,7,"div",[["class","edge-prop-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,92).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,92).onClick()&&t}if("colorPickerChange"===e){t=!1!==(o.lineColor=l)&&t}if("colorPickerChange"===e){t=!1!==o.colorChanged()&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Line color"])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n"]))],function(n,e){var l=e.component;n(e,3,0,!l.hasDefault()&&!l.noReset),n(e,15,0,l.travelMean),n(e,20,0,l.allTravelMeans),n(e,36,0,l.lineWidth),n(e,52,0,l.lineStyle),n(e,57,0,l.allLineStyles),n(e,72,0,l.geom);n(e,77,0,"straight");n(e,78,0,"straight");n(e,82,0,"spline");n(e,83,0,"spline"),n(e,92,0,l.lineColor)},function(n,e){var l=e.component;n(e,12,0,O["\u0275nov"](e,17).ngClassUntouched,O["\u0275nov"](e,17).ngClassTouched,O["\u0275nov"](e,17).ngClassPristine,O["\u0275nov"](e,17).ngClassDirty,O["\u0275nov"](e,17).ngClassValid,O["\u0275nov"](e,17).ngClassInvalid,O["\u0275nov"](e,17).ngClassPending),n(e,32,0,O["\u0275nov"](e,38).ngClassUntouched,O["\u0275nov"](e,38).ngClassTouched,O["\u0275nov"](e,38).ngClassPristine,O["\u0275nov"](e,38).ngClassDirty,O["\u0275nov"](e,38).ngClassValid,O["\u0275nov"](e,38).ngClassInvalid,O["\u0275nov"](e,38).ngClassPending),n(e,49,0,O["\u0275nov"](e,54).ngClassUntouched,O["\u0275nov"](e,54).ngClassTouched,O["\u0275nov"](e,54).ngClassPristine,O["\u0275nov"](e,54).ngClassDirty,O["\u0275nov"](e,54).ngClassValid,O["\u0275nov"](e,54).ngClassInvalid,O["\u0275nov"](e,54).ngClassPending),n(e,69,0,O["\u0275nov"](e,74).ngClassUntouched,O["\u0275nov"](e,74).ngClassTouched,O["\u0275nov"](e,74).ngClassPristine,O["\u0275nov"](e,74).ngClassDirty,O["\u0275nov"](e,74).ngClassValid,O["\u0275nov"](e,74).ngClassInvalid,O["\u0275nov"](e,74).ngClassPending),n(e,91,0,l.lineColor)})}function p(n){return O["\u0275vid"](0,[(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,d)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n"]))],function(n,e){n(e,2,0,e.component.properties)},null)}function c(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"edge-prop",[],null,null,null,p,on)),O["\u0275did"](376832,null,0,ln,[O.KeyValueDiffers],null,null)],function(n,e){n(e,1,0)},null)}function h(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,4,"div",[["class","alert fade in alert-danger"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275eld"](0,null,null,1,"button",[["class","close"],["data-dismiss","alert"],["type","button"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==(o._errorMessage=null)&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["\xd7"])),(n()(),O["\u0275ted"](null,["\n  ","\n"]))],null,function(n,e){n(e,4,0,e.component._errorMessage)})}function f(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,4,"div",[["class","alert fade in alert-success"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275eld"](0,null,null,1,"button",[["class","close"],["data-dismiss","alert"],["type","button"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==(o._infoMessage=null)&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["\xd7"])),(n()(),O["\u0275ted"](null,["\n  ","\n"]))],null,function(n,e){n(e,4,0,e.component._infoMessage)})}function g(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Please add at least one location in a day or event settings"]))],null,null)}function v(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Loading..."]))],null,null)}function m(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,7,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["No map created yet."])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275eld"](0,null,null,1,"button",[["class","btn btn-primary"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.fetchLocationsAndGenerateMap()&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["Create map"])),(n()(),O["\u0275ted"](null,["\n"]))],null,null)}function y(n){return O["\u0275vid"](0,[(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,0,"i",[["class","fa fa-file"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "]))],null,null)}function C(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,3,"option",[["class","form-control"],["required",""]],null,null,null,null,null)),O["\u0275did"](147456,null,0,B.i,[O.ElementRef,O.Renderer2,[2,B.j]],{value:[0,"value"]},null),O["\u0275did"](147456,null,0,B.o,[O.ElementRef,O.Renderer2,[8,null]],{value:[0,"value"]},null),(n()(),O["\u0275ted"](null,["",""]))],function(n,e){n(e,1,0,e.context.$implicit.key()),n(e,2,0,e.context.$implicit.key())},function(n,e){n(e,3,0,e.context.$implicit.name)})}function b(n){return O["\u0275vid"](0,[(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,0,"i",[["class","glyphicon glyphicon-map-marker"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "]))],null,null)}function P(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,37,"div",[["class","btn-group"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,4,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,1,"text-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,e,l){var t=!0,o=n.component;if("propertiesChange"===e){t=!1!==(n.parent.parent.context.$implicit.node.properties=l)&&t}if("onChange"===e){t=!1!==o.nodePropertiesChanged()&&t}return t},i,K)),O["\u0275did"](376832,null,0,G,[U.ColorPickerService,O.KeyValueDiffers],{properties:[0,"properties"],defaults:[1,"defaults"]},{onChange:"onChange"}),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,17,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,6,"label",[["btnCheckbox",""],["class","btn btn-default map-btn"]],[[2,"active",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==O["\u0275nov"](n,11).onClick()&&t}if("click"===e){t=!1!==o.toggleProperty(n.parent.parent.context.$implicit.node,"landing")&&t}return t},null,null)),O["\u0275did"](81920,null,0,X.a,[],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[X.a]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275eld"](0,null,null,0,"img",[["alt","Landing"],["height","16px"],["src","/ng-map/assets/landing.svg"],["width","16px"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n\n           "])),(n()(),O["\u0275eld"](0,null,null,6,"label",[["btnCheckbox",""],["class","btn btn-default map-btn"]],[[2,"active",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==O["\u0275nov"](n,19).onClick()&&t}if("click"===e){t=!1!==o.toggleProperty(n.parent.parent.context.$implicit.node,"takeoff")&&t}return t},null,null)),O["\u0275did"](81920,null,0,X.a,[],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[X.a]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275eld"](0,null,null,0,"img",[["alt","Take-off"],["height","16px"],["src","/ng-map/assets/takeoff.svg"],["width","16px"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275ted"](null,["\n\n          "])),(n()(),O["\u0275eld"](0,null,null,9,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,6,"label",[["btnCheckbox",""],["class","btn btn-default map-btn"]],[[2,"active",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==O["\u0275nov"](n,30).onClick()&&t}if("click"===e){t=!1!==o.setProperty(n.parent.parent.context.$implicit.node,"markStyle","first"===n.parent.parent.context.$implicit.node.properties.markStyle?"normal":"first")&&t}return t},null,null)),O["\u0275did"](81920,null,0,X.a,[],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[X.a]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-circle"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275ted"](null,["\n        "]))],function(n,e){var l=e.component;n(e,5,0,e.parent.parent.context.$implicit.node.properties,l._seqTrip._tripData.defaultTextProp),n(e,11,0),n(e,13,0,e.parent.parent.context.$implicit.node.properties.landing),n(e,19,0),n(e,21,0,e.parent.parent.context.$implicit.node.properties.takeoff),n(e,30,0),n(e,32,0,"first"===e.parent.parent.context.$implicit.node.properties.markStyle)},function(n,e){n(e,10,0,O["\u0275nov"](e,11).state,O["\u0275nov"](e,15).ngClassUntouched,O["\u0275nov"](e,15).ngClassTouched,O["\u0275nov"](e,15).ngClassPristine,O["\u0275nov"](e,15).ngClassDirty,O["\u0275nov"](e,15).ngClassValid,O["\u0275nov"](e,15).ngClassInvalid,O["\u0275nov"](e,15).ngClassPending),n(e,18,0,O["\u0275nov"](e,19).state,O["\u0275nov"](e,23).ngClassUntouched,O["\u0275nov"](e,23).ngClassTouched,O["\u0275nov"](e,23).ngClassPristine,O["\u0275nov"](e,23).ngClassDirty,O["\u0275nov"](e,23).ngClassValid,O["\u0275nov"](e,23).ngClassInvalid,O["\u0275nov"](e,23).ngClassPending),n(e,29,0,O["\u0275nov"](e,30).state,O["\u0275nov"](e,34).ngClassUntouched,O["\u0275nov"](e,34).ngClassTouched,O["\u0275nov"](e,34).ngClassPristine,O["\u0275nov"](e,34).ngClassDirty,O["\u0275nov"](e,34).ngClassValid,O["\u0275nov"](e,34).ngClassInvalid,O["\u0275nov"](e,34).ngClassPending)})}function _(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,26,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"nodeSkipped",null],[2,"panel-open",null]],null,null,J.b,J.a)),O["\u0275did"](245760,[["group",4]],0,Y.a,[Q.a],null,null),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275eld"](0,null,0,19,"div",[["accordion-heading",""],["class","hflex-container"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,2,"i",[["class","fa fa-right-margin flex-item-narrow in-margin-top"],["style","font-size: 14pt"]],null,null,null,null,null)),O["\u0275did"](278528,null,0,W.NgClass,[O.IterableDiffers,O.KeyValueDiffers,O.ElementRef,O.Renderer],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),O["\u0275pod"]({"fa-caret-down":0,"fa-caret-right":1}),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,5,"input",[["class","form-control-input flex-item-wide"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"],[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,10)._handleInput(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,10).onTouched()&&t}if("compositionstart"===e){t=!1!==O["\u0275nov"](n,10)._compositionStart()&&t}if("compositionend"===e){t=!1!==O["\u0275nov"](n,10)._compositionEnd(l.target.value)&&t}if("click"===e){t=!1!==l.stopPropagation()&&t}if("change"===e){t=!1!==o.setNodeLabel(n.parent.context.$implicit.node,l.target.value)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.c,[O.Renderer2,O.ElementRef,[2,B.a]],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.c]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n\n          "])),(n()(),O["\u0275eld"](0,null,null,5,"input",[["class","flex-item-narrow in-margin-top"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"],[null,"change"],[null,"blur"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==O["\u0275nov"](n,17).onChange(l.target.checked)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,17).onTouched()&&t}if("click"===e){o.toggleSkipNode(n.parent.context.$implicit.node);t=!1!==l.stopPropagation()&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.b,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.b]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n\n        "])),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275and"](16777216,null,1,1,null,P)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](1,["\n      "]))],function(n,e){var l=e.component;n(e,1,0);n(e,6,0,"fa fa-right-margin flex-item-narrow in-margin-top",n(e,7,0,null==O["\u0275nov"](e,1)?null:O["\u0275nov"](e,1).isOpen,!(null==O["\u0275nov"](e,1)?null:O["\u0275nov"](e,1).isOpen))),n(e,12,0,l.isSkipped(e.parent.context.$implicit.node),e.parent.context.$implicit.node.label),n(e,19,0,!l.isSkipped(e.parent.context.$implicit.node)),n(e,25,0,!l.isSkipped(e.parent.context.$implicit.node))},function(n,e){var l=e.component;n(e,0,0,e.parent.context.$implicit.node&&l.isSkipped(e.parent.context.$implicit.node),O["\u0275nov"](e,1).isOpen),n(e,9,0,O["\u0275nov"](e,14).ngClassUntouched,O["\u0275nov"](e,14).ngClassTouched,O["\u0275nov"](e,14).ngClassPristine,O["\u0275nov"](e,14).ngClassDirty,O["\u0275nov"](e,14).ngClassValid,O["\u0275nov"](e,14).ngClassInvalid,O["\u0275nov"](e,14).ngClassPending),n(e,16,0,O["\u0275nov"](e,21).ngClassUntouched,O["\u0275nov"](e,21).ngClassTouched,O["\u0275nov"](e,21).ngClassPristine,O["\u0275nov"](e,21).ngClassDirty,O["\u0275nov"](e,21).ngClassValid,O["\u0275nov"](e,21).ngClassInvalid,O["\u0275nov"](e,21).ngClassPending)})}function x(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,22,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"nodeSkipped",null],[2,"panel-open",null]],null,null,J.b,J.a)),O["\u0275did"](245760,[["group2",4]],0,Y.a,[Q.a],null,null),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275eld"](0,null,0,15,"div",[["accordion-heading",""]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,2,"i",[["class","fa"],["style","font-size: 14pt"]],null,null,null,null,null)),O["\u0275did"](278528,null,0,W.NgClass,[O.IterableDiffers,O.KeyValueDiffers,O.ElementRef,O.Renderer],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),O["\u0275pod"]({"fa-caret-down":0,"fa-caret-right":1}),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[["class","italic"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,[""," - ",""])),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,5,"input",[["class","pull-right"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"click"],[null,"change"],[null,"blur"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==O["\u0275nov"](n,13).onChange(l.target.checked)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,13).onTouched()&&t}if("click"===e){o.toggleHideEdge(n.parent.context.$implicit.edge);t=!1!==l.stopPropagation()&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.b,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.b]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n        "])),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275eld"](0,null,1,1,"edge-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,e,l){var t=!0,o=n.component;if("propertiesChange"===e){t=!1!==(n.parent.context.$implicit.edge.properties=l)&&t}if("onChange"===e){t=!1!==o.edgePropertiesChanged(n.parent.context.$implicit.edge)&&t}return t},p,on)),O["\u0275did"](376832,null,0,ln,[O.KeyValueDiffers],{properties:[0,"properties"],defaults:[1,"defaults"]},{onChange:"onChange"}),(n()(),O["\u0275ted"](1,["\n      "]))],function(n,e){var l=e.component;n(e,1,0);n(e,6,0,"fa",n(e,7,0,null==O["\u0275nov"](e,1)?null:O["\u0275nov"](e,1).isOpen,!(null==O["\u0275nov"](e,1)?null:O["\u0275nov"](e,1).isOpen))),n(e,15,0,!e.parent.context.$implicit.edge.properties.hidden),n(e,21,0,e.parent.context.$implicit.edge.properties,l._seqTrip._tripData.defaultEdgeProp)},function(n,e){var l=e.component;n(e,0,0,e.parent.context.$implicit.edge.properties.hidden,O["\u0275nov"](e,1).isOpen),n(e,10,0,l.origin(e.parent.context.$implicit.edge).label,l.destination(e.parent.context.$implicit.edge).label),n(e,12,0,O["\u0275nov"](e,17).ngClassUntouched,O["\u0275nov"](e,17).ngClassTouched,O["\u0275nov"](e,17).ngClassPristine,O["\u0275nov"](e,17).ngClassDirty,O["\u0275nov"](e,17).ngClassValid,O["\u0275nov"](e,17).ngClassInvalid,O["\u0275nov"](e,17).ngClassPending)})}function k(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,7,null,null,null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275and"](16777216,null,null,1,null,_)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275and"](16777216,null,null,1,null,x)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n      "]))],function(n,e){n(e,3,0,e.context.$implicit.node),n(e,6,0,e.context.$implicit.edge)},null)}function w(n){return O["\u0275vid"](0,[(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,0,"span",[["aria-hidden","true"],["class","glyphicon glyphicon-globe"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "]))],null,null)}function T(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,9,"div",[["class","panel-body"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.selectCountry(n.context.$implicit)&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["\n           "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,3).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,3).onClick()&&t}if("colorPickerChange"===e){t=!1!==o.setCountryColor(n.context.$implicit,""+l)&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"],cpToggle:[1,"cpToggle"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n           "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["",""])),(n()(),O["\u0275ted"](null,["\n           "])),(n()(),O["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-times"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.setCountryColor(n.context.$implicit,"default")&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["\n         "]))],function(n,e){var l=e.component;n(e,3,0,l.countryColor(e.context.$implicit),e.context.$implicit===l._selectedCountry)},function(n,e){n(e,2,0,e.component.countryColor(e.context.$implicit)),n(e,6,0,e.context.$implicit)})}function L(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,19,"ul",[["class","dropdown-menu dropdown-menu-right"],["role","menu"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.autoPlaceLabels()&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["Auto place labels"])),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.resetCurves()&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["Reset curves"])),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,0,"li",[["class","divider dropdown-divider"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.download("pdf")&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["Export PDF"])),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,2,"li",[["role","menuitem"]],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,1,"a",[["class","dropdown-item"],["href","#"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.download("svg")&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["Export SVG"])),(n()(),O["\u0275ted"](null,["\n    "]))],null,null)}function M(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,0,"div",[["class","spin-loader"]],null,null,null,null,null))],null,null)}function R(n){return O["\u0275vid"](0,[O["\u0275qud"](402653184,1,{canvas:0}),(n()(),O["\u0275eld"](0,null,null,0,"link",[["href","https://fonts.googleapis.com/css?family=PT+Sans"],["rel","stylesheet"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,h)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,f)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,g)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,v)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,m)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275eld"](0,null,null,213,"div",[],[[2,"hidden",null]],null,null,null,null)),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275eld"](0,null,null,189,"div",[["class","maptabset"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275eld"](0,null,null,186,"tabset",[["type","pills"]],[[2,"tab-container",null]],null,null,rn.b,rn.a)),O["\u0275did"](180224,null,0,an.a,[un.a],{vertical:[0,"vertical"],type:[1,"type"]},null),(n()(),O["\u0275ted"](0,["\n  "])),(n()(),O["\u0275eld"](0,null,0,145,"tab",[],[[2,"active",null],[2,"tab-pane",null]],[[null,"select"]],function(n,e,l){var t=!0,o=n.component;if("select"===e){t=!1!==o.lockMap(!1)&&t}return t},null,null)),O["\u0275did"](212992,null,0,_n.a,[an.a,O.ElementRef,O.Renderer],null,{select:"select"}),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275and"](0,null,null,1,null,y)),O["\u0275did"](16384,null,0,xn.a,[O.TemplateRef,_n.a],null,null),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,138,"div",[["class","panel panel-default"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,135,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n\n        "])),(n()(),O["\u0275eld"](0,null,null,52,"div",[["class","panel panel-default"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275eld"](0,null,null,18,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,4,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,1,"label",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Format/orientation"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,9,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==O["\u0275nov"](n,46).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,46).onTouched()&&t}if("change"===e){t=!1!==o.uiSetPageSize(l.target.value)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.j,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n){return[n]},[B.j]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n               "])),(n()(),O["\u0275and"](16777216,null,null,1,null,C)),O["\u0275did"](802816,null,0,W.NgForOf,[O.ViewContainerRef,O.TemplateRef,O.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275ted"](null,["\n\n          "])),(n()(),O["\u0275eld"](0,null,null,29,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,4,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,1,"label",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Zoom / center"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n\n            "])),(n()(),O["\u0275eld"](0,null,null,1,"label",[["class","btn btn-default map-btn"]],null,[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.uiSetFrame()&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["Auto scroll/zoom"])),(n()(),O["\u0275ted"](null,["\n\n            "])),(n()(),O["\u0275eld"](0,null,null,9,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,6,"input",[["id","scaleSlider"],["max","8"],["min","0"],["step","0.000001"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,71)._handleInput(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,71).onTouched()&&t}if("compositionstart"===e){t=!1!==O["\u0275nov"](n,71)._compositionStart()&&t}if("compositionend"===e){t=!1!==O["\u0275nov"](n,71)._compositionEnd(l.target.value)&&t}if("change"===e){t=!1!==O["\u0275nov"](n,72).onChange(l.target.value)&&t}if("input"===e){t=!1!==O["\u0275nov"](n,72).onChange(l.target.value)&&t}if("blur"===e){t=!1!==O["\u0275nov"](n,72).onTouched()&&t}if("change"===e){t=!1!==o.setScale(l.target.value)&&t}if("input"===e){t=!1!==o.setScale(l.target.value)&&t}return t},null,null)),O["\u0275did"](16384,null,0,B.c,[O.Renderer2,O.ElementRef,[2,B.a]],null,null),O["\u0275did"](16384,null,0,B.m,[O.Renderer2,O.ElementRef],null,null),O["\u0275prd"](1024,null,B.e,function(n,e){return[n,e]},[B.c,B.m]),O["\u0275did"](671744,null,0,B.h,[[8,null],[8,null],[8,null],[2,B.e]],{model:[0,"model"]},null),O["\u0275prd"](2048,null,B.f,null,[B.h]),O["\u0275did"](16384,null,0,B.g,[B.f],null,null),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,6,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,0,"input",[["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!=(o._autoLockMap=!o._autoLockMap)&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Auto lock map"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275ted"](null,["\n        "])),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,78,"accordion",[["class","panel-group"],["role","tablist"],["style","display: block"]],[[1,"aria-multiselectable",0]],null,null,kn.b,kn.a)),O["\u0275did"](49152,null,0,Q.a,[wn.a],{closeOthers:[0,"closeOthers"]},null),(n()(),O["\u0275ted"](0,["\n        "])),(n()(),O["\u0275eld"](0,null,0,44,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"panel-open",null]],null,null,J.b,J.a)),O["\u0275did"](245760,null,0,Y.a,[Q.a],null,null),(n()(),O["\u0275ted"](1,["\n          "])),(n()(),O["\u0275eld"](0,null,0,2,"p",[["accordion-heading",""]],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-map-o"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Map colors"])),(n()(),O["\u0275ted"](1,["\n          "])),(n()(),O["\u0275eld"](0,null,1,36,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,7,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,104).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,104).onClick()&&t}if("colorPickerChange"===e){t=!1!==o.setLandColor(l)&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Land color"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,7,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,113).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,113).onClick()&&t}if("colorPickerChange"===e){t=!1!==o.setSeaColor(l)&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Sea color"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,7,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](16777216,null,null,1,"input",[["class","small form-control"]],[[4,"background",null]],[[null,"colorPickerChange"],[null,"input"],[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("input"===e){t=!1!==O["\u0275nov"](n,122).inputChange(l.target.value)&&t}if("click"===e){t=!1!==O["\u0275nov"](n,122).onClick()&&t}if("colorPickerChange"===e){t=!1!==o.setBorderColor(l)&&t}return t},null,null)),O["\u0275did"](606208,null,0,j.ColorPickerDirective,[O.Injector,O.ComponentFactoryResolver,O.ApplicationRef,O.ViewContainerRef,O.ElementRef,U.ColorPickerService],{colorPicker:[0,"colorPicker"]},{colorPickerChange:"colorPickerChange"}),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Border color"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,6,"div",[["class","map-colors"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,0,"input",[["type","checkbox"]],[[8,"checked",0]],[[null,"change"]],function(n,e,l){var t=!0,o=n.component;if("change"===e){t=!1!==o.toggleShowRiver()&&t}return t},null,null)),(n()(),O["\u0275ted"](null,["\n              "])),(n()(),O["\u0275eld"](0,null,null,1,"span",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Show rivers"])),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275ted"](null,["\n          "])),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275ted"](0,["\n\n        "])),(n()(),O["\u0275eld"](0,null,0,13,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"panel-open",null]],null,null,J.b,J.a)),O["\u0275did"](245760,null,0,Y.a,[Q.a],null,null),(n()(),O["\u0275ted"](1,["\n          "])),(n()(),O["\u0275eld"](0,null,0,3,"p",[["accordion-heading",""]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-font"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Default text properties\n          "])),(n()(),O["\u0275ted"](1,["\n          "])),(n()(),O["\u0275eld"](0,null,1,4,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,1,"text-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,e,l){var t=!0,o=n.component;if("propertiesChange"===e){t=!1!==(o._seqTrip._tripData.defaultTextProp=l)&&t}if("onChange"===e){t=!1!==o.nodePropertiesChanged()&&t}return t},i,K)),O["\u0275did"](376832,null,0,G,[U.ColorPickerService,O.KeyValueDiffers],{properties:[0,"properties"],noReset:[1,"noReset"]},{onChange:"onChange"}),(n()(),O["\u0275ted"](null,["\n\n          "])),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275ted"](0,["\n\n        "])),(n()(),O["\u0275eld"](0,null,0,13,"accordion-group",[["class","panel"],["style","display: block"]],[[2,"panel-open",null]],null,null,J.b,J.a)),O["\u0275did"](245760,null,0,Y.a,[Q.a],null,null),(n()(),O["\u0275ted"](1,["\n          "])),(n()(),O["\u0275eld"](0,null,0,3,"p",[["accordion-heading",""]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-arrows-h"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Default line properties\n          "])),(n()(),O["\u0275ted"](1,["\n          "])),(n()(),O["\u0275eld"](0,null,1,4,"div",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n            "])),(n()(),O["\u0275eld"](0,null,null,1,"edge-prop",[],null,[[null,"propertiesChange"],[null,"onChange"]],function(n,e,l){var t=!0,o=n.component;if("propertiesChange"===e){t=!1!==(o._seqTrip._tripData.defaultEdgeProp=l)&&t}if("onChange"===e){t=!1!==o.edgePropertiesChanged()&&t}return t},p,on)),O["\u0275did"](376832,null,0,ln,[O.KeyValueDiffers],{properties:[0,"properties"],noReset:[1,"noReset"]},{onChange:"onChange"}),(n()(),O["\u0275ted"](null,["\n\n          "])),(n()(),O["\u0275ted"](1,["\n        "])),(n()(),O["\u0275ted"](0,["\n      "])),(n()(),O["\u0275ted"](null,["\n\n      "])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](0,["\n\n\n\n  "])),(n()(),O["\u0275eld"](0,null,0,13,"tab",[],[[2,"active",null],[2,"tab-pane",null]],[[null,"select"]],function(n,e,l){var t=!0,o=n.component;if("select"===e){t=!1!==o.lockMap(!0)&&t}return t},null,null)),O["\u0275did"](212992,null,0,_n.a,[an.a,O.ElementRef,O.Renderer],null,{select:"select"}),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275and"](0,null,null,1,null,b)),O["\u0275did"](16384,null,0,xn.a,[O.TemplateRef,_n.a],null,null),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,6,"accordion",[["class","panel-group"],["id","long-accord"],["role","tablist"],["style","display: block"]],[[1,"aria-multiselectable",0]],null,null,kn.b,kn.a)),O["\u0275did"](49152,null,0,Q.a,[wn.a],null,null),(n()(),O["\u0275ted"](0,["\n      "])),(n()(),O["\u0275and"](16777216,null,0,1,null,k)),O["\u0275did"](802816,null,0,W.NgForOf,[O.ViewContainerRef,O.TemplateRef,O.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),O["\u0275ted"](0,["  "])),(n()(),O["\u0275ted"](0,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](0,["\n\n  "])),(n()(),O["\u0275eld"](0,null,0,20,"tab",[],[[2,"active",null],[2,"tab-pane",null]],[[null,"select"]],function(n,e,l){var t=!0,o=n.component;if("select"===e){t=!1!==o.lockMap(!0)&&t}return t},null,null)),O["\u0275did"](212992,null,0,_n.a,[an.a,O.ElementRef,O.Renderer],null,{select:"select"}),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275and"](0,null,null,1,null,w)),O["\u0275did"](16384,null,0,xn.a,[O.TemplateRef,_n.a],null,null),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,13,"div",[["class","panel panel-default"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,10,"div",[["class","panel-body"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n        "])),(n()(),O["\u0275eld"](0,null,null,1,"label",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Country colors"])),(n()(),O["\u0275ted"](null,["\n        "])),(n()(),O["\u0275eld"](0,null,null,1,"p",[],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["Click on a country to select its color"])),(n()(),O["\u0275ted"](null,["\n        "])),(n()(),O["\u0275and"](16777216,null,null,1,null,T)),O["\u0275did"](802816,null,0,W.NgForOf,[O.ViewContainerRef,O.TemplateRef,O.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](0,["\n\n"])),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275ted"](null,["\n\n"])),(n()(),O["\u0275eld"](0,null,null,3,"div",[["class","floatleft"]],[[4,"width","px"]],null,null,null,null)),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275eld"](0,[[1,0],["mapCanvas",1]],null,0,"canvas",[],[[4,"width","px"],[4,"height","px"],[1,"width",0],[1,"height",0]],null,null,null,null)),(n()(),O["\u0275ted"](null,["\n"])),(n()(),O["\u0275ted"](null,["\n\n  "])),(n()(),O["\u0275eld"](16777216,null,null,14,"span",[["class","floatright btn-group"],["dropdown",""],["style","width:auto;"]],[[2,"dropup",null],[2,"open",null],[2,"show",null]],null,null,null,null)),O["\u0275prd"](512,null,Tn.a,Tn.a,[]),O["\u0275did"](212992,null,0,Ln.a,[O.ElementRef,O.Renderer,O.ViewContainerRef,Mn.a,Rn.a,Tn.a],null,null),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275eld"](0,null,null,6,"button",[["class","btn btn-default dropdown-toggle thinbutton"],["dropdownToggle",""],["type","button"]],[[1,"aria-haspopup",0],[1,"disabled",0],[1,"aria-expanded",0]],[[null,"click"],["document","click"],[null,"keyup.esc"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==O["\u0275nov"](n,221).onClick()&&t}if("document:click"===e){t=!1!==O["\u0275nov"](n,221).onDocumentClick(l)&&t}if("keyup.esc"===e){t=!1!==O["\u0275nov"](n,221).onEsc()&&t}return t},null,null)),O["\u0275did"](147456,null,0,Sn.a,[Tn.a,O.ElementRef],null,null),(n()(),O["\u0275ted"](null,["\n      "])),(n()(),O["\u0275eld"](0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-cogs"]],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,0,"br",[],null,null,null,null,null)),(n()(),O["\u0275eld"](0,null,null,0,"span",[["class","caret"]],null,null,null,null,null)),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275ted"](null,["\n    "])),(n()(),O["\u0275and"](16777216,null,null,1,null,L)),O["\u0275did"](16384,null,0,Dn.a,[Tn.a,O.ViewContainerRef,O.TemplateRef],null,null),(n()(),O["\u0275ted"](null,["\n  "])),(n()(),O["\u0275ted"](null,["\n\n\n"])),(n()(),O["\u0275ted"](null,["\n\n"])),(n()(),O["\u0275and"](16777216,null,null,1,null,M)),O["\u0275did"](16384,null,0,W.NgIf,[O.ViewContainerRef,O.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),O["\u0275ted"](null,["\n"]))],function(n,e){var l=e.component;n(e,4,0,l._errorMessage),n(e,7,0,l._infoMessage),n(e,10,0,!l._loadingMap&&0==l._numLocations),n(e,13,0,l._loadingMap),n(e,16,0,l._numLocations>0&&!l._visitedPlaceList.length);n(e,23,0,!0,"pills"),n(e,26,0),n(e,48,0,l._pageSizeName),n(e,53,0,l._pageSizes),n(e,74,0,l.scale());n(e,90,0,!0),n(e,93,0),n(e,104,0,l._seqTrip.landColor()),n(e,113,0,l._seqTrip.seaColor()),n(e,122,0,l._seqTrip.borderColor()),n(e,139,0);n(e,149,0,l._seqTrip._tripData.defaultTextProp,!0),n(e,154,0);n(e,164,0,l._seqTrip._tripData.defaultEdgeProp,!0),n(e,173,0),n(e,182,0,l._interleaved),n(e,188,0),n(e,204,0,l.tunedCountries()),n(e,218,0),n(e,234,0,l._showSpinner)},function(n,e){var l=e.component;n(e,18,0,!l._visitedPlaceList.length),n(e,22,0,O["\u0275nov"](e,23).clazz),n(e,25,0,O["\u0275nov"](e,26).active,O["\u0275nov"](e,26).addClass),n(e,45,0,O["\u0275nov"](e,50).ngClassUntouched,O["\u0275nov"](e,50).ngClassTouched,O["\u0275nov"](e,50).ngClassPristine,O["\u0275nov"](e,50).ngClassDirty,O["\u0275nov"](e,50).ngClassValid,O["\u0275nov"](e,50).ngClassInvalid,O["\u0275nov"](e,50).ngClassPending),n(e,70,0,O["\u0275nov"](e,76).ngClassUntouched,O["\u0275nov"](e,76).ngClassTouched,O["\u0275nov"](e,76).ngClassPristine,O["\u0275nov"](e,76).ngClassDirty,O["\u0275nov"](e,76).ngClassValid,O["\u0275nov"](e,76).ngClassInvalid,O["\u0275nov"](e,76).ngClassPending),n(e,81,0,l._autoLockMap),n(e,89,0,O["\u0275nov"](e,90).closeOthers),n(e,92,0,O["\u0275nov"](e,93).isOpen),n(e,103,0,l._seqTrip.landColor()),n(e,112,0,l._seqTrip.seaColor()),n(e,121,0,l._seqTrip.borderColor()),n(e,130,0,l._seqTrip.showRivers()),n(e,138,0,O["\u0275nov"](e,139).isOpen),n(e,153,0,O["\u0275nov"](e,154).isOpen),n(e,172,0,O["\u0275nov"](e,173).active,O["\u0275nov"](e,173).addClass),n(e,178,0,O["\u0275nov"](e,179).closeOthers),n(e,187,0,O["\u0275nov"](e,188).active,O["\u0275nov"](e,188).addClass),n(e,211,0,l._canvasWidth),n(e,213,0,l._canvasWidth,l._canvasHeight,l._canvasWidth*l.pixelRatio(),l._canvasHeight*l.pixelRatio()),n(e,216,0,O["\u0275nov"](e,218).dropup,O["\u0275nov"](e,218).isOpen,O["\u0275nov"](e,218).isOpen&&O["\u0275nov"](e,218).isBs4);n(e,220,0,!0,O["\u0275nov"](e,221).isDisabled,O["\u0275nov"](e,221).isOpen)})}function S(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"trip-map",[],null,[["window","beforeunload"]],function(n,e,l){var t=!0;if("window:beforeunload"===e){t=!1!==O["\u0275nov"](n,1).doSomething(l)&&t}return t},R,On)),O["\u0275did"](4440064,null,0,Pn,[sn.c],null,null)],function(n,e){n(e,1,0)},null)}function D(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"trip-map",[],null,[["window","beforeunload"]],function(n,e,l){var t=!0;if("window:beforeunload"===e){t=!1!==O["\u0275nov"](n,1).doSomething(l)&&t}return t},R,On)),O["\u0275did"](4440064,null,0,Pn,[sn.c],null,null),(n()(),O["\u0275ted"](null,["\n"]))],function(n,e){n(e,1,0)},null)}function E(n){return O["\u0275vid"](0,[(n()(),O["\u0275eld"](0,null,null,1,"app-root",[],null,null,null,D,zn)),O["\u0275did"](49152,null,0,z,[],null,null)],null,null)}Object.defineProperty(e,"__esModule",{value:!0});var O=l("/oeL"),I=function(){function n(){}return n}(),z=function(){function n(){}return n}(),N=l("A6LD"),F=l("DdBX"),q=[""],A=[".maptabset[_ngcontent-%COMP%]    .panel-heading{padding:10px 15px}.maptabset[_ngcontent-%COMP%]    .panel{margin-bottom:1px}tabset[_ngcontent-%COMP%]    .nav-stacked{float:left}tabset[_ngcontent-%COMP%]    .tab-content{float:left;width:305px;margin-right:6px}.inline[_ngcontent-%COMP%]{display:inline-block}.floatleft[_ngcontent-%COMP%]{float:left}.floatright[_ngcontent-%COMP%]{float:right}.nodeSelected[_ngcontent-%COMP%]{font-weight:700}.nodeSkipped[_ngcontent-%COMP%]{color:gray}.small[_ngcontent-%COMP%]{width:25px;height:25px}button.delete[_ngcontent-%COMP%]{margin-top:2px;margin-right:.8em;background-color:#d3d3d3;color:red}div.maptabset[_ngcontent-%COMP%]{float:left}tab[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:100%} .square{width:10px;height:10px;display:inline-block;margin:3px}.hidden[_ngcontent-%COMP%]{display:none}.global-buttons[_ngcontent-%COMP%]{margin-bottom:20px}.maptabset[_ngcontent-%COMP%]    .nav-pills{margin-right:6px}.maptabset[_ngcontent-%COMP%]    .nav-item{border-right:1px solid #ddd;margin:0}.maptabset[_ngcontent-%COMP%]    .nav-item.active{border-top:1px solid #ddd;border-bottom:1px solid #ddd;border-left:1px solid #ddd;border-right:0}.maptabset[_ngcontent-%COMP%]    .nav-item.active  a{color:#428bca;background-color:#fff}.maptabset[_ngcontent-%COMP%]    .tab-content  button{width:100%}.spin-loader[_ngcontent-%COMP%]{position:absolute;bottom:-20px;left:0;right:0;top:-20px;z-index:10000;background:url(/ng-map/assets/loader.gif) 50% no-repeat;background-size:80px 80px;background-color:rgba(0,0,0,.6);display:block}.map-colors[_ngcontent-%COMP%]{position:relative;padding:5px 0}.map-colors[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:40px;top:11px}.map-btn[_ngcontent-%COMP%]{margin-top:10px}.in-margin-top[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.fa-right-margin[_ngcontent-%COMP%]{margin-right:7px}.form-control-input[_ngcontent-%COMP%]{display:inline-block;margin-right:10px;height:34px;padding:6px 12px;font-size:12px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.italic[_ngcontent-%COMP%]{font-style:italic;padding-left:12px;font-size:12px}.btn-group[_ngcontent-%COMP%]{width:100%}.form-control[_ngcontent-%COMP%]{margin-top:5px}accordion-group[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}accordion-group[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{margin-right:10px;color:#428bca}#accordion-menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;cursor:pointer;padding:10px 20px;margin:0;border-top-left-radius:4px;border-top-right-radius:4px;border:1px solid #ddd;box-shadow:0 1px 1px rgba(0,0,0,.05)}#accordion-menu[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{border:1px solid #ddd;padding:20px 15px 10px;color:#333;background-color:#fff;border-color:#ddd;display:none;margin:0}#accordion-menu[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none}#accordion-menu[_ngcontent-%COMP%]   .collapsable-menu[_ngcontent-%COMP%]{display:none}#accordion-menu[_ngcontent-%COMP%]   .uncollapsable-menu[_ngcontent-%COMP%]{display:block}#long-accord[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto;padding-right:5px}#long-accord[_ngcontent-%COMP%]::-webkit-scrollbar{background-color:#eee;width:6px}#long-accord[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#999;border-radius:6px}.thinbutton[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}#scaleSlider[_ngcontent-%COMP%]{padding:15px}.hflex-container[_ngcontent-%COMP%]{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-pack:start;-webkit-box-pack:start;justify-content:flex-start;-ms-flex-line-pack:stretch;align-content:stretch;-ms-flex-align:start;-webkit-box-align:start;align-items:flex-start}.flex-item-narrow[_ngcontent-%COMP%], .flex-item-wide[_ngcontent-%COMP%]{-ms-flex-order:0;-webkit-box-ordinal-group:1;order:0;-webkit-align-self:auto;-ms-flex-item-align:auto;-ms-grid-row-align:auto;align-self:auto}.flex-item-narrow[_ngcontent-%COMP%]{-ms-flex:0 1 auto;-webkit-box-flex:0;flex:0 1 auto}.flex-item-wide[_ngcontent-%COMP%]{-ms-flex:1 1 auto;-webkit-box-flex:1;flex:1 1 auto}"],B=l("bm2B"),V=[".small[_ngcontent-%COMP%]{width:25px;height:25px}.root[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative}input[_ngcontent-%COMP%]{display:inline-block}input[type=number][_ngcontent-%COMP%]{width:5em}i.fa-recycle[_ngcontent-%COMP%]{float:right}.text-prop-colors[_ngcontent-%COMP%]{position:relative;padding:5px 0}.text-prop-colors[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:40px;top:7px}.font-size-margin[_ngcontent-%COMP%]{margin:5px 0 8px}"],W=l("qbdv"),j=l("ZHSE"),U=l("QMm5"),Z=l("XB9w"),G=function(){function n(n,e){this.cpService=n,this.differs=e,this.onChange=new O.EventEmitter,this.defaultsDiffer=e.find({}).create(null),this.propertiesDiffer=e.find({}).create(null)}return n.prototype.ngOnInit=function(){},n.prototype.changeEvent=function(){this.onChange.emit(this.properties)},n.prototype.ngDoCheck=function(){var n=this.defaultsDiffer.diff(this.defaults)||this.propertiesDiffer.diff(this.properties);return n&&this.readProperties(),n},n.prototype.readProperties=function(){for(var n=0,e=["fill","stroke","fontSize"];n<e.length;n++){var l=e[n];this.properties&&l in this.properties?this[l]=this.properties[l]:this.defaults&&l in this.defaults?this[l]=this.defaults[l]:this[l]="stroke"==l||"fill"==l?"#000000":void 0}},n.prototype.hasDefault=function(){for(var n=0,e=["fill","stroke","fontSize"];n<e.length;n++){if(e[n]in this.properties)return!1}return!0},n.prototype.setProperty=function(n){this.properties[n]=this[n],this.changeEvent()},n.prototype.resetToDefault=function(){for(var n=0,e=["fill","stroke","fontSize"];n<e.length;n++){var l=e[n];delete this.properties[l]}this.readProperties(),this.changeEvent()},n.ctorParameters=function(){return[{type:Z.ColorPickerService},{type:O.KeyValueDiffers}]},n}(),H=[V],K=O["\u0275crt"]({encapsulation:0,styles:H,data:{}}),X=(O["\u0275ccf"]("text-prop",G,r,{properties:"properties",defaults:"defaults",noReset:"noReset"},{properties:"properties",onChange:"onChange"},[]),l("QO87")),J=l("uDoG"),Y=l("2dRj"),Q=l("m6EG"),nn=[".form-control[_ngcontent-%COMP%]{width:10em;display:inline-block}.small[_ngcontent-%COMP%]{width:25px;height:25px}.edge-prop-colors[_ngcontent-%COMP%]{position:relative;padding:5px 0}.edge-prop-colors[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:40px;top:7px}.input-form-control-margin[_ngcontent-%COMP%]{margin:10px 0}"],en=function(){function n(n,e){this.name=n.replace(/-/g,"\u2501").replace(/ /g," \xa0"),this.style=e}return n.prototype.key=function(){return name},n}(),ln=function(){function n(n){this.differs=n,this.onChange=new O.EventEmitter,this.defaultsDiffer=n.find({}).create(null),this.propertiesDiffer=n.find({}).create(null),this.allLineStyles=[new en("------",[]),new en("- - - ",[4,4]),new en("--  --",[8,8])],this.allTravelMeans=["Unspecified","Bike","Boat","Bus","Car","Helicopter","Plane","Train","Walk"]}return n.prototype.changeEvent=function(){this.setProp("lineWidth"),this.onChange.emit(this.properties)},n.prototype.ngOnInit=function(){this.readProperties()},n.prototype.ngDoCheck=function(){var n=this.defaultsDiffer.diff(this.defaults)||this.propertiesDiffer.diff(this.properties);return n&&this.readProperties(),n},n.prototype.readProperties=function(){for(var n={lineColor:"#000000",lineWidth:2,travelMean:"Unspecified",geom:"straight"},e=0,l=Object.keys(n);e<l.length;e++){var t=l[e];this.properties&&t in this.properties?this[t]=this.properties[t]:this.defaults&&t in this.defaults?this[t]=this.defaults[t]:this[t]=n[t]}var o;if(this.properties&&this.properties.dashed?o=this.properties.dashed:this.defaults&&this.defaults.dashed&&(o=this.defaults.dashed),o)for(var i=0,r=this.allLineStyles;i<r.length;i++){var a=r[i];this.sameStyles(a.style,o)&&(this.lineStyle=a.name)}else this.lineStyle=this.allLineStyles[0].name},n.prototype.sameStyles=function(n,e){if(!n||!e)return!1;if(n===e)return!0;if(n.length!=e.length)return!1;for(var l=0;l<n.length;++l)if(n[l]!=e[l])return!1;return!0},n.prototype.setProp=function(n){this.properties&&(this.defaults&&this[n]===this.defaults[n]?this.properties[n]&&delete this.properties[n]:this.properties[n]=this[n])},n.prototype.colorChanged=function(){this.setProp("lineColor"),this.changeEvent()},n.prototype.resetToDefault=function(){for(var n=0,e=Object.keys(this.properties);n<e.length;n++){var l=e[n];delete this.properties[l]}this.readProperties(),this.changeEvent()},n.prototype.hasDefault=function(){for(var n=["lineColor","lineWidth","travelMean","dashed"],e=0,l=n;e<l.length;e++){if(l[e]in this.properties)return!1}return!0},n.prototype.setLineStyle=function(n){for(var e=0,l=this.allLineStyles;e<l.length;e++){var t=l[e];t.name===n&&(this.properties.dashed=t.style)}this.changeEvent()},n.prototype.setTravelMean=function(n){this.travelMean=n,this.setProp("travelMean"),this.changeEvent()},n.prototype.setGeom=function(n){this.geom=n,this.setProp("geom"),this.changeEvent()},n.ctorParameters=function(){return[{type:O.KeyValueDiffers}]},n}(),tn=[nn],on=O["\u0275crt"]({encapsulation:0,styles:tn,data:{}}),rn=(O["\u0275ccf"]("edge-prop",ln,c,{properties:"properties",defaults:"defaults",noReset:"noReset"},{properties:"properties",onChange:"onChange"},[]),l("UbUN")),an=l("1sP3"),un=l("5bcs"),sn=l("XKz0"),dn=function(){function n(n,e){if("number"==typeof n&&"number"==typeof e?(this.x=n,this.y=e):Array.isArray(n)?(this.x=n[0],this.y=n[1]):"object"==typeof n&&(this.x=n.x,this.y=n.y),void 0===this.x||void 0===this.y)throw new Error("invalid point")}return n.minus=function(e,l){return new n(e.x-l.x,e.y-l.y)},n.plus=function(e,l){return new n(e.x+l.x,e.y+l.y)},n.times=function(e,l){return new n(e*l.x,e*l.y)},n.min=function(e,l){return new n(Math.min(e.x,l.x),Math.min(e.y,l.y))},n.max=function(e,l){return new n(Math.max(e.x,l.x),Math.max(e.y,l.y))},n.dist=function(n,e){var l=n.x-e.x,t=n.y-e.y;return Math.sqrt(l*l+t*t)},n.norm=function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},n.nearest=function(e,l){for(var t,o,i=0,r=l;i<r.length;i++){var a=r[i],u=n.dist(a,e);(void 0===t||u<o)&&(o=u,t=a)}return t},n.prototype.add=function(n){return this.x+=n.x,this.y+=n.y,this},n.prototype.sub=function(n){return this.x-=n.x,this.y-=n.y,this},n.prototype.mul=function(n){return this.x*=n,this.y*=n,this},n.prototype.norm=function(){return n.norm(this)},n}(),pn=function(){function n(n){n&&(n.min&&(this.min=new dn(n.min)),n.max&&(this.max=new dn(n.max)))}return n.closestPoint=function(n,e){var l=new dn(0,0);for(var t in l)n[t]<e.min[t]?l[t]=e.min[t]:n[t]>e.max[t]?l[t]=e.max[t]:l[t]=n[t];return l},n.overlaps=function(n,e){return!(n.max.x<e.min.x||n.min.x>e.max.x||n.max.y<e.min.y||n.min.y>e.max.y)},n.contains=function(n,e){return e.x>=n.min.x&&e.x<=n.max.x&&e.y>=n.min.y&&e.y<=n.max.y},n.prototype.addPoint=function(n){this.min=void 0===this.min?n:dn.min(this.min,n),this.max=void 0===this.max?n:dn.max(this.max,n)},n.prototype.addArray=function(n){for(var e=0,l=n;e<l.length;e++){var t=l[e];this.addPoint(t)}},n.prototype.overlaps=function(e){return n.overlaps(this,e)},n.prototype.contains=function(e){return n.contains(this,e)},n}(),cn=function(){function n(n,e){var l=n||{};this.nodes=l.node||{},this.edges=l.edges||[],this.defaultEdgeProp=e}return n.generateControlPoints=function(n,e,l,t){var o=dn.minus(l,e).mul(1/3),i=new dn(-o.y,o.x);return[dn.plus(dn.plus(e,o),i),dn.plus(dn.minus(l,o),i)]},n.bezierFromPoints=function(n){for(var e=[],l=0;l<4;++l)e.push(n[l].x),e.push(n[l].y);return new Bezier(e)},n.bezierThroughPoints=function(e){for(var l=[],t=1;t<e.length;++t){var o=1===t?e[t-1]:e[t-2],i=e[t-1],r=e[t],a=t===e.length-1?e[t]:e[t+1];l.push(n.bezierFromPoints([i,dn.plus(i,dn.times(.2,dn.minus(r,o))),dn.plus(r,dn.times(.2,dn.minus(i,a))),r]))}return l},n.placeLeaderLine=function(n){n.properties||(n.properties={});var e,l=n.properties.leaderLine||"bestAnchor",t=n.properties.labelBbox;if("center"===l){var o=(t.max.x,t.min.x,new dn((t.min.x+t.max.x)/2,(t.min.y+t.max.y)/2)),i=dn.minus(n.coord,o);i.mul(.02),e=dn.plus(o,i)}else e="closestOnBbox"===l?pn.closestPoint(n.coord,t):d3.labeler.closestLineAnchorPoint(n.coord,{left:t.min.x,right:t.max.x,top:t.min.y,bottom:t.max.y,cx:(t.min.x+t.max.x)/2,cy:(t.min.y+t.max.y)/2});n.properties.leaderLineAnchor=e},n.prototype.createDefaultBezier=function(){for(var e in this.edges){var l=this.edges[e],t=this.nodes[l.from],o=this.nodes[l.to];l.controlPoints=n.generateControlPoints(void 0,t.coord,o.coord,void 0)}},n.prototype.bezier=function(e){if(!e.controlPoints||e.properties.hidden)return[];if("straight"==e.properties.geom||!e.properties.geom&&"straight"==this.defaultEdgeProp.geom)return n.bezierThroughPoints([this.nodes[e.from].coord,this.nodes[e.to].coord]);if(2===e.controlPoints.length){var l=[this.nodes[e.from].coord,e.controlPoints[0],e.controlPoints[1],this.nodes[e.to].coord];return[n.bezierFromPoints(l)]}if(5===e.controlPoints.length){var t=[this.nodes[e.from].coord,e.controlPoints[0],e.controlPoints[1],e.controlPoints[2]],o=[e.controlPoints[2],e.controlPoints[3],e.controlPoints[4],this.nodes[e.to].coord];return[n.bezierFromPoints(t),n.bezierFromPoints(o)]}var i=[this.nodes[e.from].coord].concat(e.controlPoints,[this.nodes[e.to].coord]);return n.bezierThroughPoints(i)},n.prototype.bounds=function(){var n=new pn;for(var e in this.nodes)n.addPoint(this.nodes[e].coord);return n},n.prototype.frame=function(n,e){var l=this.bounds();if(e=e||1.1,l.max&&l.min){if(l.min.x===l.max.x){var t=new dn(1/32,1/32);l.addPoint(dn.plus(l.min,t)),l.addPoint(dn.minus(l.min,t))}}else l.min=new dn(0,0),l.max=new dn(1,1),e=1;n=n||(l.max.x-l.min.x)/(l.max.y-l.min.y);var o="number"==typeof e?new dn(e,e):e,i=dn.minus(l.max,l.min);i.x*=o.x,i.y*=o.y;var r,a=i.y*n;r=i.x>a?new dn(i.x,i.x/n):new dn(i.y*n,i.y),r.mul(.5);var u=dn.times(.5,dn.plus(l.max,l.min)),s=new pn;return s.addPoint(dn.minus(u,r)),s.addPoint(dn.plus(u,r)),s},n.prototype.location=function(n,e){var l=this.frame(n,e);l.max.x,l.min.x;return{x:(l.max.x+l.min.x)/2,y:(l.max.y+l.min.y)/2,scale:Math.max(1/32768,l.max.x-l.min.x)}},n.prototype.compareNodes=function(n){var e=function(n,e){for(var l in n)if(!(l in e))return!1;return!0};return e(this.nodes,n.nodes)&&e(n.nodes,this.nodes)},n}(),hn=function(){function n(n,e){this.graph=e,this.renderer=n}return n.prototype.acceptTouchEvent=function(n,e,l){if("wheel"===l)return!1;this.startWorldPos=new dn(e);var t=this.findLabelAtWorldPos(this.startWorldPos);if(t){this.selectLabel(t);var o=t.properties;return this.applyDelta=function(n){o.labelCoord.x+=n.x,o.labelCoord.y+=n.y,o.labelBbox.min.x+=n.x,o.labelBbox.min.y+=n.y,o.labelBbox.max.x+=n.x,o.labelBbox.max.y+=n.y,o.userPlacement=new dn(o.labelCoord),cn.placeLeaderLine(t),this.onLabelMoved&&this.onLabelMoved(t)},!0}var i=this.closestBezier(e),r=this.renderer.pinchZoom.worldDistanceFromViewerDistance(10*this.renderer.pixelRatio);if(i&&i.d<r){var a=this,u=function(n){a.applyDelta=function(e){if(n){for(var l=Array.isArray(n)?n:[n],t=0,o=l;t<o.length;t++){var r=o[t];r.x+=e.x,r.y+=e.y}this.onBezierMoved&&this.onBezierMoved(i)}}},s=function(n,e,l){a.applyDelta=function(l){n.x+=l.x,n.y+=l.y,e.x+=l.x/2,e.y+=l.y/2}};return 2===i.edge.controlPoints.length?u(i.edge.controlPoints[i.t<.5?0:1]):5===i.edge.controlPoints.length?i.bezier.points[1].x===i.edge.controlPoints[0].x&&i.bezier.points[1].y===i.edge.controlPoints[0].y?i.t<.5?u(i.edge.controlPoints[0]):i.t<.9?s(i.edge.controlPoints[1],i.edge.controlPoints[2],i.edge.controlPoints[3]):u([i.edge.controlPoints[1],i.edge.controlPoints[2],i.edge.controlPoints[3]]):i.t<.1?u([i.edge.controlPoints[1],i.edge.controlPoints[2],i.edge.controlPoints[3]]):i.t<.5?s(i.edge.controlPoints[3],i.edge.controlPoints[2],i.edge.controlPoints[1]):u(i.edge.controlPoints[4]):u(dn.nearest(e,i.edge.controlPoints)),this.selectBezier(i),!0}return this.applyDelta=void 0,!1},n.prototype.selectLabel=function(n){this.selectedLabel&&delete this.selectedLabel.properties.frame,this.selectedLabel=void 0,this.selectBezier(),this.selectedLabel=n,this.onLabelSelect&&this.onLabelSelect(n),n&&(n.properties=n.properties||{},n.properties.frame="#000000"),this.renderer.refreshIfNotMoving()},n.prototype.deselectLabel=function(){return this.selectLabel()},n.prototype.handleMouseDown=function(n){n.preventDefault()},n.prototype.handleMouseMove=function(n){n.preventDefault();var e=Utils.eventPosInElementCoordinates(n,n.target||n.srcElement);this.handleMotion(e)},n.prototype.handleMotion=function(n){if(this.applyDelta){var e=this.renderer.pinchZoom.worldPosFromViewerPos(n.x,n.y),l={x:e.x-this.startWorldPos.x,y:e.y-this.startWorldPos.y};this.startWorldPos=e,this.applyDelta(l),this.renderer.refreshIfNotMoving()}},n.prototype.handleMouseUp=function(n){n.preventDefault(),this.applyDelta=void 0},n.prototype.handleMouseWheel=function(n){n.preventDefault()},n.prototype.handleStart=function(n){n.preventDefault()},n.prototype.handleEnd=function(n){n.preventDefault(),this.applyDelta=void 0},n.prototype.handleMove=function(n){if(n.preventDefault(),1!==n.touches.length)return void(this.applyDelta=void 0);var e=Utils.eventPosInElementCoordinates(n.touches[0],n.target||n.srcElement);this.handleMotion(e)},n.prototype.closestBezier=function(n){for(var e,l=0,t=this.graph.edges;l<t.length;l++)for(var o=t[l],i=this.graph.bezier(o),r=0,a=i;r<a.length;r++){var u=a[r],s=u.project(n);(!e||s.d<e.d)&&(e=s,e.edge=o,e.bezier=u)}return e},n.prototype.findLabelAtWorldPos=function(n){var e=this.graph.nodes;for(var l in e)if(e.hasOwnProperty(l)){var t=this.graph.nodes[l];if(t.properties&&t.properties.labelBbox&&pn.contains(t.properties.labelBbox,n))return t}},n.prototype.selectBezier=function(n){if(this.selectedBezier){var e=this.selectedBezier.edge;delete e.drawMiddlePoint,void 0!==e.properties._lineWidth?(e.properties.lineWidth=e.properties._lineWidth,delete e.properties._lineWidth):delete e.properties.lineWidth}if(this.selectedBezier=n,n){var e=n.edge;e.drawMiddlePoint=!0,void 0!==e.properties._lineWidth&&(e.properties._lineWidth=e.properties.lineWidth),e.properties.lineWidth=5}this.selectedLabel&&this.deselectLabel(),this.onBezierSelect&&this.onBezierSelect(this.selectedBezier),this.renderer.refreshIfNotMoving()},n}(),fn=function(){function n(n){if(this.params=n,this.renderer=n.renderer,this.defaultRadius=n.defaultRadius||6,this.icons={},this.defaultTextProp={fontSize:n.defaultFontSize||20,stroke:"rgba(255,255,255,.8)",fill:"#000000"},this.defaultEdgeProp=n.defaultEdgeProp||{lineWidth:1,lineColor:"#000000"},this.hideLabels=!!n.hideLabels,!this.renderer)throw new Error("TripGraphLayer: no renderer !");this.graph=n.graph||new cn(void 0,this.defaultEdgeProp)}return n.prototype.draw=function(n,e,l,t){for(var o=this.graph,i=n.getContext("2d"),r=this.renderer.pixelRatio,a=0,u=o.edges;a<u.length;a++){var s=u[a];this.drawEdge(i,e,s,r,"curve")}for(var d=0,p=o.edges;d<p.length;d++){var s=p[d];this.drawEdge(i,e,s,r,"mark")}i.setLineDash([]);for(var c in o.nodes){var h=o.nodes[c];h.viewerPos=e.viewerPosFromWorldPos(h.coord)}for(var c in o.nodes){var h=o.nodes[c];this.drawNodePoint(i,e,h)}for(var c in o.nodes)if(!this.hideLabels||c.match(/-(takeoff)|(landing)$/)){var h=o.nodes[c];this.drawLeaderLine(i,e,h)}for(var c in o.nodes)if(!this.hideLabels||c.match(/-(takeoff)|(landing)$/)){var h=o.nodes[c];this.drawNodeLabel(i,e,h)}},n.prototype.drawEdge=function(n,e,l,t,o){this.setEdgeStrokeStyle(n,l);for(var i=this.graph.bezier(l),r=0,a=i;r<a.length;r++){var u=a[r];this.drawBezier(n,e,u,t,l,o)}if("mark"!=o&&i.length>1&&l.drawMiddlePoint)for(var s in i){var d=e.viewerPosFromWorldPos(i[s].points[3]),p=5*t;n.beginPath(),n.arc(d.x,d.y,p,0,2*Math.PI,!1),n.fillStyle="#000000",n.fill()}},n.prototype.drawBezier=function(n,e,l,t,o,i){n.save();for(var r=new Array(8),a=l.points,u=0;u<4;++u){var s=e.viewerPosFromWorldPos(a[u]);r[2*u]=s.x,r[2*u+1]=s.y}var d=new Bezier(r),p=d.length(),c=Math.min(2,Math.floor(p/(40*t))),h=d.points;"mark"!=i&&(n.beginPath(),n.moveTo(h[0].x,h[0].y),n.bezierCurveTo(h[1].x,h[1].y,h[2].x,h[2].y,h[3].x,h[3].y),n.stroke());for(var f=1;f<c;++f){var g=f/c,s=new dn(d.get(g)),v=new dn(d.normal(g)),m=new dn(d.derivative(g));this.drawEdgeMark(s,v,m,n,t,o,i)}n.restore()},n.prototype.drawEdgeMark=function(e,l,t,o,i,r,a){switch(this.edgeProperty(r,"travelMean")){case"Bike":case"Boat":case"Bus":case"Car":case"Helicopter":case"Plane":case"Train":case"Walk":"curve"!=a&&this.drawEdgeMarkIcon(e,l,t,o,i,r);break;case"Unspecified":default:"mark"!=a&&n.drawEdgeMarkTriangle(e,l,t,o,i)}},n.drawEdgeMarkTriangle=function(n,e,l,t,o){var i=10*o;l.mul(i/l.norm()),n=dn.plus(n,dn.times(.5,l));var r=dn.minus(n,l);t.beginPath(),t.moveTo(r.x+i/2*e.x,r.y+i/2*e.y),t.lineTo(n.x,n.y),t.lineTo(r.x-i/2*e.x,r.y-i/2*e.y),t.closePath(),t.fill()},n.prototype.drawEdgeMarkIcon=function(n,e,l,t,o,i){t.fillStyle="#fff",t.setLineDash([]),t.lineWidth=1*o;var r=10*o,a=6*o;l=l.mul(1/l.norm());var u=dn.plus(n,dn.times((r+a)/2,l)),s=dn.minus(n,dn.times((r+a)/2,l)),d=dn.plus(s,dn.times(r,l)),p=new dn(-l.y,l.x).mul(4*o),c=dn.plus(d,p),h=dn.minus(d,p),f=dn.minus(c,s),g=Math.atan2(f.y,f.x),v=dn.minus(h,s),m=Math.atan2(v.y,v.x);t.beginPath(),t.arc(s.x,s.y,r,g,m),t.lineTo(u.x,u.y),t.closePath(),t.fill(),t.stroke(),t.fillStyle="#000",t.textAlign="center",t.textBaseline="middle",t.font=Math.round(10*o)+"px FontAwesome";var y={Bike:"\uf206",Boat:"\uf21a",Bus:"\uf207",Car:"\uf1b9",Helicopter:"H",Plane:"\uf072",Train:"\uf238",Walk:"\uf183"},C=this.edgeProperty(i,"travelMean");t.fillText(y[C],s.x,s.y)},n.prototype.edgeProperty=function(n,e){return n.properties[e]||this.defaultEdgeProp[e]},n.prototype.setEdgeStrokeStyle=function(n,e){var l=this.edgeProperty(e,"lineColor");n.strokeStyle=l,n.fillStyle=l,n.lineWidth=this.renderer.pixelRatio*this.edgeProperty(e,"lineWidth"),this.setDashStyle(n,this.edgeProperty(e,"dashed"))},n.prototype.nodeRadius=function(n){var e=this.defaultRadius;return n.properties&&n.properties.radius&&(e=n.properties.radius),e*this.renderer.pixelRatio},n.prototype.drawNodePoint=function(n,e,l){if(!l.properties||0!=l.properties.point){var t=l.viewerPos;this.drawPoint(n,t,this.renderer.pixelRatio,l.properties||{})}},n.prototype.drawNodeLabel=function(e,l,t){if(t.label||t.labelIcon){var o=l.viewerPosFromWorldPos(t.properties&&t.properties.labelCoord?t.properties.labelCoord:t.coord);if(t.label&&n.drawText(e,t.label,o,this.renderer.pixelRatio,t.properties||{},this.defaultTextProp),t.labelIcon&&t.labelIcon.url in this.icons){if(void 0!=t.labelIcon.autorotate&&t.properties.labelCoord){var i=new dn(t.coord);t.labelIcon.angle=t.labelIcon.autorotate+Math.atan2(i.y-t.properties.labelCoord.y,i.x-t.properties.labelCoord.x)}n.drawIcon(e,this.icons[t.labelIcon.url],t.labelIcon,o,this.renderer.pixelRatio)}if(t.properties&&t.properties.frame&&t.label){var r=n.measureText(e,t.label,this.renderer.pixelRatio,t.properties||{},this.defaultTextProp);e.strokeStyle=t.properties.frame,r.width+=3*this.renderer.pixelRatio,r.height+=3*this.renderer.pixelRatio,e.rect(o.x-r.width/2,o.y-r.height/2,r.width,r.height),e.stroke()}}},n.prototype.setDashStyle=function(n,e){var l=[];if(e)for(var t=0,o=e;t<o.length;t++){var i=o[t];l.push(this.renderer.pixelRatio*i)}n.setLineDash(l)},n.prototype.drawLeaderLine=function(n,e,l){if(l.properties&&l.properties.leaderLineAnchor){var t=this.renderer.pixelRatio,o=e.viewerPosFromWorldPos(l.properties.leaderLineAnchor);n.lineWidth=(l.properties.leaderLineWidth||1)*t,n.beginPath();var i=e.viewerPosFromWorldPos(l.coord),r=this.nodeRadius(l),a=e.viewerPosFromWorldPos(pn.closestPoint(new dn(l.coord),l.properties.labelBbox)),u=l.properties&&void 0!==l.properties.maxLeaderLineLength?l.properties.maxLeaderLineLength*t:3*r;dn.dist(a,i)>u&&(l.properties.dashed&&this.setDashStyle(n,l.properties.dashed),n.moveTo(o.x,o.y),n.lineTo(i.x,i.y),n.strokeStyle=l.properties.leaderLineColor||"#000000",n.stroke(),l.properties.dashed&&n.setLineDash([]))}},n.prototype.drawPoint=function(n,e,l,t){n.strokeStyle="rgba(0,0,0,1)",n.fillStyle="rgba(255,255,255,1)",n.lineWidth=2*l,n.beginPath();var o=(t.radius||this.defaultRadius)*l;n.arc(e.x,e.y,o,0,2*Math.PI,!1),n.stroke(),n.fill();var i=t.markStyle;!i&&t.firstVisited&&(i="first"),"first"===i&&(n.fillStyle="rgba(0, 0, 0, 1)",n.beginPath(),n.arc(e.x,e.y,.6*o,0,2*Math.PI,!1),n.fill())},n.measureText=function(e,l,t,o,i){var r=l.split("\n"),a=n.setTextStyle(e,t,o,i),u={width:0,height:a*r.length};for(var s in r)u.width=Math.max(u.width,e.measureText(r[s]).width);return u},n.setTextStyle=function(n,e,l,t){l=l||{};var o=l.fontSize||t.fontSize;return o*=e,n.font=o+"px "+(l.font||"'PT Sans', sans-serif"),n.strokeStyle=l.stroke||t.stroke,n.lineWidth=(l.haloWidth||4)*e,n.fillStyle=l.fill||t.fill,parseInt(""+o)},n.drawText=function(e,l,t,o,i,r){var a,u,s=(void 0!=i.textOffset?i.textOffset:20)*o,d=((i.textPlacement||"S")+"").toUpperCase();switch(d){default:case"C":case"N":case"S":e.textAlign="center",a=0;break;case"E":case"NE":e.textAlign="start",a=s;break;case"O":case"W":e.textAlign="end",a=-s}switch(d){case"C":case"E":case"W":case"O":e.textBaseline="middle",u=0;break;case"N":case"NE":e.textBaseline="bottom",u=-s;break;default:case"S":e.textBaseline="top",u=s}var p=t.x+a,c=t.y+u,h=n.setTextStyle(e,o,i,r),f=l.split("\n");e.shadowBlur=3*o,e.shadowColor="#ffffff",e.lineWidth=2*o;for(var g=(f.length-1)/2,v=0;v<f.length;++v){var m=c+(v-g)*h;e.strokeText(f[v],p,m),e.fillText(f[v],p,m)}e.shadowColor="transparent"},n.drawIcon=function(n,e,l,t,o){if(e){var i=l.width?l.width*o:16*o,r=l.height?l.height*o:i,a="ratioX"in l?l.ratioX:.5,u="ratioY"in l?l.ratioY:.5,s=i*a,d=r*u;l.angle?(n.save(),n.translate(t.x,t.y),n.rotate(l.angle),n.drawImage(e,-s,-d,i,r),n.restore()):n.drawImage(e,t.x-s,t.y-d,i,r)}},n.prototype.getLabelIconSize=function(n,e){var l=this.renderer.pixelRatio,t=e.labelIcon;return{width:(t.width||16)*l,height:(t.height||t.width||16)*l}},n.prototype.placeLabels=function(e){var l=this.renderer.pinchZoom,t=this.renderer.pixelRatio,o=[],i=[];for(var r in this.graph.nodes){var a=this.graph.nodes[r];if(a.label||a.labelIcon){var u=l.viewerPosFromWorldPos(a.coord),s=this.defaultRadius;a.properties&&a.properties.radius&&(s=a.properties.radius),i.push({x:u.x,y:u.y,r:s*t});var d=2*t,p=void 0,c=void 0;a.label?(p=n.measureText(e,a.label,t,a.properties,this.defaultTextProp),c=a.label):a.labelIcon&&(p=this.getLabelIconSize(e,a),p.width*=1.4,p.height*=1.4,c="icon:"+a.labelIcon.url);var h=u;a.properties&&a.properties.userPlacement&&(h=l.viewerPosFromWorldPos(a.properties.userPlacement));var f={x:h.x,y:h.y,name:c,width:p.width+2*d,height:p.height+2*d,node:a,userPlacement:a.properties&&a.properties.userPlacement?h:void 0};o.push(f)}}var g=d3.labeler().label(o).anchor(i).width(this.renderer.canvas.width).height(this.renderer.canvas.height),v=g.alt_energy(),m=[],y=[],C=[];for(var b in this.graph.edges){var P=this.graph.bezier(this.graph.edges[b]);for(var r in P){var _=P[r];m.push(_);var x=_.bbox();y.push({min:l.viewerPosFromWorldPos(x.x.min,x.y.min),max:l.viewerPosFromWorldPos(x.x.max,x.y.max)});var k=_.getLUT(30),w=[];for(var T in k)w.push(l.viewerPosFromWorldPos(k[T]));C.push(w)}}g.alt_energy(function(n,e,l){var t=0,i=g.boxOfLabel(n),r=new pn;r.addPoint(new dn(i.left,i.top)),r.addPoint(new dn(i.right,i.bottom));for(var a in m)if(pn.overlaps(y[a],r)){var u=C[a];for(var s in u)r.contains(u[s])&&t++}var d=10*t+v(n),p=o[n].userPlacement;if(p){d+=dn.dist(p,o[n])}return d});g.start(5e3,1);for(var r in o){var L=o[r];L.node.properties||(L.node.properties={});var M=L.node.properties,R=dn.times(.5,new dn(L.width,L.height));M.labelCoord=l.worldPosFromViewerPos(L),M.labelBbox={min:l.worldPosFromViewerPos(dn.minus(L,R)),max:l.worldPosFromViewerPos(dn.plus(L,R))},cn.placeLeaderLine(L.node),M.textPlacement="C",M.textOffset=0}},n.shallowCopy=function(n){var e,l=Object.create(Object.getPrototypeOf(n)),t=Object.getOwnPropertyNames(n);for(e=0;e<t.length;e++)Object.defineProperty(l,t[e],Object.getOwnPropertyDescriptor(n,t[e]));return l},n.prototype.makeFusedGraph=function(e){e=e||this.graph;var l={},t=function(n){for(var e=n;e in l;)e=l[e];return e},o=this.renderer.pinchZoom;for(var i in e.nodes){var r=e.nodes[i];r.viewerPos=o.viewerPosFromWorldPos(r.coord)}var a=[];for(var u in e.nodes){var r=e.nodes[u];if(r.label){var s=this.nodeRadius(r),d=!0;for(var i in a){var p=a[i];if(dn.dist(p.viewerPos,r.viewerPos)<this.nodeRadius(p)+s){a[i]=function(e,t){var o=n.shallowCopy(e);return o.name=e.name+","+t.name,o.label=e.label+"\n"+t.label,l[e.name]=l[t.name]=o.name,o}(p,r),d=!1;break}}d&&a.push(r)}}for(var u in e.nodes){var r=e.nodes[u];r.label||a.push(r)}var c=new cn(void 0,this.defaultEdgeProp);for(var i in a){var p=a[i];c.nodes[p.name]=p}for(var i in e.edges){var h=e.edges[i],f=t(h.from),g=t(h.to);if(f!=g){var v=n.shallowCopy(h);v.from=f,v.to=g,v.originalEdge=h,c.edges.push(v)}}return c},n.prototype.forEachNode=function(n){for(var e in this.graph.nodes)n(this.graph.nodes[e])},n.prototype.loadIcons=function(n){var e=this;this.iconsToLoad=1,this.failedIcons=0;var l=function(){e.iconsToLoad--,n&&0===e.iconsToLoad&&(e.failedIcons>0?n(new Error(e.failedIcons+" icons failed to load.")):n())};this.forEachNode(function(n){if(n.labelIcon){var t=n.labelIcon.url;e.iconsToLoad++,e.renderer.loadImage(n.labelIcon.url,function(n){e.icons[t]=n,l()},function(n){console.log("Failed to load: "+t),e.failedIcons++,l()})}}),l()},n}(),gn=function(){function n(){this.allPlaces=[]}return n.parse=function(e){var l=new n;l.coord=new dn(e.coord),e.place&&(e.place=n.parse(e.place)),e.viewerPos&&(l.viewerPos=new dn(e.viewerPos));for(var t=0,o=["dbid","name","label","labelIcon","properties"];t<o.length;t++){var i=o[t];e[i]&&(l[i]=e[i])}return l.name||(void 0!==l.dbid?l.name=""+l.dbid:l.label&&(l.name=l.label)),l.properties?(l.properties.labelBbox&&(l.properties.labelBbox=new pn(l.properties.labelBbox)),l.properties.leaderLineAnchor&&(l.properties.leaderLineAnchor=new dn(l.properties.leaderLineAnchor)),l.properties.labelCoord&&(l.properties.labelCoord=new dn(l.properties.labelCoord))):l.properties={},l},n.prototype.isSkipped=function(){return!(this.label&&(!this.properties||void 0===this.properties.skip))&&this.properties.skip},n}(),vn=function(){function n(e){if(this.properties={},e){if(e.controlPoints){this.controlPoints=[];for(var l=0;l<e.controlPoints.length;++l)this.controlPoints[l]=new dn(e.controlPoints[l])}e.originalEdge&&(this.originalEdge=new n(e.originalEdge));for(var t=0,o=["from","to","drawMiddlePoint","properties","fromDbId"];t<o.length;t++){var i=o[t];i in e&&(this[i]=e[i])}}}return n.prototype.propagateToOriginal=function(){if(this.originalEdge)for(var n=0,e=["controlPoints","drawMiddlePoint"];n<e.length;n++){var l=e[n];l in this&&(this.originalEdge[l]=this[l])}},n}(),mn=function(){function n(){this.reset()}return n.makePlaneIcon=function(n,e){var l=new gn;return l.name=e.dbid+"-"+n,l.labelIcon={url:"/ng-map/assets/plane.png",width:20,autorotate:Math.PI/2*("landing"===n?1:-1),ratioX:.5,ratioY:"landing"===n?0:1},l.coord=e.coord,l.properties={point:!1,leaderLine:"center",dashed:[5,3],leaderLineWidth:2,maxLeaderLineLength:2},l},n.prototype.places=function(){return this._tripData.places},n.prototype.stages=function(){return this._tripData.stages},n.prototype.setLocation=function(n){this._tripData.location=n},n.prototype.location=function(){return this._tripData.location},n.prototype.width_mm=function(){return this._tripData.width},n.prototype.height_mm=function(){return this._tripData.height},n.prototype.pageSizeName=function(){return this._tripData.pageSizeName},n.prototype.world=function(){return this._tripData.world||(this._tripData.world={}),this._tripData.world},n.prototype.setSize=function(n,e,l){this._tripData.width=e,this._tripData.height=l,this._tripData.pageSizeName=n},n.prototype.defaultRadius=function(){return this._tripData.defaultRadius},n.prototype.defaultTextProp=function(){return this._tripData.defaultTextProp||(this._tripData.defaultTextProp={}),this._tripData.defaultTextProp},n.prototype.defaultEdgeProp=function(){return this._tripData.defaultEdgeProp||(this._tripData.defaultEdgeProp=n.defaultTrip().defaultEdgeProp),this._tripData.defaultEdgeProp},n.prototype.reset=function(){this._tripData=n.defaultTrip()},n.defaultTrip=function(){return{places:[],stages:[],additionalPlaces:[],location:{x:.5,y:.5,scale:1/8},defaultRadius:8,width:128,height:190,pageSizeName:"Full page",borderColor:"#fefefe",landColor:"#cecece",seaColor:"#c4e3ff",showRivers:!1,world:{},defaultTextProp:{fontSize:12,font:"'PT Sans', sans-serif",stroke:"rgba(255,255,255,.8)",fill:"#000000"},defaultEdgeProp:{lineWidth:2,lineColor:"#000000",geom:"straight"}}},n.prototype.setPlaces=function(n){this._tripData.places.splice.apply(this._tripData.places,[0,this._tripData.places.length].concat(n)),this.updateStages(),this.updateLandingsAndTakeoff()},n.prototype.stagesAsDict=function(){for(var n={},e=0,l=this._tripData.stages;e<l.length;e++){var t=l[e];t.from in n||(n[t.from]={}),n[t.from][t.to]=t}return n},n.prototype.updateStages=function(){for(var n=this._tripData.places,e=n.length-1,l=(this._tripData.stages,[]),t=this.stagesAsDict(),o=1;o<=e;++o){var i=n[o-1].dbid,r=n[o].dbid;if(t[i]&&t[i][r]){var a=t[i][r];a.to=n[o].name,l.push(a)}else l.push(new vn({from:n[o-1].name,to:n[o].name,fromDbId:i,controlPoints:cn.generateControlPoints(o>=2?n[o-2].coord:void 0,n[o-1].coord,n[o].coord,o+1<n.length?n[o+1].coord:void 0)}))}this._tripData.stages.splice.apply(this._tripData.stages,[0,this._tripData.stages.length].concat(l))},n.prototype.updateLandingsAndTakeoff=function(){for(var e={},l=this._tripData.additionalPlaces,t=0;t<l.length;++t)e[l[t].name]=t;for(var o=[],i={},r={},a=["landing","takeoff"],u=0,s=this._tripData.places;u<s.length;u++)for(var d=s[u],p=0,c=a;p<c.length;p++){var h=c[p],f=d.dbid+"-"+h;r[f]=!0,d.properties[h]?f in e||o.push(n.makePlaneIcon(h,d)):f in e&&(i[f]=!0)}var g=/-(landing|takeoff)$/,v=l.filter(function(n){return!(n.name in i)&&(n.name in r||null==n.name.match(g))}).concat(o);this._tripData.additionalPlaces.splice.apply(this._tripData.additionalPlaces,[0,this._tripData.additionalPlaces.length].concat(v))},n.prototype.nodeRadius=function(n,e){var l=this._tripData.defaultRadius;return n.properties&&n.properties.radius&&(l=n.properties.radius),l*e},n.prototype.makeGraph=function(n){for(var e={},l=(function(n){for(var l=n;l in e;)l=e[l];return l}),t=0,o=this._tripData.places;t<o.length;t++){var i=o[t];if(!i.name)throw new Error("nodes should have names and labels")}var r=[];if(n){for(var a=n.renderer.pinchZoom,u=n.renderer.pixelRatio,s=0,d=this._tripData.places;s<d.length;s++){var p=d[s];p.viewerPos=a.viewerPosFromWorldPos(p.coord)}for(var c=0,h=this._tripData.places;c<h.length;c++){var p=h[c];if(!(!p.label||p.properties&&p.properties.skip)){for(var f=this.nodeRadius(p,u),g=!0,v=0;v<r.length;++v){var i=r[v];if(dn.dist(i.viewerPos,p.viewerPos)<this.nodeRadius(i,u)+f){r[v]=function(n,l){var t=gn.parse(n);t.name=n.name+","+l.name,t.allPlaces=n.allPlaces.concat([l]);var o=n.label.split("\n");return o.indexOf(l.label)<0&&o.push(l.label),t.label=o.join("\n"),e[n.name]=e[l.name]=t.name,t}(i,p),g=!1;break}}if(g){p.properties||(p.properties={});var m=gn.parse(p);m.place=p,m.allPlaces=[p],r.push(m)}}}}else for(var y=0,C=this._tripData.places;y<C.length;y++){var p=C[y],m=gn.parse(p);m.place=p,m.allPlaces=[p],r.push(m)}for(var b=this._tripData.places,P={},v=0;v<b.length;++v){var i=b[v];P[i.name]=v}for(var _=new cn(void 0,this._tripData.defaultEdgeProp),x=0,k=r;x<k.length;x++){var i=k[x];_.nodes[i.name]=i}this.updateLandingsAndTakeoff();for(var w=0,T=this._tripData.additionalPlaces;w<T.length;w++){var i=T[w];_.nodes[i.name]=i}for(var L=0,M=this._tripData.stages;L<M.length;L++){var R=M[L];if(!R.properties.hidden&&!b[P[R.from]].isSkipped()){for(var S=l(R.from),D=P[R.to];D<b.length&&b[D].isSkipped();)++D;if(!(D>=b.length||b[D].isSkipped())){var E=l(b[D].name);if(S!==E){var O=fn.shallowCopy(R);O.from=S,O.to=E,O.originalEdge=R,_.edges.push(O)}}}}return _},n.prototype.save=function(){return this._tripData},n.prototype.load=function(n){if(!n||!n.places||!n.stages)throw new Error("no data");var e=n,l=function(n){for(var e=0;e<n.length;++e)n[e]=gn.parse(n[e])};l(e.places);for(var t=e.stages,o=0;o<t.length;++o)t[o]=new vn(t[o]);l(e.additionalPlaces),this._tripData=e,this.defaultEdgeProp(),this.setSize(n.pageSizeName,n.width,n.height)},n.prototype.seaColor=function(){return this._tripData.seaColor},n.prototype.setSeaColor=function(n){this._tripData.seaColor=n},n.prototype.landColor=function(){return this._tripData.landColor},n.prototype.setLandColor=function(n){this._tripData.landColor=n},n.prototype.borderColor=function(){return this._tripData.borderColor},n.prototype.setBorderColor=function(n){this._tripData.borderColor=n},n.prototype.showRivers=function(){return this._tripData.showRivers},n.prototype.toggleShowRiver=function(){this._tripData.showRivers=!this._tripData.showRivers},n.prototype.placeByName=function(n){for(var e=0,l=this._tripData.places;e<l.length;e++){var t=l[e];if(n===t.name)return t}},n.prototype.markFirstLocation=function(){for(var n=!0,e=0,l=this._tripData.places;e<l.length;e++){var t=l[e];!t.label||t.properties&&t.properties.skip||(n?t.properties.firstVisited=!0:"firstVisited"in t.properties&&delete t.properties.firstVisited,n=!1)}},n.prototype.clearUserPlacements=function(){for(var n=0,e=this._tripData.additionalPlaces.concat(this._tripData.places);n<e.length;n++){var l=e[n];l.properties&&l.properties.userPlacement&&delete l.properties.userPlacement}},n.prototype.saveUserPlacements=function(){for(var n=0,e=this._tripData.additionalPlaces.concat(this._tripData.places);n<e.length;n++){var l=e[n];l.properties||(l.properties={}),l.properties.labelCoord&&(l.properties.userPlacement=l.properties.labelCoord)}},n}(),yn={CanvasTilesRenderer:CanvasTilesRenderer,PinchZoom:PinchZoom,Utils:Utils},Cn=function(){function n(n,e,l){this.name=n,this.width_mm=e,this.height_mm=l}return n.fromPt=function(e,l,t){return new n(e,l/n.mmToPoint,t/n.mmToPoint)},n.prototype.widthPt=function(){return Math.round(this.width_mm*n.mmToPoint)},n.prototype.heightPt=function(){return Math.round(this.height_mm*n.mmToPoint)},n.prototype.key=function(){return Math.round(this.width_mm)+"x"+Math.round(this.height_mm)},n}();Cn.mmToPoint=2.83465;var bn;!function(n){n[n.Location=1]="Location",n[n.Node=2]="Node",n[n.NodeStyle=3]="NodeStyle",n[n.Edge=4]="Edge",n[n.PageSize=5]="PageSize",n[n.MapColor=6]="MapColor",n[n.Frame=7]="Frame",n[n.LabelMoved=8]="LabelMoved",n[n.CurveMoved=9]="CurveMoved",n[n.Label=10]="Label",n[n.LabelProperties=11]="LabelProperties",n[n.EdgeProperties=12]="EdgeProperties",n[n.UpdatedLocations=13]="UpdatedLocations"}(bn||(bn={}));var Pn=function(){function n(n){this.http=n,this.cssserviceUrl="https://destinationbook-cssservice.herokuapp.com/",this._canvasWidth=512,this._canvasHeight=512,this._selectedCountry="",this._loadingMap=!1,this._autoLockMap=!0;this._pageSizes=[new Cn("Full page",128,190),new Cn("Full page rotated",190,128),new Cn("Square",128,128),new Cn("Landscape",128,95)],this._pageSizeMap={};for(var e=0,l=this._pageSizes;e<l.length;e++){var t=l[e];this._pageSizeMap[t.key()]=t}this._numLocations=0,this._showSpinner=!1,this._seqTrip=new mn,this._graph=new cn(void 0,this._seqTrip.defaultEdgeProp()),this._tripLayer&&(this._tripLayer.defaultTextProp=this._seqTrip.defaultTextProp(),this._tripLayer.defaultEdgeProp=this._seqTrip.defaultEdgeProp()),this._visitedPlaceList=this._seqTrip.places(),this._stages=this._seqTrip.stages(),this._interleaved=this.interleavedPlacesAndEvents(),this.setPageSize(this._pageSizes[0].key())}return n.prototype.fetchRawLocations=function(){var n=this;return this._numLocations=0,new Promise(function(e,l){n.http.get(thisTripApi.locationsUrl,{responseType:"json"}).subscribe(function(t){Array.isArray(t)?(n._numLocations=t.length,e(t)):l("bad map data")},function(n){l(n)})})},n.prototype.translateLocations=function(n){var e=this;return new Promise(function(l,t){for(var o in n)n[o].translations&&n[o].translations[thisTripApi.tripLanguage]?n[o].label=n[o].translations[thisTripApi.tripLanguage]:n[o].translations&&n[o].translations.en&&(n[o].label=n[o].translations.en);var i=n.filter(function(n){return n.geoname_id&&!n.translations}).map(function(n){return n.geoname_id});if(0==i.length)return void l(n);var r=e.cssserviceUrl+"location?q="+i.join(",")+"&l="+thisTripApi.tripLanguage;e.http.get(r,{responseType:"json"}).subscribe(function(e){if(!e||!Array.isArray(e))return void l(n);for(var t={},o=0,i=e;o<i.length;o++){var r=i[o];t[r.id]=r}for(var a=0,u=n;a<u.length;a++){var s=u[a];s.geoname_id&&s.geoname_id in t&&t[s.geoname_id].name&&(s.label=t[s.geoname_id].name)}return l(n)},function(n){t(n)})})},n.prototype.fetchLocations=function(){var n=this;return this.fetchRawLocations().then(function(e){return n.translateLocations(e)})},n.prototype.generateFromLocations=function(n){this._seqTrip.reset(),this.updateWithLocations(n,!0),this._tripLayer&&(this._tripLayer.defaultTextProp=this._seqTrip.defaultTextProp(),this._tripLayer.defaultEdgeProp=this._seqTrip.defaultEdgeProp()),this.saveMap()},n.prototype.updateWithLocations=function(n,e){for(var l={},t=0,o=this._seqTrip.places();t<o.length;t++){var i=o[t];"dbid"in i&&(l[i.dbid]=i)}for(var r=[],a=0,u=0,s=n;u<s.length;u++){var d=s[u],p=function(n,e){var l=Utils.latLonToWorld([e,n]);return new dn(l)}(d.latitude,d.longitude),c=""+d.id;if(c in l){var h=l[c];h.coord=p,h.label||(h.label=d.label),r.push(h)}else r.push(gn.parse({dbid:c,name:c,label:d.label,coord:p})),++a}this._seqTrip.setPlaces(r),e&&this._seqTrip.setLocation(this._seqTrip.makeGraph().location(this._seqTrip.width_mm()/this._seqTrip.height_mm(),1.2)),this._visitedPlaceList=this._seqTrip.places(),this._stages=this._seqTrip.stages(),this._interleaved=this.interleavedPlacesAndEvents(),this.pushSeqTripToCanvas(e),a>0&&this.placeLabels()},n.prototype.destination=function(n){return this._tripLayer.graph.nodes[n.to]||this._seqTrip.placeByName(n.to)},n.prototype.origin=function(n){return this._tripLayer.graph.nodes[n.from]||this._seqTrip.placeByName(n.from)},n.prototype.ngOnInit=function(){this.loadMap()},n.prototype.pixelRatio=function(){return this._renderer&&this._renderer.pixelRatio?this._renderer.pixelRatio:1},n.prototype.pushSeqTripToCanvas=function(n){this.prepareCanvas();for(var e=0,l=["seaColor","borderColor","landColor","showRivers"];e<l.length;e++){var t=l[e];this._worldLayer.params[t]=this._seqTrip[t]()}this._tripLayer.defaultRadius=this._seqTrip.defaultRadius(),this._tripLayer.defaultTextProp=this._seqTrip.defaultTextProp(),this._tripLayer.defaultEdgeProp=this._seqTrip.defaultEdgeProp(),this._worldLayer.params.countryStyle=this._seqTrip.world();var o=new Cn(this._seqTrip.pageSizeName(),this._seqTrip.width_mm(),this._seqTrip.height_mm());this._pageSizeMap[o.key()]||(this._pageSizeMap[o.key()]=o,this._pageSizes.push(o)),this.setPageSize(o.key(),!1),this._renderer.setLocation(this._seqTrip.location()),this.clearSelection(),!0===n?this.reset():this.makeGraph(),this._renderer.refresh()},n.prototype.ngAfterViewInit=function(){},n.prototype.scale=function(){var n=this._seqTrip.location();return Math.log2(1/n.scale)},n.prototype.setScale=function(n){var e=this,l=this._renderer;if(l){var t=l.getLocation();t.scale=1/Math.pow(2,n),l.setLocation(t),this._seqTrip.setLocation(this._renderer.getLocation()),this.modified(bn.Location),this._scaleChangeTimeout&&clearTimeout(this._scaleChangeTimeout),this._scaleChangeTimeout=setTimeout(function(){e.placeLabels()},800)}},n.prototype.prepareCanvas=function(){var n=this;this.canvas&&this.canvas.nativeElement&&!this._renderer&&(this._renderer=new yn.CanvasTilesRenderer({canvas:this.canvas.nativeElement,url:"https://tiles.wmflabs.org/bw-mapnik/$scale/$x/$y.png",initialLocation:{x:.5196633492226737,y:.2519760172389177,scale:.0814},onLocationChange:function(e){if(!n._loadingMap){var l=n._tripLayer.makeFusedGraph(n._graph);l.compareNodes(n._tripLayer.graph)?n._seqTrip.setLocation(e.getLocation()):(n._tripLayer.graph=l,n.autoPlaceLabels()),n.modified(bn.Location)}}}),this._worldLayer=new WorldBackgroundLayer({renderer:this._renderer,onCountryClic:function(e){n._editor.deselectLabel(),n.selectCountry(e.id)},onSeaClic:function(){n._editor.deselectLabel(),n.selectCountry("")},landColor:"",borderColor:"",seaColor:"",showRivers:!1,countryStyle:{}}),this._renderer.layers[0]=this._worldLayer,this._tripLayer=new fn({renderer:this._renderer,graph:this._graph}),this._renderer.addLayer(this._tripLayer),setTimeout(function(){n.clearSelection(),n._editor=new hn(n._renderer,n._graph),n._renderer.pinchZoom.touchEventHandlers.push(n._editor),n._editor.onLabelMoved=function(e){n.modified(bn.LabelMoved)},n._editor.onBezierMoved=function(e){n.modified(bn.CurveMoved)},n._editor.onLabelSelect=function(e){n.selectNode(e)},n._editor.onBezierSelect=function(e){e?n.selectEdge(e.edge):n.clearSelection()},n.pushSeqTripToCanvas()},10))},n.prototype.mapIsLocked=function(){return this._renderer&&this._renderer.pinchZoom&&this._renderer.pinchZoom.locked},n.prototype.lockMap=function(n){this._renderer&&this._renderer.pinchZoom&&(this._renderer.pinchZoom.locked=n&&this._autoLockMap)},n.prototype.ngOnDestroy=function(){this._autoRefresh&&clearInterval(this._autoRefresh)},n.prototype.clearSelection=function(){this._selectedCountry=void 0,this._selectedNode=void 0,this._selectedEdge=void 0},n.prototype.clearAndSaveSelection=function(){var n={_selectedCountry:this._selectedCountry,_selectedNode:this._selectedNode,_selectedEdge:this._selectedEdge};return this.clearSelection(),n},n.prototype.restoreSelection=function(n){this._selectedCountry=n._selectedCountry,this._selectedNode=n._selectedNode,this._selectedEdge=n._selectedEdge},n.prototype.selectCountry=function(n){this.clearSelection(),this._selectedCountry=n,this.setCountryColor(n,this.countryColor(n))},n.prototype.setCountryColor=function(n,e){if(n){var l="default"==e,t=!1,o=this._worldLayer.params.countryStyle[n];o?l?(t=!!o.color,delete o.color,0==Object.keys(o).length&&delete this._worldLayer.params.countryStyle[n]):(t=o.color!==e,o.color=e):l||(t=!0,o=this._worldLayer.params.countryStyle[n]={color:e}),t&&this.modified(bn.MapColor)}},n.prototype.countryColor=function(n){return this._worldLayer&&this._worldLayer.params.countryStyle[n]&&this._worldLayer.params.countryStyle[n].color?this._worldLayer.params.countryStyle[n].color:this._seqTrip.landColor()},n.prototype.tunedCountries=function(){return this._worldLayer?Object.keys(this._worldLayer.params.countryStyle):[]},n.prototype.selectNode=function(n){if(this.clearSelection(),n&&(n.properties||(n.properties={}),n.name in this._graph.nodes&&(this._selectedNode=this._graph.nodes[n.name]),n!==this._editor.selectedLabel)){var e=this._editor.onLabelSelect,l=this._editor.onBezierSelect;this._editor.onLabelSelect=function(){},this._editor.onBezierSelect=function(){},n.name in this._editor.graph.nodes?this._editor.selectLabel(n):this._editor.deselectLabel(),this._editor.onLabelSelect=e,this._editor.onBezierSelect=l}},n.prototype.selectEdge=function(n){this.clearSelection(),this._selectedEdge=n},n.prototype.nodeNames=function(){return Object.keys(this._graph.nodes)},n.prototype.nodeArray=function(){for(var n=[],e=0,l=Object.keys(this._graph.nodes);e<l.length;e++){var t=l[e];n.push(this._graph.nodes[t])}return n},n.prototype.isSkipped=function(n){return!(!n.properties||void 0===n.properties.skip)&&n.properties.skip},n.prototype.toggleHideEdge=function(n){if(n.properties.hidden){delete n.properties.hidden;for(var e=0,l=this._visitedPlaceList;e<l.length;e++){var t=l[e];t.name!=n.from&&t.name!=n.to||!this.isSkipped(t)||this.toggleSkipNode(t)}}else n.properties.hidden=!0;this.modified(bn.Edge)},n.prototype.toggleSkipNode=function(n){if(this.isSkipped(n))delete n.properties.skip;else{n.properties?n.properties.skip=!0:n.properties={skip:!0};for(var e=0,l=this._stages;e<l.length;e++){var t=l[e];t.from!=n.name&&t.to!=n.name||(t.properties.hidden=!0)}}this._seqTrip.markFirstLocation(),this.modified(bn.Node)},n.prototype.toggleProperty=function(n,e){n.properties[e]=!n.properties[e],this.modified(bn.Node)},n.prototype.setProperty=function(n,e,l,t){void 0!==l?n.properties[e]=l:e in n.properties&&delete n.properties[e],this._seqTrip.markFirstLocation(),this.modified(bn.NodeStyle)},n.prototype.setNodeLabel=function(n,e){var l=n.label;if(l!==e){n.label=e;var t=this._graph;for(var o in t.nodes){var i=t.nodes[o];(i.place===n||i.allPlaces.indexOf(n)>=0)&&(i.label=i.label.replace(l,e))}this.modified(bn.Label)}},n.prototype.removeEdge=function(n){var e=function(e){return e.from!==n.from||e.to!==n.to};this._graph.edges=this._graph.edges.filter(e),this._editor.graph.edges=this._editor.graph.edges.filter(e)},n.prototype.uiSetFrame=function(n,e){this.setFrame(n,e),this.modified(bn.Frame),this.autoPlaceLabels()},n.prototype.setFrame=function(n,e){if(this._renderer){var l=this._renderer.canvas,t=n||l.width,o=e||l.height,i=this._graph.location(t/o,1.2);this._seqTrip.setLocation(i),this._renderer.setLocation(i)}},n.prototype.autoPlaceLabels=function(){this._seqTrip.clearUserPlacements(),this.placeLabels()},n.prototype.placeLabels=function(){var n=this;this.runBlockingTask(function(e){n._tripLayer.placeLabels(n._renderer.canvas.getContext("2d")),n._seqTrip.saveUserPlacements(),n.modified(bn.LabelMoved),n._renderer.refresh(),e()})},n.prototype.runBlockingTask=function(n){var e=this;this._showSpinner=!0,setTimeout(function(){try{n(function(){e._showSpinner=!1})}catch(n){e._showSpinner=!1,console.log(n)}},30)},n.prototype.update=function(){this.placeLabels()},n.prototype.resetCurves=function(){var n=this._graph;n.createDefaultBezier(),this._tripLayer.graph=this._tripLayer.makeFusedGraph(n),this._editor.graph=this._tripLayer.graph,this._tripLayer.placeLabels(this._renderer.canvas.getContext("2d")),this._renderer.refresh()},n.prototype.makeGraph=function(){var n=this;this._graph=this._seqTrip.makeGraph(this._tripLayer),this._tripLayer&&(this._tripLayer.graph=this._graph,this._tripLayer.loadIcons(function(e){n._renderer.refresh()})),this._editor&&(this._editor.graph=this._graph)},n.prototype.recreate=function(){this._visitedPlaceList.length&&(this.makeGraph(),this.placeLabels())},n.prototype.reset=function(){this._visitedPlaceList.length&&(this.makeGraph(),this.setFrame(),this.placeLabels())},n.prototype.uiSetPageSize=function(n,e){this.setPageSize(n,e),this.modified(bn.PageSize)},n.prototype.setPageSize=function(n,e){var l=this,t=this._pageSizeMap[n];t&&(this._pageSizeName=n,this._canvasWidth=t.widthPt(),this._canvasHeight=t.heightPt(),this._seqTrip.setSize(t.name,t.width_mm,t.height_mm),!1!==e&&(this.setFrame(this._canvasWidth,this._canvasHeight),setTimeout(function(){l.placeLabels()},20)))},n.prototype.setSeaColor=function(n){n!=this._seqTrip.seaColor()&&(this._seqTrip.setSeaColor(n),this._worldLayer.params.seaColor=n,this.modified(bn.MapColor))},n.prototype.setBorderColor=function(n){n!=this._seqTrip.borderColor()&&(this._seqTrip.setBorderColor(n),this._worldLayer.params.borderColor=n,this.modified(bn.MapColor))},n.prototype.setLandColor=function(n){n!=this._seqTrip.landColor()&&(this._seqTrip.setLandColor(n),this._worldLayer.params.landColor=n,this.modified(bn.MapColor))},n.prototype.toggleShowRiver=function(){this._seqTrip.toggleShowRiver(),this._worldLayer.params.showRivers=this._seqTrip.showRivers(),this.modified(bn.MapColor)},n.prototype.fetchMap=function(){var n=this;return new Promise(function(e,l){n.http.get(thisTripApi.mapUrl,{responseType:"json"}).subscribe(function(n){e(n)},function(n){l(n)})})},n.prototype.loadMap=function(){var n=this;this._loadingMap=!0,this.fetchMap().then(function(e){try{return n._seqTrip.load(e),n._saved=!0,n._visitedPlaceList=n._seqTrip.places(),n._stages=n._seqTrip.stages(),n._interleaved=n.interleavedPlacesAndEvents(),n.prepareCanvas(),n.fetchLocations().then(function(e){n.updateWithLocations(e)}).catch(function(e){n._loadingMap=!1,n.handleError(e)})}catch(e){return n.fetchLocationsAndGenerateMap()}}).then(function(){setTimeout(function(){n._loadingMap=!1,n.modified(bn.UpdatedLocations)},100)}).catch(function(e){n._loadingMap=!1,n.handleError(e)})},n.prototype.fetchLocationsAndGenerateMap=function(){var n=this;return this.fetchLocations().then(function(e){e.length>0&&(n.generateFromLocations(e),n.prepareCanvas())})},n.prototype.saveMap=function(){var n=this,e=this.clearAndSaveSelection();if(this._editor&&this._editor.deselectLabel(),this._graph)for(var l=0,t=this._graph.edges;l<t.length;l++){var o=t[l];o.propagateToOriginal()}$.ajax({type:"PUT",url:thisTripApi.mapUrl,dataType:"text",contentType:"application/json",data:JSON.stringify({_method:"PUT",map_data:JSON.stringify(this._seqTrip.save())}),success:function(){n._saved=!0,n._errorMessage=void 0},error:function(e,l,t){n.handleError("Error: Can't save map. Please check your internet connection.")}}),this.restoreSelection(e)},n.prototype.handleError=function(n){var e=""+n;console.error(e),this._infoMessage=void 0,this._errorMessage=e},n.prototype.nodePropertiesChanged=function(){this.modified(bn.LabelProperties),this.modified(bn.NodeStyle)},n.prototype.edgePropertiesChanged=function(n){this.modified(bn.EdgeProperties)},n.prototype.modified=function(n){var e=this;if(!this._loadingMap){switch(this._saved=!1,n){case bn.UpdatedLocations:case bn.LabelMoved:case bn.CurveMoved:case bn.Location:break;case bn.NodeStyle:case bn.Label:case bn.LabelProperties:case bn.EdgeProperties:case bn.MapColor:this._renderer.refreshIfNotMoving();break;case bn.Node:case bn.Edge:case bn.Frame:this.recreate();break;case bn.PageSize:}this._saveTimeout&&clearTimeout(this._saveTimeout),this._saveTimeout=setTimeout(function(){e._loadingMap||e.saveMap()},500)}},n.prototype.interleavedPlacesAndEvents=function(){for(var n=[],e=this._seqTrip.stagesAsDict(),l={},t=this._visitedPlaceList,o=t.length-1,i=0;i<t.length;++i){var r=t[i],a=void 0;i<o&&(a=t[i+1].dbid,r.dbid===a)||(!function(e){e.dbid in l?n.push({node:l[e.dbid]}):(l[e.dbid]=e,n.push({node:e}))}(r),void 0!==a&&(r.dbid in e&&a in e[r.dbid]?n.push({edge:e[r.dbid][a]}):console.log("No edge from "+r.dbid+" to "+a)))}return n},n.prototype.download=function(n){var e=this,l=function(n){return Math.round(Math.pow(36,n+1)-Math.random()*Math.pow(36,n)).toString(36).slice(1)}(16),t=this.cssserviceUrl+"mapgen/"+l,o=t+"/"+n;this.http.post(t,JSON.stringify(this._seqTrip.save()),{headers:new sn.g({"content-type":"application/json"})}).subscribe(function(n){window.open(o)},function(n){e.handleError(n.text())})},n.prototype.resetNodeToDefault=function(n){for(var e=0,l=Object.keys(n.properties);e<l.length;e++){var t=l[e];"firstVisited"!=t&&delete n.properties[t]}this._seqTrip.markFirstLocation(),this.modified(bn.Node)},n.prototype.doSomething=function(n){!this._loadingMap&&this._numLocations>0&&!this._saved&&(n.returnValue="Your data will be lost!")},n.ctorParameters=function(){return[{type:sn.c}]},n}(),_n=l("Fw80"),xn=l("Djd0"),kn=l("pYHX"),wn=l("DmCJ"),Tn=l("4zAq"),Ln=l("rxZd"),Mn=l("poDJ"),Rn=l("pBJ6"),Sn=l("2VFp"),Dn=l("iDwB"),En=[A],On=O["\u0275crt"]({encapsulation:0,styles:En,data:{}}),In=(O["\u0275ccf"]("trip-map",Pn,S,{},{},[]),[q]),zn=O["\u0275crt"]({encapsulation:0,styles:In,data:{}}),Nn=O["\u0275ccf"]("app-root",z,E,{},{},[]),Fn=l("fc+i"),qn=l("BhHz"),An=l("4Vp2"),Bn=l("x/Up"),Vn=l("G8gw"),Wn=l("xHno"),jn=l("yroR"),Un=l("bIam"),$n=O["\u0275cmf"](I,[z],function(n){return O["\u0275mod"]([O["\u0275mpd"](512,O.ComponentFactoryResolver,O["\u0275CodegenComponentFactoryResolver"],[[8,[N.a,F.a,Nn]],[3,O.ComponentFactoryResolver],O.NgModuleRef]),O["\u0275mpd"](5120,O.LOCALE_ID,O["\u0275m"],[[3,O.LOCALE_ID]]),O["\u0275mpd"](4608,W.NgLocalization,W.NgLocaleLocalization,[O.LOCALE_ID]),O["\u0275mpd"](4608,O.Compiler,O.Compiler,[]),O["\u0275mpd"](5120,O.APP_ID,O["\u0275f"],[]),O["\u0275mpd"](5120,O.IterableDiffers,O["\u0275k"],[]),O["\u0275mpd"](5120,O.KeyValueDiffers,O["\u0275l"],[]),O["\u0275mpd"](4608,Fn.b,Fn.s,[W.DOCUMENT]),O["\u0275mpd"](6144,O.Sanitizer,null,[Fn.b]),O["\u0275mpd"](4608,Fn.e,Fn.f,[]),O["\u0275mpd"](5120,Fn.c,function(n,e,l,t){return[new Fn.k(n),new Fn.o(e),new Fn.n(l,t)]},[W.DOCUMENT,W.DOCUMENT,W.DOCUMENT,Fn.e]),O["\u0275mpd"](4608,Fn.d,Fn.d,[Fn.c,O.NgZone]),O["\u0275mpd"](135680,Fn.m,Fn.m,[W.DOCUMENT]),O["\u0275mpd"](4608,Fn.l,Fn.l,[Fn.d,Fn.m]),O["\u0275mpd"](6144,O.RendererFactory2,null,[Fn.l]),O["\u0275mpd"](6144,Fn.p,null,[Fn.m]),O["\u0275mpd"](4608,O.Testability,O.Testability,[O.NgZone]),O["\u0275mpd"](4608,Fn.g,Fn.g,[W.DOCUMENT]),O["\u0275mpd"](4608,Fn.i,Fn.i,[W.DOCUMENT]),O["\u0275mpd"](4608,B.n,B.n,[]),O["\u0275mpd"](4608,sn.i,sn.n,[W.DOCUMENT,O.PLATFORM_ID,sn.l]),O["\u0275mpd"](4608,sn.o,sn.o,[sn.i,sn.m]),O["\u0275mpd"](5120,sn.a,function(n){return[n]},[sn.o]),O["\u0275mpd"](4608,sn.k,sn.k,[]),O["\u0275mpd"](6144,sn.j,null,[sn.k]),O["\u0275mpd"](4608,sn.h,sn.h,[sn.j]),O["\u0275mpd"](6144,sn.b,null,[sn.h]),O["\u0275mpd"](5120,sn.f,sn.p,[sn.b,[2,sn.a]]),O["\u0275mpd"](4608,sn.c,sn.c,[sn.f]),O["\u0275mpd"](4608,U.ColorPickerService,U.ColorPickerService,[]),O["\u0275mpd"](4608,wn.a,wn.a,[]),O["\u0275mpd"](4608,un.a,un.a,[]),O["\u0275mpd"](4608,qn.a,qn.a,[]),O["\u0275mpd"](4608,Mn.a,Mn.a,[O.ComponentFactoryResolver,O.NgZone,O.Injector,qn.a,O.ApplicationRef]),O["\u0275mpd"](4608,Tn.a,Tn.a,[]),O["\u0275mpd"](512,W.CommonModule,W.CommonModule,[]),O["\u0275mpd"](1024,O.ErrorHandler,Fn.q,[]),O["\u0275mpd"](1024,O.APP_INITIALIZER,function(n,e){return[Fn.r(n,e)]},[[2,Fn.h],[2,O.NgProbeToken]]),O["\u0275mpd"](512,O.ApplicationInitStatus,O.ApplicationInitStatus,[[2,O.APP_INITIALIZER]]),O["\u0275mpd"](131584,O["\u0275e"],O["\u0275e"],[O.NgZone,O["\u0275Console"],O.Injector,O.ErrorHandler,O.ComponentFactoryResolver,O.ApplicationInitStatus]),O["\u0275mpd"](2048,O.ApplicationRef,null,[O["\u0275e"]]),O["\u0275mpd"](512,O.ApplicationModule,O.ApplicationModule,[O.ApplicationRef]),O["\u0275mpd"](512,Fn.a,Fn.a,[[3,Fn.a]]),O["\u0275mpd"](512,B.k,B.k,[]),O["\u0275mpd"](512,B.d,B.d,[]),O["\u0275mpd"](512,sn.e,sn.e,[]),O["\u0275mpd"](512,sn.d,sn.d,[]),O["\u0275mpd"](512,An.ColorPickerModule,An.ColorPickerModule,[]),O["\u0275mpd"](512,Bn.a,Bn.a,[]),O["\u0275mpd"](512,Vn.a,Vn.a,[]),O["\u0275mpd"](512,Wn.a,Wn.a,[]),O["\u0275mpd"](512,jn.a,jn.a,[]),O["\u0275mpd"](512,Un.a,Un.a,[]),O["\u0275mpd"](512,I,I,[]),O["\u0275mpd"](256,sn.l,"XSRF-TOKEN",[]),O["\u0275mpd"](256,sn.m,"X-XSRF-TOKEN",[]),O["\u0275mpd"](256,Rn.a,{autoClose:!0},[])])});Object(O.enableProdMode)(),Object(Fn.j)().bootstrapModuleFactory($n)},z1vh:function(n,e){function l(n){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+n+"'.")})}l.keys=function(){return[]},l.resolve=l,n.exports=l,l.id="z1vh"}},[0]);