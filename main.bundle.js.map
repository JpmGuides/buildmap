{"version":3,"sources":["./frontend/map_editor/src/$_gendir lazy","./frontend/map_editor/src/app/app.component.css","./frontend/map_editor/src/app/app.component.html","./frontend/map_editor/src/app/app.component.ts","./frontend/map_editor/src/app/app.module.ts","./frontend/map_editor/src/app/text-prop/text-prop.component.css","./frontend/map_editor/src/app/text-prop/text-prop.component.html","./frontend/map_editor/src/app/text-prop/text-prop.component.ts","./frontend/map_editor/src/app/trip-map/bounding-box.ts","./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.css","./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.html","./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.ts","./frontend/map_editor/src/app/trip-map/map-params.ts","./frontend/map_editor/src/app/trip-map/mapview.component.html","./frontend/map_editor/src/app/trip-map/mapview.component.ts","./frontend/map_editor/src/app/trip-map/mapview2.component.html","./frontend/map_editor/src/app/trip-map/mapview2.component.ts","./frontend/map_editor/src/app/trip-map/open-route-service.ts","./frontend/map_editor/src/app/trip-map/page-size.ts","./frontend/map_editor/src/app/trip-map/point.ts","./frontend/map_editor/src/app/trip-map/seq-trip.ts","./frontend/map_editor/src/app/trip-map/some_map.ts","./frontend/map_editor/src/app/trip-map/tiles.ts","./frontend/map_editor/src/app/trip-map/trip-edge.ts","./frontend/map_editor/src/app/trip-map/trip-graph-editor.ts","./frontend/map_editor/src/app/trip-map/trip-graph-layer.ts","./frontend/map_editor/src/app/trip-map/trip-graph.ts","./frontend/map_editor/src/app/trip-map/trip-map.component.css","./frontend/map_editor/src/app/trip-map/trip-map.component.html","./frontend/map_editor/src/app/trip-map/trip-map.component.ts","./frontend/map_editor/src/app/trip-map/trip-node.ts","./frontend/map_editor/src/app/trip-map/view-seq.component.html","./frontend/map_editor/src/app/trip-map/view-seq.component.ts","./frontend/map_editor/src/environments/environment.ts","./frontend/map_editor/src/main.ts"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./frontend/map_editor/src/$$_gendir lazy recursive\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/$$_gendir lazy\n// module id = ./frontend/map_editor/src/$$_gendir lazy recursive\n// module chunks = main","module.exports = \"\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/app.component.css\n// module id = ./frontend/map_editor/src/app/app.component.css\n// module chunks = main","module.exports = \"<trip-map></trip-map>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/app.component.html\n// module id = ./frontend/map_editor/src/app/app.component.html\n// module chunks = main","import { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {\n\n  constructor() {\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport {ColorPickerModule} from 'ngx-color-picker';\n\nimport { AppComponent } from './app.component';\nimport { TripMapComponent } from './trip-map/trip-map.component';\nimport { ViewSeqComponent } from './trip-map/view-seq.component';\nimport { TextPropComponent } from './text-prop/text-prop.component';\nimport { EdgePropComponent } from './trip-map/edge-prop/edge-prop.component';\nimport { MapView } from './trip-map/mapview.component';\nimport { MapView2 } from './trip-map/mapview2.component';\n\nimport { ButtonsModule } from 'ngx-bootstrap/buttons';\nimport { AccordionModule } from 'ngx-bootstrap/accordion';\nimport { TabsModule } from 'ngx-bootstrap/tabs';\nimport { BsDropdownModule } from 'ngx-bootstrap/dropdown';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    TripMapComponent,\n    ViewSeqComponent,\n    TextPropComponent,\n    EdgePropComponent,\n    MapView,\n    MapView2,\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpClientModule,\n    ColorPickerModule,\n    AccordionModule.forRoot(),\n    ButtonsModule.forRoot(),\n    TabsModule.forRoot(),\n    BsDropdownModule.forRoot()\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/app.module.ts","module.exports = \".block {\\n  display: inline-block;\\n  margin-right: 15px;\\n}\\n\\n.form-control {\\n  width: 8em;\\n  height: 2em;\\n  display: inline-block;\\n  font-size: 12px;\\n}\\n\\n.leftpadding {\\n  padding-left: 15px;\\n}\\n\\n.small {\\n  width: 25px;\\n  height: 25px;\\n}\\n\\n.root > div {\\n  position: relative;\\n}\\n\\ninput {\\ndisplay: inline-block;\\n}\\n\\ninput[type=\\\"number\\\"] {\\n  width: 4em;\\n  padding-left: 3px;\\n  padding-right: 3px;\\n}\\n\\ni.fa-recycle {\\n  position: absolute;\\n  right: 0;\\n  top: 0;\\n}\\n\\n.text-prop-colors {\\n  position: relative;\\n  padding: 5px 0px;\\n}\\n\\nspan {\\n  font-size: 12px;\\n}\\n\\n.font-size-margin {\\n  margin: 5px 0px 8px;\\n}\\n\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/text-prop/text-prop.component.css\n// module id = ./frontend/map_editor/src/app/text-prop/text-prop.component.css\n// module chunks = main","module.exports = \"<span *ngIf=\\\"properties\\\" class=\\\"root\\\">\\n  <span class=\\\"text-prop-colors block\\\">\\n    <input [(colorPicker)]=\\\"fill\\\"\\n      (colorPickerChange)=\\\"setProperty('fill')\\\"\\n      [style.background]=\\\"fill\\\" class=\\\"small form-control\\\" />\\n    <span>Text</span>\\n  </span>\\n\\n  <!--\\n  <span class=\\\"text-prop-colors leftpadding block\\\">\\n    <input [(colorPicker)]=\\\"stroke\\\" ([cpFallbackColor])=\\\"'#000'\\\" ([cpOutputFormat])=\\\"'rgba'\\\" ([cpAlphaChannel])=\\\"'enabled'\\\"\\n      (colorPickerChange)=\\\"setProperty('stroke')\\\"\\n      [style.background]=\\\"stroke\\\" class=\\\"small form-control\\\" />\\n    <span>Shadow</span>\\n  </span>\\n  -->\\n\\n  <span class=\\\"font-size-margin block\\\" style=\\\"float: right;\\\">\\n    <span for=\\\"fontSize\\\">size:</span>\\n    <input id=\\\"fontSize\\\" type=\\\"number\\\" min=\\\"5\\\" max=\\\"64\\\"\\n      (change)=\\\"setProperty('fontSize')\\\"\\n      [(ngModel)]=\\\"fontSize\\\" class=\\\"form-control\\\"/>\\n  </span>\\n</span>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/text-prop/text-prop.component.html\n// module id = ./frontend/map_editor/src/app/text-prop/text-prop.component.html\n// module chunks = main","import { Component, Input, Output, DoCheck, KeyValueDiffers, EventEmitter } from '@angular/core';\nimport { ColorPickerService, Hsva, Rgba } from 'ngx-color-picker';\n\nimport { TripNodeProperties } from '../trip-map/trip-node';\n\nimport {IPoint, Point} from '../trip-map/point';\n\n@Component({\n  selector: 'text-prop',\n  templateUrl: 'text-prop.component.html',\n  styleUrls: ['./text-prop.component.css']\n})\nexport class TextPropComponent {\n  @Input() @Output() properties: TripNodeProperties;\n  @Input() defaults?: TripNodeProperties;\n  @Input() noReset?: boolean;\n  @Output() onChange: EventEmitter<TripNodeProperties> = new EventEmitter();\n\n  private fill: string;\n  private stroke: string;\n  private fontSize: number;\n\n  private defaultsDiffer: any;\n  private propertiesDiffer: any;\n\n  constructor(private cpService: ColorPickerService,\n              private differs: KeyValueDiffers) {\n    this.defaultsDiffer = differs.find({}).create(null);\n    this.propertiesDiffer = differs.find({}).create(null);\n  }\n\n  ngOnInit() { }\n\n  changeEvent() {\n    this.onChange.emit(this.properties);\n  }\n\n  ngDoCheck() {\n    let changed =\n      this.defaultsDiffer.diff(this.defaults)\n      || this.propertiesDiffer.diff(this.properties);\n    if (changed) {\n      this.readProperties();\n    }\n    return changed;\n  }\n\n  readProperties() {\n    for (let prop of ['fill', 'stroke', 'fontSize']) {\n      if (this.properties && prop in this.properties) {\n        this[prop] = this.properties[prop];\n      } else if (this.defaults && prop in this.defaults) {\n        this[prop] = this.defaults[prop];\n      } else if (prop == 'stroke' || prop == 'fill') {\n        this[prop] = '#000000';\n      } else {\n        this[prop] = undefined;\n      }\n    }\n  }\n\n  hasDefault() {\n    for (let prop of ['fill', 'stroke', 'fontSize']) {\n      if (prop in this.properties) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  setProperty(id: string) {\n    this.properties[id] = this[id];\n    this.changeEvent();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/text-prop/text-prop.component.ts","\nimport { Point, IPoint } from './point';\n\nexport class BoundingBox {\n  min?: Point;\n  max?: Point;\n\n  static closestPoint(point: Point, bbox: BoundingBox) {\n    const r = new Point(0, 0);\n\n    for (const i in r) {\n      if (point[i] < bbox.min[i]) {\n        r[i] = bbox.min[i];\n      } else if (point[i] > bbox.max[i]) {\n        r[i] = bbox.max[i];\n      } else {\n        r[i] = point[i];\n      }\n    }\n    return r;\n  };\n\n  static overlaps(a: BoundingBox, b: BoundingBox): boolean {\n    if (a.max.x < b.min.x // a is left of b\n        || a.min.x > b.max.x // a is right of b\n        || a.max.y < b.min.y // a is above b\n        || a.min.y > b.max.y) { // a is below b\n      return false;\n    }\n    return true; // boxes overlap\n  }\n\n  static contains(box: BoundingBox, p: IPoint): boolean {\n    return ((p.x >= box.min.x) && (p.x <= box.max.x)\n            && (p.y >= box.min.y) && (p.y <= box.max.y));\n  }\n\n  constructor(obj?: {min?: IPoint, max?: IPoint}) {\n    if (obj) {\n      if (obj.min) { this.min = new Point(obj.min); }\n      if (obj.max) { this.max = new Point(obj.max); }\n    }\n  }\n  addPoint(p: IPoint) {\n    this.min = (this.min === undefined ? new Point(p) : Point.min(this.min, p));\n    this.max = (this.max === undefined ? new Point(p) : Point.max(this.max, p));\n  }\n\n  addArray(a: IPoint[]) {\n    for (const p of a) {\n      this.addPoint(p);\n    }\n  }\n\n  overlaps(other: BoundingBox): boolean {\n    return BoundingBox.overlaps(this, other);\n  }\n\n  contains(p: IPoint): boolean { return BoundingBox.contains(this, p); }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/bounding-box.ts","module.exports = \".form-control {\\n  display: inline-block;\\n  font-size: 12px;\\n  padding: 2px;\\n}\\n\\n.form-group {\\n  margin-bottom: 2px;\\n}\\n\\n.form-group label {\\n  font-weight: normal;\\n  text-align: left;\\n}\\n\\n.small { width: 25px; height: 25px; }\\n\\n.edge-prop-colors {\\n  text-align: right;\\n}\\n\\n.input-form-control-margin {\\n  margin:10px 0px\\n}\\n\\n\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.css\n// module id = ./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.css\n// module chunks = main","module.exports = \"\\n<div *ngIf=\\\"properties\\\" class=\\\"form-horizontal\\\">\\n  <div class=\\\"form-group form-group-sm\\\">\\n    <label class=\\\"control-label col-sm-4\\\">Transport:</label>\\n    <div class=\\\"col-md-8\\\">\\n      <select class=\\\"form-control input-sm\\\" [ngModel]=\\\"travelMean\\\" (change)=\\\"setTravelMean($event.target.value)\\\">\\n        <option *ngFor=\\\"let x of allTravelMeans\\\" [value]=\\\"x\\\">{{x}}</option>\\n      </select>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"form-group form-group-sm\\\">\\n    <label class=\\\"control-label col-sm-4\\\">Line style:</label>\\n    <div class=\\\"col-md-8\\\">\\n      <select class=\\\"form-control\\\" [ngModel]=\\\"lineStyle\\\" (change)=\\\"setLineStyle($event.target.value)\\\">\\n        <option *ngFor=\\\"let x of allLineStyles\\\" [value]=\\\"x.name\\\">{{x.name}}</option>\\n      </select>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"form-group form-group-sm\\\">\\n    <label class=\\\"control-label col-sm-4\\\">Line shape:</label>\\n    <div class=\\\"col-md-8\\\">\\n      <select class=\\\"form-control\\\" [ngModel]=\\\"geom\\\" (change)=\\\"setGeom($event.target.value)\\\">\\n        <option class=\\\"form-control\\\" [value]=\\\"'straight'\\\">Straight</option>\\n        <option class=\\\"form-control\\\" [value]=\\\"'spline'\\\">Curved</option>\\n        <option *ngIf=\\\"canDrive()\\\" class=\\\"form-control\\\" [value]=\\\"'route'\\\">Route</option>\\n      </select>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"form-group form-group-sm\\\">\\n    <label class=\\\"control-label col-sm-4\\\">Line width:</label>\\n    <div class=\\\"col-md-8\\\">\\n      <input id=\\\"lineWidth\\\" type=\\\"number\\\" min=\\\"0\\\" max=\\\"10\\\"\\n        (change)=\\\"changeEvent()\\\" [(ngModel)]=\\\"lineWidth\\\"\\n        class=\\\"form-control input-sm\\\"/>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"form-group form-group-sm\\\">\\n    <label class=\\\"control-label col-sm-4\\\">Line color:</label>\\n    <div class=\\\"col-md-8 edge-prop-colors\\\">\\n      <input [(colorPicker)]=\\\"lineColor\\\"\\n        (colorPickerChange)=\\\"colorChanged()\\\"\\n        [style.background]=\\\"lineColor\\\"\\n        class=\\\"small form-control \\\"/>\\n    </div>\\n  </div>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.html\n// module id = ./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.html\n// module chunks = main","import { Component, Input, Output, OnInit, EventEmitter, DoCheck, KeyValueDiffers } from '@angular/core';\n\nimport { TripEdgeProperties } from '../trip-edge';\n\nclass LineStyle {\n  name: string;\n  style: number[];\n\n  key() : string { return name; }\n\n  constructor(n: string, s: number[]) {\n    this.name = n.replace(/-/g, '\\u2501').replace(/ /g, ' \\u00A0');\n    this.style = s;\n  }\n}\n\n@Component({\n  selector: 'edge-prop',\n  templateUrl: 'edge-prop.component.html',\n  styleUrls: [ 'edge-prop.component.css' ],\n})\nexport class EdgePropComponent implements OnInit {\n  @Input() @Output() properties?: TripEdgeProperties;\n  @Input() defaults?: TripEdgeProperties;\n  @Input() noReset?: boolean;\n  @Output() onChange: EventEmitter<TripEdgeProperties> = new EventEmitter();\n\n  private lineColor: string;\n  private lineWidth: number;\n  private travelMean: string;\n\n  private defaultsDiffer: any;\n  private propertiesDiffer: any;\n  private allLineStyles: LineStyle[];\n  private lineStyle: string;\n  private allTravelMeans: string[];\n  private geom: string;\n\n  constructor(private differs: KeyValueDiffers) {\n    this.defaultsDiffer = differs.find({}).create(null);\n    this.propertiesDiffer = differs.find({}).create(null);\n\n    this.allLineStyles = [\n      new LineStyle('------', []),\n      new LineStyle('- - - ', [4, 4]),\n      new LineStyle('--  --', [8, 8])\n    ];\n\n    this.allTravelMeans = [\n      'Unspecified',\n      'Bike',\n      'Boat',\n      'Bus',\n      'Car',\n      'Helicopter',\n      'Plane',\n      'Train',\n      'Walk'\n    ];\n  }\n\n  changeEvent() {\n    this.setProp('lineWidth');\n    this.onChange.emit(this.properties);\n  }\n\n  ngOnInit() {\n    this.readProperties();\n  }\n\n  ngDoCheck() {\n    let changed =\n      this.defaultsDiffer.diff(this.defaults)\n      || this.propertiesDiffer.diff(this.properties);\n    if (changed) {\n      this.readProperties();\n    }\n    return changed;\n  }\n\n  readProperties() {\n    const defaults = {\n      lineColor: '#000000',\n      lineWidth: 2,\n      travelMean: 'Unspecified',\n      geom: 'straight'\n    };\n    for (let field of Object.keys(defaults)) {\n      if (this.properties && field in this.properties) {\n        this[field] = this.properties[field];\n      } else if (this.defaults\n                 && field in this.defaults) {\n        this[field] = this.defaults[field];\n      } else {\n        this[field] = defaults[field];\n      }\n    }\n\n    let dashed;\n    if (this.properties && this.properties.dashed) {\n      dashed = this.properties.dashed;\n    } else if (this.defaults && this.defaults.dashed) {\n      dashed = this.defaults.dashed;\n    }\n    if (dashed) {\n      for (let s of this.allLineStyles) {\n        if (this.sameStyles(s.style, dashed)) {\n          this.lineStyle = s.name;\n        }\n      }\n    } else {\n      this.lineStyle = this.allLineStyles[0].name;\n    }\n  }\n\n  sameStyles(a?: number[], b?: number[]) : boolean {\n    if (!a || !b) {\n      return false;\n    }\n    if (a === b) {\n      return true;\n    }\n    if (a.length != b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; ++i) {\n      if (a[i] != b[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  setProp(field: string) {\n    if (this.properties) {\n      if (this.defaults\n          && this[field] === this.defaults[field]) {\n        if (this.properties[field]) {\n          delete this.properties[field];\n        }\n      } else {\n        this.properties[field] = this[field];\n      }\n    }\n  }\n\n  colorChanged() {\n    this.setProp('lineColor');\n    this.changeEvent();\n  }\n  \n  resetToDefault() {\n    for (let field of Object.keys(this.properties)) {\n      delete this.properties[field];\n    }\n    this.readProperties();\n    this.changeEvent();\n  }\n\n  hasDefault() {\n    const fields = [ 'lineColor', 'lineWidth', 'travelMean', 'dashed' ];\n    for (let f of fields) {\n      if (f in this.properties) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  setLineStyle(style: string) {\n    for (let s of this.allLineStyles) {\n      if (s.name === style) {\n        this.properties.dashed = s.style;\n      }\n    }\n    this.changeEvent();\n  }\n\n  canDrive() : boolean {\n    return ['Car', 'Bus', 'Bike', 'Walk'].indexOf(this.travelMean) != -1;\n  }\n\n  setTravelMean(travelMean: string) {\n    this.travelMean = travelMean;\n    this.setProp('travelMean');\n    if (this.canDrive()) {\n      if (this.geom != 'route') {\n        this.geom = 'route';\n        this.setProp('geom');\n      }\n    } else {\n      if (this.geom == 'route') {\n        this.geom = (this.defaults ? this.defaults.geom : 'straight');\n        this.setProp('geom');\n      }\n    }\n    this.changeEvent();\n  }\n\n  setGeom(geomStyle: string) {\n    this.geom = geomStyle;\n    this.setProp('geom');\n    this.changeEvent();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/edge-prop/edge-prop.component.ts","// This file specifies all parameters that the map editor can take as input.\n// The rails equivalent can be found in app/models/map_params.rb\n//\n// To access the parameters, call globalMapParams() which returns a MapParams object.\n//\n// To send parameters to the map editor, fill a window.global_map_params object with\n// MapParams data.\n\nimport { TripSaved } from './trip-saved';\nimport { IPageSize } from './page-size';\nimport { TripEdgeProperties, LineShape } from './trip-edge';\nimport { TripNodeProperties } from './trip-node';\n\nexport interface TripLocation {\n  id: number,\n  label: string,\n  latitude: number,\n  longitude: number\n  geoname_id?: number;\n  translations?: { [id: string]: string };\n\n  // Those will be used on map creation, but changes might be ignored on map update.\n  node_prop?: TripNodeProperties;\n  following_edge_prop?: TripEdgeProperties;\n}\n\nexport interface MapPreferences {\n  // redundant with default_edge_prop.geom. If both are specified,\n  // default_edge_prop.geom has priority.\n  line_shape?: LineShape;\n\n  map_style?: 'topo' | 'streets' | 'positron' | string;\n  page_sizes?: IPageSize[];\n\n  // the name of the page size to use when creating a new map, as defined in\n  // IPageSize. Must reference a format in page_sizes.\n  // if default_page_size is not defined or page_sizes does not contained the\n  // specified page size, 'Full page' 128x190 will be used.\n  default_page_size?: string;\n\n  // Those defaults are copied on map creation. After, the user is free to change\n  // them, and it is stored in MapParams.TripSaved.\n  default_edge_prop?: TripEdgeProperties;\n  default_node_prop?: TripNodeProperties;\n}\n\nexport interface MapParams {\n  locations?: TripLocation[];\n  locations_url?: string;\n\n  // Contains a json-encoded string or an object that can be loaded\n  // by SeqTrip.load(). This data is opaque to Rails code.\n  map_settings?: string | TripSaved;\n\n  // The URL to GET or POST TripSaved data\n  map_settings_url?: string;\n\n  // The map preferences stored in the theme\n  preferences?: MapPreferences;\n\n  // The language that map labels have to be rendered to.\n  language?: string;\n\n  // Both of these urls are expected to have a trailing /:\n  // For example:\n  // \"https://destinationbook-cssservice.herokuapp.com/\"\n  geoname_service_url: string;\n  map_print_service_url: string;\n\n  hide_ui?: boolean;\n}\n\n// Obsolete. This is for backward compatibility only.\ndeclare var thisTripApi: {\n  mapUrl: string;\n  locationsUrl: string;\n  tripLanguage: string;\n  lineShape?: LineShape;\n};\n\ndeclare var mapJson: any;\n\n// \"entry point\": this is the way to get access to the actual parameters.\nexport function globalMapParams(): MapParams {\n  let win = window as { global_map_params?: MapParams };\n  let map_params = win.global_map_params;\n\n  // thisTripApi should not be used anymore. This is kept for backward\n  // compatibility, for the transition period.\n  if (!map_params && thisTripApi) {\n    const cssservice = ((window as any).cssserviceUrl\n                        || \"https://destinationbook-cssservice.herokuapp.com/\");\n    win.global_map_params = {\n      locations_url: thisTripApi.locationsUrl,\n      map_settings_url: thisTripApi.mapUrl,\n      preferences: { line_shape: thisTripApi.lineShape },\n      language: thisTripApi.tripLanguage,\n      geoname_service_url: cssservice,\n      map_print_service_url: cssservice\n    };\n    map_params =  win.global_map_params;\n  }\n\n  // Compatibility with sass_compilator/map.html\n  if (!map_params && typeof(mapJson) != 'undefined') {\n    if (typeof(mapJson) == 'object' && mapJson.global_map_params) {\n      // the \"old\" print service passes arguments in mapJson, not global_map_params.\n      win.global_map_params = mapJson.global_map_params;\n    } else {\n      win.global_map_params = {\n        map_settings: mapJson,\n        language: mapJson.tripLanguage,\n        geoname_service_url: '',\n        map_print_service_url: '',\n        hide_ui: true\n      };\n    }\n    map_params = win.global_map_params;\n  }\n\n  if (!map_params) {\n    throw new Error(\"Can't find map parameters\");\n  }\n\n  // Make sure preferences exists, even if it is empty.\n  if (!map_params.preferences) {\n    map_params.preferences = {};\n  }\n\n  return map_params;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/map-params.ts","module.exports = \"<canvas\\n  #renderCanvas\\n  style=\\\"position: absolute;\\\"\\n  [style.width.px]=\\\"getCanvasWidth()\\\"\\n  [style.height.px]=\\\"getCanvasHeight()\\\"\\n  [attr.width] = 'getCanvasWidth() * pixelRatio()'\\n  [attr.height] = 'getCanvasHeight() * pixelRatio()'></canvas\\n><mapview2 #mapview\\n    style=\\\"display:block; position:absolute;\\\"\\n    [style.width.px]=\\\"getCanvasWidth()\\\"\\n    [style.height.px]=\\\"getCanvasHeight()\\\"\\n    [canvasWidth]=\\\"getCanvasWidth()\\\"\\n    [canvasHeight]=\\\"getCanvasHeight()\\\"\\n    [compactAttribution]=\\\"true\\\"\\n    [lang]=\\\"lang\\\"\\n    ></mapview2><canvas\\n  #eventCanvas\\n  style=\\\"position: absolute;\\\"\\n  [style.width.px]=\\\"getCanvasWidth()\\\"\\n  [style.height.px]=\\\"getCanvasHeight()\\\"\\n  [attr.width] = 'getCanvasWidth() * pixelRatio()'\\n  [attr.height] = 'getCanvasHeight() * pixelRatio()'></canvas>\\n<!--<input type=\\\"checkbox\\\" [(ngModel)]=\\\"_showOld\\\" style=\\\"position: absolute;\\\"/>-->\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/mapview.component.html\n// module id = ./frontend/map_editor/src/app/trip-map/mapview.component.html\n// module chunks = main","import { T, Location, CanvasTilesRenderer } from './tiles';\nimport { Input, Component, ViewChild, ElementRef, HostListener } from '@angular/core';\nimport { SeqTrip } from './seq-trip';\nimport { TripGraphLayer } from './trip-graph-layer';\nimport { TripGraph } from './trip-graph';\nimport { MapView2, klokanApiKey } from './mapview2.component';\nimport { Point } from './point';\n\n// Mapbox GL JS can be imported by node_modules, but it causes problems\n// because it gets compiled in vendor.js AND it is included in\n// app/views/layouts/application.html.erb.\n// Instead, we declare an external variable and skip type checking.\n// Additionnally, see https://github.com/angular/angular-cli/issues/5804\n//import { AttributionControl, Map, Style, Layer } from 'mapbox-gl';\ndeclare var mapboxgl: any;\nconst AttributionControl = mapboxgl.AttributionControl;\nconst Map = mapboxgl.Map;\n\ndeclare var Utils: any;\n\nexport interface PrepareCanvasOptions {\n  onLocationChange?: (renderer: CanvasTilesRenderer) => void,\n  created?: (renderer: CanvasTilesRenderer, tripLayer: TripGraphLayer) => void,\n  alreadyCreated?: (renderer: CanvasTilesRenderer, tripLayer: TripGraphLayer) => void,\n  graph?: TripGraph,\n  trip: SeqTrip,\n  disableMouseWheel?: boolean\n};\n\nfunction locationEquals(a: Location, b: Location) {\n  const dx = a.x - b.x;\n  const dy = a.y - b.y;\n  const ds = a.scale - b.scale;\n\n  const eps = 1e-7;\n\n  return (Math.abs(dx) < eps\n    && Math.abs(dy) < eps\n    && Math.abs(ds) < eps);\n}\n\n@Component({\n  selector: 'mapview',\n  templateUrl: 'mapview.component.html',\n  //styleUrls: ['./mapview.component.css'],\n})\nexport class MapView {\n  @Input() canvasWidth?: number;\n  @Input() canvasHeight?: number;\n  @Input() compactAttribution?: boolean;\n  @Input() lang: string;\n\n  // The canvas on which the overlay is displayed. Either hidden and rendered\n  // by mapboxgl js, or visible on top of the map (when map repeats).\n  @ViewChild('renderCanvas') renderCanvas: ElementRef;\n\n  // This canvas will remain transparent. Its goal is to catch mouse/touch\n  // events.\n  @ViewChild('eventCanvas') canvas: ElementRef;\n  @ViewChild('mapview') mapview : MapView2;\n\n  private _renderer: CanvasTilesRenderer;\n  private _map: any;\n  private _tripLayer: TripGraphLayer;\n  private waitingList : PrepareCanvasOptions[] = [];\n  private _seqTrip?: SeqTrip;\n  private _showOld: boolean = true;\n  private _options: PrepareCanvasOptions;\n  private _canvasWorldCoord: Point[];\n  private _removeMapLabels: boolean = false;\n\n  public onMapReady?: () => void;\n\n  constructor(private el:ElementRef){\n  }\n\n  pixelRatio() : number {\n    if (this._renderer && this._renderer.pixelRatio) {\n      return this._renderer.pixelRatio;\n    }\n    return 1;\n  }\n\n  getCanvasWidth(): number {\n    if (this.canvasWidth) {\n     return this.canvasWidth;\n    }\n    if (this.el && this.el.nativeElement) {\n      return this.el.nativeElement.offsetWidth;\n    }\n    return 0;\n  }\n\n  getCanvasHeight(): number {\n    if (this.canvasHeight) {\n     return this.canvasHeight;\n    }\n    if (this.el && this.el.nativeElement) {\n      return this.el.nativeElement.offsetHeight;\n    }\n    return 0;\n  }\n\n  isReady() : boolean {\n    const map = this._map;\n    return map && this._renderer && this._tripLayer\n      && this._tripLayer.isReady() && map.loaded()\n      && !(map._sourcesDirty || map._repaint || map._styleDirty || map._placementDirty);\n  }\n\n  prepareCanvas(options: PrepareCanvasOptions) {\n    this._options = options;\n    if (!this.canvas || !this.canvas.nativeElement || this._renderer || this._map) {\n      if (options.alreadyCreated) {\n        if (this._map.loaded()) {\n          options.alreadyCreated(this._renderer, this._tripLayer);\n        } else {\n          this.waitingList.push(options);\n        }\n      }\n      return;\n    }\n\n    this._map = this.mapview.createMap(options.trip);\n\n    this._map.on('load', () => {\n      const canvas = this.canvas.nativeElement;\n      const location = options.trip.location();\n\n      this._renderer = new T.CanvasTilesRenderer({\n        canvas: canvas,\n        width: 1,\n        clearBorder: false,\n        downsampleDuringMotion: false,\n        fillScreen: false,\n        downgradeIfSlowerFPS: 1e-8,\n        url: 'https://tiles.wmflabs.org/bw-mapnik/$scale/$x/$y.png',\n        initialLocation: location,\n        onLocationChange: (renderer: CanvasTilesRenderer) => {\n          const newLocation = renderer.getLocation();\n          this.setMapboxLocation(newLocation);\n          if (options.onLocationChange) {\n            options.onLocationChange(renderer);\n          }\n        }\n      });\n\n      this._renderer.pinchZoom.maxScale = this.getScaleFromZoom(0);\n\n      if (options.disableMouseWheel) {\n        this._renderer.pinchZoom.handleMouseWheel = function(event) { };\n      }\n\n      this._renderer.layers = [\n        {\n          draw: () => {\n            const canvas = this.renderCanvas.nativeElement;\n            const baseCanvas = this.canvas.nativeElement;\n            canvas.width = baseCanvas.width;\n            canvas.height = baseCanvas.height;\n\n            const context = canvas.getContext('2d');\n            context.clearRect(0, 0, canvas.width, canvas.height);\n          }\n        }\n      ];\n\n      this._tripLayer = new TripGraphLayer({\n        renderer: this._renderer,\n        graph: options.graph\n      });\n      \n      this._renderer.addLayer(this._tripLayer);\n      const oldDraw = this._tripLayer.draw;\n      const zis = this;\n      this._tripLayer.draw = function() {\n        this.hideLabels = !zis._removeMapLabels;\n        this.forceLeaderLines = true;\n        if (zis._showOld) {\n          const canvas = zis.renderCanvas.nativeElement;\n          arguments[0] = canvas;\n          oldDraw.apply(this, arguments);\n          const w = canvas.width;\n          const h = canvas.height;\n          zis._canvasWorldCoord = [[0, 0], [w, 0], [w, h], [0, h]].map(\n              (p) => zis._renderer.pinchZoom.worldPosFromViewerPos({x: p[0], y: p[1]})\n            );\n          zis.updateCanvas();\n        }\n      };\n\n      if (options.created) {\n        options.created(this._renderer, this._tripLayer);\n      }\n      for (let opt of this.waitingList) {\n        if (opt.alreadyCreated) {\n          opt.alreadyCreated(this._renderer, this._tripLayer);\n        }\n      }\n\n      // Let the canvas draw itself properly before activating\n      // it on mapboxgl map.\n      setTimeout(()=>{\n        this.setSeqTrip(options.trip);\n        if (location) {\n          this._removeMapLabels = location.scale > 1;\n          this.switchCanvasVisibility(this._removeMapLabels);\n          this.mapview.switchCustomLayers(!this._removeMapLabels);\n        }\n      }, 10);\n\n      this.resize();\n    }); // on map loaded\n\n    this._map.on('idle', () => {\n      const map = this._map;\n      if (this.isReady()) {\n        if (this.onMapReady) {\n          this.onMapReady();\n        }\n      } else {\n        console.log('mapbox map is ready, but not mapview!!');\n      }\n    });\n\n  }\n\n  getLayer(id: string) : any {\n  }\n\n  setLayerColors(seqTrip: SeqTrip) {\n    // Changing map colors is disabled for now.\n    /*\n      let layer = this.getLayer('water');\n      if (layer) {\n        layer.paint['fill-color'] = seqTrip.seaColor();\n      }\n      layer = this.getLayer('background');\n      if (layer) {\n        layer.paint['background-color'] = seqTrip.landColor();\n      }\n      layer = this.getLayer('boundary_2');\n      if (layer) {\n        layer.paint['line-color'] = seqTrip.borderColor();\n      }\n\n      this._map.setStyle(this._mapStyle);\n    */\n  }\n\n  resize() {\n    this.mapview.resize();\n    if (this._renderer) {\n      this._renderer.pinchZoom.maxScale = this.getScaleFromZoom(0);\n      this.setMapboxLocation(this._renderer.getLocation());\n    }\n  }\n\n  setMapboxLocation(loc: Location) {\n    this.mapview.setMapboxLocation(loc);\n\n    this._removeMapLabels = loc.scale > 1;\n    this.switchCanvasVisibility(this._removeMapLabels);\n    this.mapview.switchCustomLayers(!this._removeMapLabels);\n  }\n\n  getZoomFromLocation(loc?: Location): number {\n    if (loc) {\n      // 512 * 2^z = world size\n      // width / 512 = num tiles in view\n      // s = s_window / (width/512) = scale of 1 tile\n      // s = 1/(2^z)\n      // 1/s = 2^z\n      // log2(1/s) = z\n      const width = this.getCanvasWidth();\n      return Math.log2(1 / (loc.scale * ( 512 / width)));\n    }\n    return 8;\n  }\n\n  getScaleFromZoom(zoom) {\n      const width = this.getCanvasWidth();\n      return (width / 512) * 1 / Math.pow(2, zoom);\n  }\n\n  setSeqTrip(seqTrip: SeqTrip) : TripGraph {\n    this._seqTrip = seqTrip;\n    let graph;\n    if (this._tripLayer.graph && Object.keys(this._tripLayer.graph.nodes).length > 0) {\n      graph = this._tripLayer.graph;\n    } else {\n      graph = seqTrip.makeGraph(this._tripLayer);\n      this._tripLayer.graph = graph;\n    }\n\n    this._tripLayer.defaultRadius = seqTrip.defaultRadius();\n    this._tripLayer.defaultTextProp = seqTrip.defaultTextProp();\n    this._tripLayer.defaultEdgeProp = seqTrip.defaultEdgeProp();\n    const loc = seqTrip.location();\n    if (!locationEquals(loc, this._renderer.location)) {\n      // Avoid triggering onLocationChange\n      this._renderer.setLocation(loc);\n    }\n    this.setMapboxLocation(loc);\n    this.setLayerColors(seqTrip);\n    this._renderer.refresh();\n    this.resize();\n\n    this._tripLayer.loadIcons((err) => {\n      if (err) {\n        console.log(err);\n      }\n      this._renderer.refresh();\n    });\n    const canvas = this.renderCanvas.nativeElement;\n\n    const w = canvas.width;\n    const h = canvas.height;\n    this.mapview.addTripLayers(seqTrip, graph, canvas,\n      [[0, 0], [w, 0], [w, h], [0, h]].map(\n        (p) => this._renderer.pinchZoom.worldPosFromViewerPos({x: p[0], y: p[1]})\n      ),\n      this._tripLayer.markedPlaces\n    );\n\n    return graph;\n  }\n\n  updateCanvas() {\n    if (!this._canvasWorldCoord) {\n      return;\n    }\n\n    const canvas = this.renderCanvas.nativeElement;\n    const w = canvas.width;\n    const h = canvas.height;\n    this.mapview.updateCanvasLayer(\n        canvas, this._canvasWorldCoord, this._tripLayer.markedPlaces);\n  }\n\n  refresh() {\n    if (this._renderer) {\n      this._renderer.refresh();\n    }\n    if (this._seqTrip) {\n      this.setSeqTrip(this._seqTrip);\n    }\n  }\n\n  attribution() : string[] {\n    const map = this._map;\n    if (!map || !map.style) return [];\n    var attributions = [];\n\n    const sourceCaches = map.style.sourceCaches;\n    for (const id in sourceCaches) {\n        const sourceCache = sourceCaches[id];\n        if (sourceCache.used) {\n            const source = sourceCache.getSource();\n            if (source.attribution && attributions.indexOf(source.attribution) < 0) {\n                attributions.push(source.attribution);\n            }\n        }\n    }\n\n    // remove any entries that are substrings of another entry.\n    // first sort by length so that substrings come first\n    attributions.sort((a, b) => a.length - b.length);\n    attributions = attributions.filter((attrib, i) => {\n        for (let j = i + 1; j < attributions.length; j++) {\n            if (attributions[j].indexOf(attrib) >= 0) { return false; }\n        }\n        return true;\n    });\n\n    return attributions;\n  }\n\n  switchCanvasVisibility(onoff) {\n     const canvas = this.renderCanvas.nativeElement;\n     const parent = canvas.parentElement;\n     if (onoff) {\n       parent.insertBefore(canvas, this.canvas.nativeElement);\n     } else {\n       parent.insertBefore(canvas, parent.firstChild);\n     }\n  }\n\n  addMarker(p: { latitude: number, longitude: number }, el: any) : any {\n    if (!this._map) {\n      return undefined;\n    }\n    const marker = new mapboxgl.Marker(el)\n      .setLngLat([p.longitude, p.latitude])\n      .addTo(this._map);\n    return marker;\n  }\n\n  addAttributionControl(compact: boolean) {\n    if (!this._map) {\n      return undefined;\n    }\n    this._map.addControl(new AttributionControl({ compact: compact }));\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/mapview.component.ts","module.exports = \"<div #mapDiv\\n    style=\\\"position: absolute;\\\"\\n    [style.width.px]=\\\"canvasWidth\\\"\\n    [style.height.px]=\\\"canvasHeight\\\"\\n    ></div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/mapview2.component.html\n// module id = ./frontend/map_editor/src/app/trip-map/mapview2.component.html\n// module chunks = main","import { Location } from './tiles';\nimport { Input, Component, ViewChild, ElementRef, HostListener } from '@angular/core';\nimport { SeqTrip } from './seq-trip';\nimport { TripNode } from './trip-node';\nimport { TripEdge } from './trip-edge';\nimport { IPoint, Point } from './point';\nimport { TripGraph } from './trip-graph';\n\nexport const klokanApiKey = 'e7trAnc5053j8mX60MlQ';\n\n// Mapbox GL JS can be imported by node_modules, but it causes problems\n// because it gets compiled in vendor.js AND it is included in\n// app/views/layouts/application.html.erb.\n// Instead, we declare an external variable and skip type checking.\n// Additionnally, see https://github.com/angular/angular-cli/issues/5804\n//import { AttributionControl, Map, Style, Layer } from 'mapbox-gl';\ndeclare var mapboxgl: any;\nconst AttributionControl = mapboxgl.AttributionControl;\nconst Map = mapboxgl.Map;\nconst ScaleControl = mapboxgl.ScaleControl;\n\ndeclare var Utils: any;\ndeclare var Bezier: any;\n\n\nfunction worldToLatLon(p? : IPoint): [number] {\n  if (!p) {\n    return [] as [number];\n  }\n  const ll = Utils.worldToLatLon(p);\n  return [ll.lon, ll.lat];\n}\n\nfunction coordinatesOfEdge(edge : TripEdge, trip: SeqTrip, graph: TripGraph) {\n  const nodes = graph.nodes;\n  let geom = trip.edgeProperty(edge, 'geom');\n\n  if ((edge.properties && edge.properties.hidden)\n      || nodes[edge.from].properties.skip\n      || nodes[edge.to].properties.skip) {\n    return [];\n  }\n  if (geom == 'route') {\n    if (edge.properties && edge.properties.route && edge.properties.route.geom) {\n      return edge.properties.route.geom.map(worldToLatLon);\n    } else {\n      geom = 'straight';\n    }\n  }\n  if (geom == 'straight') {\n    return [ nodes[edge.from].coord, nodes[edge.to].coord ].map(worldToLatLon);\n  }\n\n  if (edge.controlPoints.length == 2) {\n    // bezier\n    const ctrlPoints = [\n          nodes[edge.from].coord,\n          edge.controlPoints[0],\n          edge.controlPoints[1],\n          nodes[edge.to].coord\n    ];\n\n    const ptArray = [];\n    for (let p of ctrlPoints) {\n      ptArray.push(p.x);\n      ptArray.push(p.y);\n    }\n    const bezier = new Bezier(ptArray);\n\n    const points = bezier.getLUT(128);\n    return points.map(worldToLatLon);\n  }\n\n  console.log('Unexpected edge structure, not drawing');\n  return [];\n}\n\nfunction styleUrl(style) {\n  if (style.match(/^http/)) {\n    return style;\n  }\n  return 'https://maps.tilehosting.com/styles/' + style + '/style.json?key=' + klokanApiKey;\n}\n\nexport interface PrepareCanvasOptions {\n};\n\n@Component({\n  selector: 'mapview2',\n  templateUrl: 'mapview2.component.html',\n})\nexport class MapView2 {\n  @Input() canvasWidth: number;\n  @Input() canvasHeight: number;\n  @Input() compactAttribution?: boolean;\n  @Input() lang: string;\n\n  @ViewChild('mapDiv') mapDiv: ElementRef;\n\n  private _map: any;\n  private _trip: SeqTrip;\n  private _graph?: TripGraph;\n  private waitingList : PrepareCanvasOptions[] = [];\n  private pauseCanvasSourceTimeout?;\n  private _disabledLayers?: any[];\n  private _iconFactor?: number;\n\n  pixelRatio() : number {\n    return window.devicePixelRatio || 1;\n  }\n\n  createMap(trip : SeqTrip) {\n    if (this._map) {\n      return;\n    }\n\n    const options = {\n      container: this.mapDiv.nativeElement,\n      // To change the style, it is also necessary to change the name filters\n      // below.\n      style: styleUrl(trip.getMapStyle()), \n      center: worldToLatLon(trip.location()),\n      zoom: this.getZoomFromLocation(trip.location()),\n      attributionControl: false,\n      minZoom: 0,\n      renderWorldCopies: true\n    };\n    this._map = new Map(options);\n\n    //this._map.addControl(new AttributionControl({\n    //  compact: this.compactAttribution }));\n\n\n    this._map.on('error', (err) => {\n      console.log('Map error:', err);\n    });\n\n    this._map.on('load', () => {\n      const allSource = Object.keys(this._map.getStyle().sources);\n\n      if (this.lang) {\n        this._map.setLanguage(this.lang);\n      }\n\n      for (let s of allSource) {\n        const source = this._map.getSource(s);\n        if (source) {\n          // Boost details\n          source.tileSize = 400; // instead of 512\n          source.roundZoom = true;\n        }\n      }\n    });\n\n    const scale = new ScaleControl();\n    this._map.addControl(scale);\n\n    return this._map;\n  }\n\n  addTripLayers(trip: SeqTrip, graph: TripGraph, canvas: HTMLCanvasElement,\n                coord: Point[], markedPlaces: IPoint[]) {\n    const map = this._map;\n    this._graph = graph;\n\n    const dayEdgeData = this.buildPathGeoJson(trip, graph);\n    const dayEdgeSource = map.getSource('dayEdges');\n    const firstSymbolId = this.firstLayerOfType('symbol').id;\n\n    if (!canvas) {\n      if (dayEdgeSource) {\n        dayEdgeSource.setData(dayEdgeData);\n      } else {\n        map.addSource('dayEdges', {\n          \"type\": \"geojson\",\n          \"data\": dayEdgeData\n        });\n      }\n      if (map.getLayer('dayEdgesLayer') == undefined) {\n        const edges = map.addLayer({\n          \"id\": \"dayEdgesLayer\",\n          \"type\": \"line\",\n          \"source\": 'dayEdges',\n          minZoom: 0,\n          \"layout\": {\n            \"line-join\": \"round\",\n            \"line-cap\": \"round\"\n          },\n          \"paint\": {\n            'line-color': ['get', 'color'],\n            \"line-width\": ['get', 'width'],\n            //'line-dasharray': [1,2]\n          }\n        }, firstSymbolId);\n      }\n    } else {\n      this.updateCanvasLayer(canvas, coord, markedPlaces);\n    }\n\n    const dayPlacesData = this.buildPlacesGeoJson(trip, graph);\n    const dayPlacesSource = map.getSource('dayPlaces');\n    if (dayPlacesSource) {\n      dayPlacesSource.setData(dayPlacesData);\n      map.setLayoutProperty('dayLabels', 'icon-size', this._iconFactor);\n    } else {\n      map.addSource('dayPlaces', {\n          \"type\": \"geojson\",\n          \"data\": dayPlacesData\n        });\n      // The following makes it possible to draw place circles with mapbox.\n      // However, it does not support the black dot inside the circle to\n      // highlight some places. So we render using the canvas instead.\n      /*\n      map.addLayer({\n        \"id\": \"placesCircle\",\n        \"type\": \"circle\",\n        \"source\": 'dayPlaces',\n        \"paint\": {\n          'circle-radius': 6,\n          'circle-color': '#ffffff',\n          'circle-stroke-width': 2,\n          'circle-stroke-color': '#000000'\n        },\n      }, firstSymbolId);\n      */\n\n      this.genBlackDot();\n      map.addLayer({\n        id: 'dayLabels',\n        type: 'symbol',\n        source: 'dayPlaces',\n        minZoom: 0,\n        layout: {\n            \"text-field\": \"{label}\",\n            \"text-font\": [ 'match', [ 'get', 'fontName' ],\n              'noto', [ 'literal', [ 'Noto Sans Bold' ] ],\n              [ 'literal', [ 'Open Sans Semibold' ] ] ],\n            \"text-anchor\": \"center\",\n            \"text-offset\": {\n               \"type\": \"identity\",\n               \"property\": \"labelOffset\"\n            },\n            \"text-size\": {\n              property: \"fontSize\",\n              type: \"identity\"\n            },\n            \"text-allow-overlap\": true,\n            \"text-max-width\": 100,\n            \"visibility\": this._disabledLayers ? 'none' : 'visible',\n            \"icon-image\": ['get', 'icon'],\n            \"icon-anchor\": 'center',\n            \"icon-allow-overlap\": true,\n            \"icon-size\": this._iconFactor,\n            \"icon-offset\": {\n               \"type\": \"identity\",\n               \"property\": \"iconOffset\"\n            },\n        },\n        paint: {\n            \"text-color\": { property: 'fill', type: 'identity' },\n            \"text-halo-color\": { property: 'stroke', type: 'identity' },\n            \"text-halo-width\": 1.2\n        }\n      });\n\n      // TODO: hide labels dynamicaly\n      const placeNames = trip.places()\n          .filter((p : TripNode) => { return !p.properties.skip; })\n          .map((p : TripNode) => { return p.label + ''; });\n      this.hidePlaces(placeNames);\n    }\n  }\n\n  updateCanvasLayer(canvas: HTMLCanvasElement, coord: Point[],\n                    markedPlaces: IPoint[]) {\n    if (!canvas || !coord) {\n      return;\n    }\n    const map = this._map;\n    let canvasSource = map.getSource('canvasSource');\n    if (canvasSource) {\n      const oldCoord = canvasSource.coordinates;\n      const newCoord = coord.map(worldToLatLon);\n\n      if (JSON.stringify(oldCoord) != JSON.stringify(newCoord)) {\n        canvasSource.setCoordinates(newCoord);\n      }\n      canvasSource.play();\n    } else {\n      const firstSymbolId = this.firstLayerOfType('symbol').id;\n\n      map.addSource('canvasSource', {\n        \"type\": \"canvas\",\n        \"canvas\": canvas,\n        \"animate\": true,\n        \"coordinates\": coord.map(worldToLatLon)\n      });\n\n      map.addLayer({\n        id: 'canvasLayer',\n        type: 'raster',\n        source: 'canvasSource',\n        paint: {\n          'raster-fade-duration': 0\n        },\n        layout: {\n          \"visibility\": this._disabledLayers ? 'none' : 'visible'\n        },\n        minZoom: 0,\n      }, firstSymbolId);\n    }\n    if (this.pauseCanvasSourceTimeout) {\n      clearTimeout(this.pauseCanvasSourceTimeout);\n    }\n    // The initial rendering might be wrong due to resize or anything else.\n    // So we need to animate for a while in the beginning.\n    this.pauseCanvasSourceTimeout =  setTimeout(() => {\n      this.pauseCanvasSourceTimeout = undefined;\n      map.getSource('canvasSource').pause();\n    }, 200);\n\n    this.killMapLabels(markedPlaces);\n  }\n\n  firstLayerOfType(type: string) : any {\n    const layers = this._map.getStyle().layers;\n    for (let i = 0; i < layers.length; i++) {\n      if (layers[i].type === type\n          // In style topo, there's a spurious layer: contour_label.\n          && layers[i].id != 'contour_label'\n\n          // In positron style, there are a few layer to ignore.\n          && !layers[i].id.match(/^(water_name)|(highway)/)\n          ) {\n        //console.log('Layer id: ' + layers[i].id);\n        return layers[i];\n      }\n    }\n  }\n\n  resize() {\n    if (this._map) {\n      this._map.resize();\n      if (this._trip) {\n        this.setMapboxLocation(this._trip.location());\n      }\n    }\n  }\n\n  setMapboxLocation(loc: Location) {\n    if (!isFinite(loc.x) || !isFinite(loc.y)) {\n      throw(new Error('Invalid coordinates: '\n                     + loc.x + ', ' + loc.y));\n    }\n    if (!this._map) {\n      return;\n    }\n\n    this._map.setCenter(worldToLatLon(loc));\n\n    if (isFinite(loc.scale)) {\n      this._map.setZoom(this.getZoomFromLocation(loc));\n    }\n  }\n\n  getZoomFromLocation(loc?: Location): number {\n    if (loc) {\n      // 512 * 2^z = world size\n      // width / 512 = num tiles in view\n      // s = s_window / (width/512) = scale of 1 tile\n      // s = 1/(2^z)\n      // 1/s = 2^z\n      // log2(1/s) = z\n      const width = this.canvasWidth;\n      return Math.log2(1 / (loc.scale * ( 512 / width)));\n    }\n    return 8;\n  }\n\n  private buildPathGeoJson(trip: SeqTrip, graph: TripGraph) {\n    return {\n      \"type\": \"FeatureCollection\",\n      \"features\": graph.edges.map((s : TripEdge) => {\n        return {\n          \"type\": \"Feature\",\n          \"geometry\": {\n            \"type\": \"LineString\",\n            \"coordinates\": coordinatesOfEdge(s, trip, graph),\n          },\n          \"properties\": {\n            \"mean\": s.properties.travelMean,\n\t    \"color\": trip.edgeProperty(s, 'lineColor'),\n\t    \"width\": parseFloat(trip.edgeProperty(s, 'lineWidth')) /* * this.pixelRatio() */,\n\t    \"dashed\": (trip.edgeProperty(s, 'dashed') || []).concat([1])[0],\n          }\n        };\n      })\n    };\n  }\n\n  private buildPlacesGeoJson(trip: SeqTrip, graph: TripGraph) {\n    let features = [];\n    this._iconFactor = (trip.defaultTextProp().fontSize/12 * 16 + 4) / 64.0;\n    for (let name in graph.nodes) {\n      const p = graph.nodes[name]; \n      if (p.properties.skip) {\n\tcontinue;\n      }\n\n      const fontSize = (trip.nodeProperty(p, 'fontSize') || 12);\n      let offset = [ 0, 0 ];\n      let iconOffset = [ 0, 0 ];\n\n      if (p.properties.labelPixelOffset) {\n        // convert pixels to em units\n        const conv = 1 / fontSize;\n\n        offset = [\n          p.properties.labelPixelOffset.x * conv,\n          p.properties.labelPixelOffset.y * conv\n        ];\n        iconOffset = [\n          p.properties.labelPixelOffset.x / this._iconFactor,\n          p.properties.labelPixelOffset.y / this._iconFactor\n        ];\n      }\n      features.push({\n          \"type\": \"Feature\",\n          \"geometry\": {\n            \"type\": \"Point\",\n            \"coordinates\": worldToLatLon(p.coord)\n          },\n          \"properties\": {\n            \"label\": p.label,\n            \"labelOffset\": offset,\n            \"iconOffset\": iconOffset,\n            \"fontSize\": fontSize,\n            \"fontName\": trip.nodeProperty(p, 'blackdot') ? 'noto' : 'default',\n            \"icon\": trip.nodeProperty(p, 'blackdot') ? 'blackdot' : '',\n            \"fill\": trip.nodeProperty(p, 'fill'),\n            \"stroke\": trip.nodeProperty(p, 'stroke'),\n          }\n        });\n    }\n\n    return {\n      \"type\": \"FeatureCollection\",\n      \"features\": features\n    };\n  }\n \n  hidePlaces(places: string[]) {\n    const hidePlacesFilters = [\n      ['!in', 'name:' + this.lang].concat(places),\n      ['!in', 'name'].concat(places)\n    ];\n\n    // The code below assumes the map style 'street' is applied, and has been\n    // modified by the setLanguage function.\n    const suffixes = ['', '-' + this.lang ];\n    const map = this._map;\n    ['place_city_capital', 'place_city', 'place_town', 'place_village', 'place_other']\n      .forEach(function(place) {\n        suffixes.forEach(function(suffix) {\n          const id = place + suffix;\n          if (map.getLayer(id)) {\n            let filter = map.getFilter(id)\n            filter = filter.concat(hidePlacesFilters);\n            map.setFilter(id, filter);\n          }\n        });\n      });\n  }\n\n  killMapLabels(markedPlaces: IPoint[]) {\n    const map = this._map;\n\n    if (!map.hasImage('blank4')) {\n      const width = 4; // The image will be 4x4 pixels square\n      const bytesPerPixel = 4; // Each pixel is represented by 4 bytes: red, green, blue, and alpha.\n      const data = new Uint8Array(width * width * bytesPerPixel);\n\n      for (var x = 0; x < width; x++) {\n        for (var y = 0; y < width; y++) {\n          var offset = (y * width + x) * bytesPerPixel;\n          data[offset + 0] = 255;  // red\n          data[offset + 1] = 0;    // green\n          data[offset + 2] = 0;    // blue\n          data[offset + 3] = 0;    // alpha\n        }\n      }\n\n      map.addImage('blank4', {width: width, height: width, data: data});\n    }\n\n    if (!markedPlaces) {\n      console.log('No marked places!');\n    }\n    let blankCoords : number[][] = markedPlaces.map(worldToLatLon);\n    \n    if (this._graph) {\n      // Kill labels around all node centers\n      blankCoords = blankCoords.concat(\n          Object.keys(this._graph.nodes).map((k) => {\n            const p = this._graph.nodes[k].coord;\n            return worldToLatLon(p);\n          }));\n    }\n\n    // Add blank coords all around the viewport to kill labels that might\n    // cross the viewport boundary\n    const canvas = map.getCanvas();\n    const w = canvas.clientWidth;\n    const h = canvas.clientHeight;\n\n    const delta = 18;\n    const borders = [];\n    for (let x = delta; x < w; x+= delta) {\n      borders.push(map.unproject([x, 0]));\n      borders.push(map.unproject([x, h]));\n    }\n    for (let y = delta; y < h; y+= delta) {\n      borders.push(map.unproject([0, y]));\n      borders.push(map.unproject([w, y]));\n    }\n\n    blankCoords = blankCoords.concat(borders.map((x) => [x.lng, x.lat]));\n\n    const blankData = {\n      type: \"FeatureCollection\",\n      features: blankCoords.map((x) => {\n        return {\n          type: \"Feature\",\n          geometry: {\n            type: \"Point\",\n            coordinates: x\n          }\n        };\n      })\n    };\n\n    const source = map.getSource('blankSource');\n    if (!source) {\n      map.addSource('blankSource', {\n          \"type\": \"geojson\",\n          \"data\": blankData\n        });\n\n      map.addLayer({\n        id: 'blank',\n        type: 'symbol',\n        source: 'blankSource',\n        minZoom: 0,\n        layout: {\n          \"icon-image\": 'blank4',\n          \"icon-anchor\": 'center',\n          \"icon-size\": 4,\n          \"icon-allow-overlap\": true,\n          \"visibility\": this._disabledLayers ? 'none' : 'visible'\n        }\n      });\n    } else {\n      source.setData(blankData);\n    }\n  }\n\n\n  switchCustomLayers(onoff) {\n    if (!this._map) {\n      return;\n    }\n    const map = this._map;\n\n    if (onoff && !this._disabledLayers) {\n      // already enabled.\n      return;\n    }\n\n    if (!onoff) {\n      if (this._disabledLayers) {\n        // already disabled.\n        return;\n      }\n\n      this._disabledLayers = [\n        'blank', \n        'dayLabels',\n        'canvasLayer'];\n      const layers = this._map.getStyle().layers;\n      for (let i = 0; i < layers.length; i++) {\n        const layer = layers[i];\n        if (layer.type == 'symbol'\n            && map.getLayoutProperty(layer.id, 'visibility') == 'visible') {\n          this._disabledLayers.push(layer.id);\n        }\n      }\n    }\n    const visibility = (onoff ? 'visible' : 'none');\n    this._disabledLayers.forEach((layerid) => {\n        map.setLayoutProperty(layerid, 'visibility', visibility);\n    });\n    if (onoff) {\n      this._disabledLayers = undefined;\n    }\n  }\n\n  genBlackDot() {\n    const map = this._map;\n    if (!map.hasImage('blackdot')) {\n      const width = 64; // The image will be 4x4 pixels square\n      const bytesPerPixel = 4; // Each pixel is represented by 4 bytes: red, green, blue, and alpha.\n      const data = new Uint8Array(width * width * bytesPerPixel);\n\n      const r = (width - 1) / 2;\n      const center = new Point((width - 1) / 2, (width - 1) / 2);\n      for (let x = 0; x < width; x++) {\n        for (let y = 0; y < width; y++) {\n          const p = new Point(x, y);\n          const dist = Point.dist(p, center);\n\n          const alpha = Math.min(1, Math.max(0, r - dist));\n\n          var offset = (y * width + x) * bytesPerPixel;\n          data[offset + 0] = 0;  // red\n          data[offset + 1] = 0;  // green\n          data[offset + 2] = 0;  // blue\n          data[offset + 3] = 255 * alpha;\n        }\n      }\n\n      map.addImage('blackdot', {width: width, height: width, data: data});\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/mapview2.component.ts","import { Point } from './point';\n\ndeclare var $: any;\n\nexport interface LatLon {\n  lat: number;\n  lon: number;\n};\n\nlet cache : { [key: string]: Promise<number[][]> }  = { };\n\nfunction getProfile(mean: string) : string | undefined {\n  switch(mean) {\n    case 'Car': return 'driving-car';\n    case 'Bus': return 'driving-hgv';\n    case 'Bike': return 'cycling-regular';\n    case 'Walk': return 'foot-walking';\n    default: return undefined;\n  }\n}\n\nfunction getClosestAddress(location: LatLon): Promise<LatLon> {\n  const url = [\n    'https://api.openrouteservice.org/geocode/reverse?'\n    + 'api_key=5b3ce3597851110001cf6248e0fee72951d5494c8b4cf5d8b4ff2b76',\n    'point.lat=' + location.lat,\n    'point.lon=' + location.lon,\n    'sources=oa'\n  ].join('&');\n\n  return new Promise((resolve, reject) => {\n    $.getJSON(url)\n    .done((data) => {\n      if (data && data.features && data.features[0] && data.features[0].geometry\n          && data.features[0].geometry.coordinates) {\n        resolve({lon: data.features[0].geometry.coordinates[0], lat: data.features[0].geometry.coordinates[1]} as LatLon)\n      } else {\n        reject(new Error('Empty or bad data from openrouteservice'));\n      }\n    })\n    .fail((err) => {\n       if (typeof err == 'object'\n           && typeof err.status == 'number'\n           && err.status >= 400 && err.status < 500) {\n         // unrecoverable error. We should forget the idea of having a route\n         // for this edge.\n         reject(err);\n       }\n       // TODO try again later.\n       reject(err);\n    });\n  });\n}\n\nfunction distance(a: LatLon, b: LatLon) {\n  const dx = a.lat - b.lat;\n  const dy = a.lon - b.lon;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nfunction findClosest(reference: LatLon, locations: LatLon[]): LatLon {\n  let bestDist;\n  let bestLoc;\n  for (let l of locations) {\n    const dist = distance(reference, l);\n    if (bestDist == undefined || dist < bestDist) {\n      bestDist = dist;\n      bestLoc = l;\n    }\n  }\n  return bestLoc;\n}\n\n/* conditions to use overpass-api:\n *\n * Any of the three servers has a total capacity of about 1,000,000 requests\n * per day. You can safely assume that you don't disturb other users when you\n * do less than 10,000 queries per day and download less than 5 GB data per\n * day. The address overpass-api.de and endpoint\n * https://overpass-api.de/api/interpreter will continue to work and redirects\n * per round robin to z and lz4.\n *\n * we should be fine.\n * See https://wiki.openstreetmap.org/wiki/Overpass_API#Public_Overpass_API_instances\n */\nasync function getClosestRoad(location: LatLon): Promise<LatLon> {\n  return new Promise((resolve: (loc: LatLon) => void, reject) => {\n    $.getJSON(\n      'http://overpass-api.de/api/interpreter?data='\n      + encodeURIComponent('[out:json];('\n        + 'way[\"highway\"~\"^(road|motorway|trunk|primary|secondary|tertiary|residential)$\"]'\n        + '[\"access:conditional\"!~\"no\"][\"access\"!~\"no\"]'\n        + '[\"name\"](around:15000,' + location.lat + ',' + location.lon + ');>;);out 32;\\n'))\n    .done((data) => {\n      if (data && Array.isArray(data.elements) && data.elements.length >= 1\n          && data.elements[0].lat && data.elements[0].lon) {\n        const closest = findClosest(location, data.elements);\n        resolve(closest);\n      } else {\n        reject('Bad or empty reply from overpass');\n      }\n    })\n    .fail(reject);\n  });\n}\n\nconst closestAddressCache: { [key: string]: Promise<LatLon> } = {};\n\nfunction getClosestAddressOrRoad(location: LatLon): Promise<LatLon> {\n  const key = JSON.stringify(location);\n  if (closestAddressCache[key]) {\n    return closestAddressCache[key];\n  }\n  return closestAddressCache[key] = (async () => {\n    try {\n      return await getClosestRoad(location);\n    } catch(err) { /* failed, let's try another service */ }\n\n    try {\n      return await getClosestAddress(location);\n    } catch(err) {\n      // also failed.. but we can continue with the input location,\n      // hoping that the routing service will work.\n    }\n    return location;\n  })();\n}\n\nfunction fetchDirections(from: LatLon, to: LatLon, profile: string): Promise<number[][]> {\n  const url = [\n        'https://api.openrouteservice.org/directions?'\n          + 'api_key=5b3ce3597851110001cf6248e0fee72951d5494c8b4cf5d8b4ff2b76',\n        'coordinates=' + from.lon + '%2C' + from.lat + '|'\n                      + to.lon + '%2C' + to.lat,\n        'profile=' + profile,\n        'geometry_format=geojson',\n        'geometry_simplify=true',\n        'radiuses=-1|-1'\n      ] .join('&');\n  return new Promise((resolve, reject) => {\n    $.getJSON(url)\n    .done((data) => {\n      if (data && data.routes && data.routes[0] && data.routes[0].geometry\n          && data.routes[0].geometry.coordinates) {\n        resolve(data.routes[0].geometry.coordinates)\n      } else {\n        reject(new Error('Empty or bad data from openrouteservice'));\n      }\n    })\n    .fail(reject);\n  });\n}\n\nexport function getDirections(from: LatLon, to: LatLon, mean: string, retry: boolean = false): Promise<number[][]> {\n  const profile = getProfile(mean);\n  if (!profile) {\n    throw new Error('Transportation mean unsupported: ' + mean);\n  }\n\n  const cacheKey = JSON.stringify({ from, to, mean });\n\n  if (cacheKey in cache) {\n    return cache[cacheKey];\n  }\n\n  cache[cacheKey] = (async() => {\n    let replaceFrom: boolean = false;\n    let replaceTo: boolean = false;\n\n    try {\n      return await fetchDirections(from, to, profile);\n    } catch(err) {\n      if (typeof(err) != 'object' || !err.responseJSON\n          || err.responseJSON.error.code != 2010) {\n        // we propagate the error.\n        throw err;\n      }\n      const regex = /Cannot find point ([0-9]+)/g;\n      let matches;\n      while (matches = regex.exec(err.responseJSON.error.message)) {\n        switch(matches[1]) {\n          case '0': replaceFrom = true; break;\n          case '1': replaceTo = true; break;\n        }\n      }\n      if (!replaceFrom && !replaceTo) {\n        throw err;\n      }\n      // we may try again, replacing one of the destination.\n    }\n\n    // second attempt. Those functions always return something.\n    const _from = (replaceFrom ? await getClosestAddressOrRoad(from) : from);\n    const _to = (replaceTo ? await getClosestAddressOrRoad(to) : to);\n\n \n    // This time, we're not catching the error.\n    // If it fails, then.. we're out of luck.\n    const directions = await fetchDirections(_from, _to, profile);\n    directions.unshift([from.lon, from.lat])\n    directions.push([to.lon, to.lat])\n\n    return directions;\n  })();\n\n  return cache[cacheKey];\n}\n\nexport function midPoint(points: Point[]): number {\n  let length = 0;\n  const lengthArray : number[] = [ 0 ];\n  for (let i = 1; i < points.length; ++i) {\n    const dist = Point.dist(points[i], points[i-1]);\n    length += dist;\n    lengthArray.push(length);\n  }\n  const halfDist = length / 2;\n  for (let i = 0; i < lengthArray.length; ++i) {\n    if (lengthArray[i] > halfDist) {\n      return i - 1;\n    }\n  }\n  return 0;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/open-route-service.ts","export interface IPageSize {\n    name: string,\n    width_mm: number,\n    height_mm: number\n}\n\nexport class PageSize {\n\n  constructor(\n    public name: string,\n    public width_mm: number,\n    public height_mm: number) { }\n\n  static mmToPoint = 2.83465;\n\n  static fromPt(name: string, w_pt: number, h_pt: number) : PageSize {\n    return new PageSize(name, w_pt / PageSize.mmToPoint,\n                        h_pt / PageSize.mmToPoint);\n  }\n\n  static fromIPageSize(x: IPageSize) {\n    return new PageSize(x.name, x.width_mm, x.height_mm);\n  }\n\n  widthPt() { return Math.round(this.width_mm * PageSize.mmToPoint); }\n  heightPt() { return Math.round(this.height_mm * PageSize.mmToPoint); }\n  key(): string { return Math.round(this.width_mm) + 'x' + Math.round(this.height_mm); }\n};\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/page-size.ts","export interface IPoint {\n  x: number;\n  y: number;\n};\n\nexport class Point implements IPoint {\n  x: number;\n  y: number;\n\n  static minus(a: IPoint, b: IPoint) { return new Point(a.x - b.x, a.y - b.y); };\n  static plus(a: IPoint, b: IPoint) { return new Point(a.x + b.x, a.y + b.y); };\n  static times(t: number, a: IPoint) { return new Point(t * a.x, t * a.y); };\n  static min(a: IPoint, b: IPoint) {\n    return new Point(Math.min(a.x, b.x), Math.min(a.y, b.y));\n  };\n  static max(a: IPoint, b: IPoint) {\n    return new Point(Math.max(a.x, b.x), Math.max(a.y, b.y));\n  };\n\n  static dist(a: IPoint, b: IPoint) {\n    const dx = a.x - b.x;\n    const dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  };\n\n  static norm(a: IPoint): number { return Math.sqrt(a.x * a.x + a.y * a.y); };\n\n  static nearest(target: IPoint, points: Point[]): Point | undefined {\n    let best;\n    let bestDist;\n    for (let p of points) {\n      const dist = Point.dist(p, target);\n      if (best === undefined || dist < bestDist) {\n        bestDist = dist;\n        best = p;\n      }\n    }\n    return best;\n  };\n\n  static rotate(p: IPoint, angle: number): Point {\n    const cos = Math.cos(angle);\n    const sin = Math.sin(angle);\n    return new Point(\n        p.x * cos - p.y * sin,\n        p.x * sin + p.y * cos);\n  }\n\n  constructor(x: IPoint | number[] | number, y?: number) {\n    if (typeof(x) === 'number' && typeof(y) === 'number') {\n      this.x = x;\n      this.y = y;\n    } else if (Array.isArray(x)) {\n      this.x = x[0];\n      this.y = x[1];\n    } else if (typeof(x) === 'object') {\n      this.x = x.x;\n      this.y = x.y;\n    }\n    if (this.x === undefined || this.y === undefined) {\n      throw(new Error('invalid point'));\n    }\n  }\n\n  add(p: IPoint) { this.x += p.x; this.y += p.y; return this; };\n  sub(p: IPoint) { this.x -= p.x; this.y -= p.y; return this; };\n  mul(t: number) { this.x *= t; this.y *= t; return this; };\n\n  norm(): number { return Point.norm(this); };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/point.ts","import { Point, IPoint } from './point';\nimport { MapParams, globalMapParams } from './map-params';\nimport { TripEdge, TripEdgeProperties } from './trip-edge';\nimport { TripGraph } from './trip-graph';\nimport { TripNode, TripNodeProperties, ITripNode } from './trip-node';\nimport { TripSaved } from './trip-saved';\nimport { TripGraphLayer } from './trip-graph-layer';\nimport { PageSize, IPageSize } from './page-size';\nimport * as Tiles from './tiles';\n\nexport class SeqTrip {\n  public _tripData: TripSaved;\n\n  constructor() {\n    this.reset();\n  }\n\n  private static makePlaneIcon(verb: string, placeNode: TripNode): TripNode {\n    const iconNode = new TripNode();\n    iconNode.name = placeNode.dbid + '-' + verb,\n    iconNode.labelIcon = {\n        url: '/ng-map/assets/plane.png',\n        width: 20,\n        autorotate: (Math.PI / 2) * (verb === 'landing' ? 1 : -1),\n        ratioX: .5,\n        ratioY: (verb === 'landing' ? 0 : 1),\n    };\n    iconNode.coord = placeNode.coord;\n    iconNode.properties = {\n        point: false,\n        leaderLine: 'center',\n        dashed: [5, 3],\n        leaderLineWidth: 2,\n        maxLeaderLineLength: 2\n    };\n    return iconNode;\n  }\n\n  places(): TripNode[] {\n    return this._tripData.places;\n  }\n\n  stages(): TripEdge[] {\n    return this._tripData.stages;\n  }\n\n  setLocation(loc: Tiles.Location) { this._tripData.location = loc; }\n  location(): Tiles.Location { return this._tripData.location; }\n\n  width_mm(): number { return this._tripData.width; }\n  height_mm(): number { return this._tripData.height; }\n  pageSizeName(): string { return this._tripData.pageSizeName; }\n  world(): any {\n    if (!this._tripData.world) {\n      this._tripData.world = {};\n    }\n    return this._tripData.world;\n  }\n\n  setSize(name: string, width_mm: number, height_mm: number) {\n    this._tripData.width = width_mm;\n    this._tripData.height = height_mm;\n    this._tripData.pageSizeName = name;\n  }\n\n  defaultRadius(): number { return this._tripData.defaultRadius; }\n\n  defaultTextProp(): any {\n    if (!this._tripData.defaultTextProp) {\n      this._tripData.defaultTextProp = { };\n    }\n    return this._tripData.defaultTextProp;\n  }\n\n  defaultEdgeProp(): TripEdgeProperties {\n    if (!this._tripData.defaultEdgeProp) {\n      this._tripData.defaultEdgeProp =\n        SeqTrip.defaultTrip().defaultEdgeProp;\n    }\n    return this._tripData.defaultEdgeProp;\n  }\n\n  edgeProperty(edge: TripEdge, prop:string) {\n    return edge.properties[prop] || this._tripData.defaultEdgeProp[prop];\n  }\n\n  nodeProperty(node: TripNode, prop:string) {\n    return node.properties[prop] || this._tripData.defaultTextProp[prop];\n  }\n\n  reset() {\n    this._tripData = SeqTrip.defaultTrip();\n  }\n\n  static defaultTrip() : TripSaved {\n    const w = window as any;\n    const prefs = globalMapParams().preferences || {};\n\n    let pageSize : IPageSize = new PageSize('Full page', 128, 190);\n\n    if (prefs.default_page_size && prefs.page_sizes) {\n      for (let p of prefs.page_sizes) {\n        if (p.name == prefs.default_page_size) {\n          pageSize = p;\n          break;\n        }\n      }\n    }\n\n    return {\n      places: [],\n      stages: [],\n      additionalPlaces: [],\n      location: { x: .5, y: .5, scale: 1/8 },\n      defaultRadius: 8,\n      width: pageSize.width_mm,\n      height: pageSize.height_mm,\n      pageSizeName: pageSize.name,\n      borderColor: '#fefefe',\n      landColor: '#cecece',\n      seaColor: '#c4e3ff',\n      showRivers: false,\n      world: { },\n      defaultTextProp: Object.assign({\n          fontSize: 12,\n          font: \"'PT Sans', sans-serif\",\n          stroke: 'rgba(255,255,255,.8)',\n          fill: '#000000'\n        },\n        prefs.default_node_prop),\n      defaultEdgeProp: Object.assign({\n          lineWidth: 2,\n          lineColor: '#000000',\n          geom: prefs.line_shape || 'straight'\n        },\n        prefs.default_edge_prop),\n    };\n  }\n\n\n  setPlaces(places: TripNode[]) {\n    // we preserve the same array, in order not to invalidate references\n    this._tripData.places.splice.apply(\n        this._tripData.places,\n        ([0, this._tripData.places.length] as any[]).concat(places));\n    this.updateStages();\n    this.updateLandingsAndTakeoff();\n  }\n\n  public stagesAsDict() : { [id: string] : { [id: string] : TripEdge } } {\n    const edgeStart : { [id: string] : { [id: string] : TripEdge } } = {};\n    for (let s of this._tripData.stages) {\n      if (!(s.from in edgeStart)) {\n        edgeStart[s.from] = { };\n      }\n      edgeStart[s.from][s.to] = s;\n    }\n    return edgeStart;\n  }\n\n  public edgeFrom(name: string): TripEdge {\n    for (let s of this._tripData.stages) {\n      if (s.from == name) {\n        return s;\n      }\n    }\n  }\n\n  private updateStages() {\n    const places = this._tripData.places;\n    const numStages = places.length - 1;\n    const stages = this._tripData.stages;\n    const newStages = [];\n    const stageDict = this.stagesAsDict();\n\n    for (let i = 1; i <= numStages; ++i) {\n      const fromDbId = places[i - 1].dbid;\n      const toDbId = places[i].dbid;\n\n      if (stageDict[fromDbId] && stageDict[fromDbId][toDbId]) {\n        const existing = stageDict[fromDbId][toDbId];\n        existing.to = places[i].name;\n        existing.fromIndex = i - 1;\n        newStages.push(existing);\n      } else {\n        newStages.push(new TripEdge({\n          from: places[i - 1].name,\n          fromIndex: i - 1,\n          to: places[i].name,\n          fromDbId: fromDbId,\n          controlPoints: TripGraph.generateControlPoints(\n              (i >= 2 ? places[i - 2].coord : undefined),\n              places[i - 1].coord,\n              places[i].coord,\n              ((i + 1) < places.length ? places[i + 1].coord : undefined)\n              ),\n          properties: places[i - 1].followingEdgeProp || { }\n        }));\n      }\n    }\n    // we preserve the same array, in order not to invalidate references\n    this._tripData.stages.splice.apply(\n      this._tripData.stages,\n      [0, this._tripData.stages.length].concat(newStages));\n  }\n\n  private updateLandingsAndTakeoff() {\n    const index : { [key: string]: number } = { };\n    const additionalPlaces = this._tripData.additionalPlaces;\n\n    for (let i = 0; i < additionalPlaces.length; ++i) {\n      index[additionalPlaces[i].name] = i;\n    }\n\n    const placesToAdd : TripNode[] = [];\n    const placesToRemove: { [key: string]: boolean } = {};\n    const placesToKeep: { [key: string]: boolean } = {};\n\n    const verbs = ['landing', 'takeoff'];\n\n    for (let n of this._tripData.places) {\n      for (let verb of verbs) {\n        const name = n.dbid + '-' + verb;\n        placesToKeep[name] = true;\n        if (!n.properties.skip && n.properties[verb]) {\n          // landing/takeoff wanted\n          if (!(name in index)) {\n            placesToAdd.push(SeqTrip.makePlaneIcon(verb, n));\n          }\n        } else {\n          // landing/takeoff not wanted\n          if (name in index) {\n            placesToRemove[name] = true;\n          }\n        }\n      }\n    }\n\n    const landingTakeoffRegex = /-(landing|takeoff)$/;\n    const newPlaces =\n      additionalPlaces.filter((n : TripNode) => {\n          if (n.name in placesToRemove) {\n            return false;\n          }\n          if (n.name in placesToKeep) {\n            return true;\n          }\n          return n.name.match(landingTakeoffRegex) == null;\n        })\n      .concat(placesToAdd);\n\n    this._tripData.additionalPlaces.splice.apply(\n        this._tripData.additionalPlaces,\n        ([0, this._tripData.additionalPlaces.length] as any[]).concat(newPlaces));\n  }\n\n  nodeRadius(node: TripNode, pixelRatio: number): number {\n    let r = this._tripData.defaultRadius;\n    if (node.properties && node.properties.radius) {\n      r = node.properties.radius;\n    }\n    return r * pixelRatio;\n  };\n\n  makeGraph(tripLayer?: TripGraphLayer): TripGraph {\n    const renameDict = {};\n    const fuseNodePair = function(a, b) {\n      const r : TripNode = TripNode.parse(a);\n      r.name = a.name + ',' + b.name;\n      r.allPlaces = a.allPlaces.concat([ b ]);\n\n      const labels = a.label.split('\\n');\n      if (labels.indexOf(b.label) < 0) {\n        labels.push(b.label);\n      }\n      r.label = labels.join('\\n');\n      renameDict[a.name] = renameDict[b.name] = r.name;\n      return r;\n    };\n\n    const lookup = function(name) {\n      let r = name;\n      while (r in renameDict) {\n        r = renameDict[r];\n      }\n      return r;\n    };\n\n    for (let n of this._tripData.places) {\n      if (!n.name) {\n        throw(new Error('nodes should have names and labels'));\n      }\n    }\n\n    const keptNodes : TripNode[] = [];\n    if (tripLayer) {\n      const pinchZoom = tripLayer.renderer.pinchZoom;\n      const pixelRatio = tripLayer.renderer.pixelRatio;\n\n      for (let node of this._tripData.places) {\n        node.viewerPos = pinchZoom.viewerPosFromWorldPos(node.coord);\n      }\n\n      for (let node of this._tripData.places) {\n        if (!node.label || (node.properties && node.properties.skip)) {\n          continue;\n        }\n\n        const r = this.nodeRadius(node, pixelRatio);\n        let keep = true;\n\n        for (let i = 0; i < keptNodes.length; ++i) {\n          const n = keptNodes[i];\n          const dist = Point.dist(n.viewerPos, node.viewerPos);\n          if (dist < (this.nodeRadius(n, pixelRatio) + r)) {\n            keptNodes[i] = fuseNodePair(n, node);\n            keep = false;\n            break;\n          }\n        }\n        if (keep) {\n          if (!node.properties) {\n            node.properties = {};\n          }\n          const newNode = TripNode.parse(node);\n          newNode.place = node;\n          newNode.allPlaces = [ node ];\n          keptNodes.push(newNode);\n        }\n      }\n    } else {\n      for (let node of this._tripData.places) {\n        const newNode = TripNode.parse(node);\n        newNode.place = node;\n        newNode.allPlaces = [ node ];\n        keptNodes.push(newNode);\n      }\n    }\n\n    const places = this._tripData.places;\n    const placeIndex : { [key: string]: number } = {};\n    for (let i = 0; i < places.length; ++i) {\n      const n = places[i];\n      placeIndex[n.name] = i;\n    }\n\n    const result = new TripGraph(undefined, this._tripData.defaultEdgeProp);\n\n    for (let n of keptNodes) {\n      result.nodes[n.name] = n;\n    }\n\n    this.updateLandingsAndTakeoff();\n    for (let n of this._tripData.additionalPlaces) {\n      result.nodes[n.name] = n;\n    }\n\n    for (let edge of this._tripData.stages) {\n      if (edge.properties.hidden || (places[edge.fromIndex] && places[edge.fromIndex].isSkipped())) {\n        continue;\n      }\n      const nameFrom = lookup(edge.from);\n\n      let to = edge.fromIndex + 1;\n      if (Number.isNaN(to)) {\n        continue;\n      }\n      while (to < places.length && places[to].isSkipped()) {\n        ++to;\n      }\n      if (to >= places.length || places[to].isSkipped()) {\n        continue;\n      }\n      const nameTo = lookup(places[to].name);\n\n      if (nameFrom !== nameTo) {\n        const newEdge = TripGraphLayer.shallowCopy(edge);\n        newEdge.from = nameFrom;\n        newEdge.to = nameTo;\n        newEdge.originalEdge = edge;\n        const route = newEdge.properties.route;\n        if (route && (route.from != nameFrom || route.to != nameTo)) {\n          delete newEdge.properties.route\n        }\n        result.edges.push(newEdge);\n      }\n    }\n    return result;\n  }\n\n  save(): TripSaved { return this._tripData; }\n\n  load(data: any) {\n    if (typeof(data) == 'string') {\n      data = JSON.parse(data);\n    }\n\n    if (!data || !data.places || !data.stages) {\n      throw new Error('no data');\n    }\n\n    const newTripData = data as TripSaved;\n\n    const parseNodeArray = (places: TripNode[]) => {\n      for (let i = 0; i < places.length; ++i) {\n        places[i] = TripNode.parse(places[i]);\n      }\n    };\n\n    parseNodeArray(newTripData.places);\n    const edges = newTripData.stages;\n    for (let i = 0; i < edges.length; ++i) {\n      edges[i] = new TripEdge(edges[i]);\n    }\n\n    parseNodeArray(newTripData.additionalPlaces);\n\n    this._tripData = newTripData;\n    this.defaultEdgeProp();\n    this.setSize(data.pageSizeName, data.width, data.height);\n  };\n\n  seaColor() : string { return this._tripData.seaColor; }\n  setSeaColor(c: string) {\n    this._tripData.seaColor = c;\n  }\n  landColor() : string {\n    return this._tripData.landColor;\n  }\n  setLandColor(c: string) { this._tripData.landColor = c; }\n  borderColor() : string { return this._tripData.borderColor; }\n  setBorderColor(c: string) { this._tripData.borderColor = c; }\n  showRivers() : boolean { return this._tripData.showRivers; }\n  toggleShowRiver() { this._tripData.showRivers = !this._tripData.showRivers; }\n\n  language(): string { return this._tripData.language || 'en'; }\n  setLanguage(lang: string) { this._tripData.language = lang; }\n\n  placeByName(name: string): TripNode {\n    for (let n of this._tripData.places) {\n      if (name === n.name) {\n        return n;\n      }\n    }\n  }\n\n  markFirstLocation() {\n    // Remove firstVisited from all.\n    for (let node of this._tripData.places) {\n      if ('firstVisited' in node.properties) {\n        delete node.properties.firstVisited;\n      }\n    }\n\n    // put it back at the first visited place.\n    for (let node of this._tripData.places) {\n      if (!node.label || (node.properties && node.properties.skip)) {\n        continue;\n      }\n      node.properties.firstVisited = true;\n      return;\n    }\n  }\n\n  clearUserPlacements() {\n    for (let n of this._tripData.additionalPlaces\n         .concat(this._tripData.places)) {\n      if (n.properties) {\n        if (n.properties.userPlacement) {\n          delete n.properties.userPlacement;\n        }\n        if (n.properties.userPlacementPixelOffset) {\n          delete n.properties.userPlacementPixelOffset;\n        }\n      }\n    }\n  }\n\n  getMapStyle() {\n    return (\n      // For now, all maps follow the style in the theme.\n      // Uncomment the following line to honour per-map map style.\n      // this._tripData.mapStyle ||\n      globalMapParams().preferences.map_style\n      || 'streets');\n  }\n\n  filterAdditionalPlace(f: (node: TripNode) => boolean) {\n    const filtered = this._tripData.additionalPlaces.filter(f);\n\n    this._tripData.additionalPlaces.splice.apply(\n        this._tripData.additionalPlaces,\n        ([0, this._tripData.additionalPlaces.length] as any[]).concat(filtered));\n  }\n\n  setAdditionalPlace(node: TripNode) {\n    const places = this._tripData.additionalPlaces;\n    const existing = places.find((x) => x.name == node.name);\n    if (existing) {\n      places[places.indexOf(existing)] = node;\n    } else {\n      places.push(node);\n    }\n  }\n\n  renameNodes(name: string, oldLabel: string, newLabel: string) {\n    for (let n of this._tripData.places) {\n      if (n.name.search(name) != -1) {\n        n.label = n.label.replace(oldLabel, newLabel);\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/seq-trip.ts","import { SeqTrip } from './seq-trip';\n\ndeclare var mapJson;\n\nexport function GetSeqTrip() : SeqTrip {\n  const trip = new SeqTrip();\n  trip.load(mapJson);\n  return trip;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/some_map.ts","import {IPoint, Point} from './point';\n\nexport interface Location {\n  x: number,\n  y: number,\n  scale: number\n}\n\nexport interface CanvasTilesRendererParams {\n  url?: string;\n  initialLocation?: Location;\n  canvas: HTMLCanvasElement;\n  onLocationChange?: (renderer: CanvasTilesRenderer) => void;\n  noInteraction?: boolean;\n  clearBorder?: boolean;\n  downsampleDuringMotion?: boolean;\n  downgradeIfSlowerFPS?: number;\n  width?: number;\n  height?: number;\n  fillScreen?: boolean;\n}\n\nexport declare class CanvasTilesRenderer {\n  pixelRatio: number;\n  layers: any[];\n  pinchZoom: PinchZoom;\n  canvas: HTMLCanvasElement;\n  location: Location;\n  inDraw: boolean;\n\n  constructor (parameters: CanvasTilesRendererParams);\n\n  addLayer(l: any);\n  refresh();\n  refreshIfNotMoving();\n  draw(canvas? : HTMLCanvasElement);\n\n  setLocation(loc: Location);\n  getLocation(): Location;\n  loadImage(url: string,\n            success: (data: any) => void,\n            failure: (err: string) => void);\n}\n\nexport interface Constraint {\n  viewer: { x: number, y: number };\n  world: { x: number, y: number };\n}\n\nexport interface EventHandler {\n  handleStart(event: any);\n  handleEnd(event: any);\n  handleMove(event: any);\n  handleMouseDown(event: any);\n  handleMouseUp(event: any);\n  handleMouseWheel(event: any);\n}\n\nexport declare class PinchZoom implements EventHandler {\n  touchEventHandlers : EventHandler[];\n  maxX?: number;\n  maxY?: number;\n  ignoreLimits?: boolean;\n\n  viewerPosFromWorldPos(x : IPoint | number[] | number, y? : number) : Point;\n  worldPosFromViewerPos(x : IPoint | number[] | number, y? : number) : Point;\n  worldDistanceFromViewerDistance(dist: number): number;\n  processConstraints(constraints: Constraint[]);\n\n  locked: boolean;\n  maxScale?: number;\n\n  handleStart(event: any);\n  handleEnd(event: any);\n  handleMove(event: any);\n  handleMouseDown(event: any);\n  handleMouseUp(event: any);\n  handleMouseWheel(event: any);\n}\n\ndeclare var Utils: any;\n\nexport var T = {\n  CanvasTilesRenderer: CanvasTilesRenderer,\n  PinchZoom: PinchZoom, \n  Utils: Utils\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/tiles.ts","import { Point, IPoint } from './point';\n\nexport interface RouteData {\n  mean: string;\n  geom: IPoint[];\n  midpoint: number;\n  from: string;\n  to: string;\n};\n\nexport type LineShape = 'straight' | 'spline' | 'route';\n\nexport interface TripEdgeProperties {\n  hidden?: boolean;\n  lineColor?: string;\n  lineWidth?: number;\n  _lineWidth?: number; // used as backup when selecting an edge\n  dashed?: number[];\n  travelMean?: 'Unspecified'|'Bike'|'Boat'|'Bus'|'Car'|'Helicopter'|'Plane'|'Train'|'Walk';\n  geom?: LineShape;\n  route?: RouteData;\n}\n\nexport class TripEdge {\n  from: string;\n  to: string;\n  controlPoints: Point[];\n  drawMiddlePoint?: boolean;\n  originalEdge?: TripEdge;\n  fromDbId: number;\n  properties: TripEdgeProperties;\n  fromIndex: number; // the index in seqTrip.places().\n\n  constructor(obj?: any) {\n    this.properties = { };\n\n    if (obj) {\n      if (obj.controlPoints) {\n        this.controlPoints = [];\n        for (let i = 0; i < obj.controlPoints.length; ++i) {\n          this.controlPoints[i] = new Point(obj.controlPoints[i]);\n        }\n      }\n      if (obj.originalEdge) {\n        this.originalEdge = new TripEdge(obj.originalEdge);\n      }\n      for (let m of ['from', 'to', 'drawMiddlePoint', 'properties',\n            'fromDbId' ]) {\n        if (m in obj) {\n          this[m] = obj[m];\n        }\n      }\n\n      if (obj.properties) {\n        this.properties = obj.properties;\n\n        if (obj.properties.lineWidth) {\n          this.properties.lineWidth = parseFloat(obj.properties.lineWidth);\n        }\n\n        if (obj.properties.dashed) {\n          for (let i = 0; i < obj.properties.dashed.length; ++i) {\n            this.properties.dashed[i] = parseInt(obj.properties.dashed[i]);\n          }\n        }\n      }\n    }\n  }\n\n  propagateToOriginal() {\n    if (this.originalEdge) {\n      for (let field of ['controlPoints', 'drawMiddlePoint' ]) {\n        if (field in this) {\n          this.originalEdge[field] = this[field];\n        }\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/trip-edge.ts","import { BoundingBox } from './bounding-box';\nimport { IPoint, Point } from './point';\nimport { TripEdge } from './trip-edge';\nimport { TripGraph } from './trip-graph';\nimport { TripGraphLayer } from './trip-graph-layer';\nimport { TripNode, TripNodeProperties } from './trip-node';\nimport { T, Location, CanvasTilesRenderer, CanvasTilesRendererParams, PinchZoom } from './tiles';\n\ninterface BezierEdge {\n  edge: TripEdge;\n}\n\ndeclare var d3: any;\ndeclare var Utils: any;\n\nexport class TripGraphEditor {\n  graph: TripGraph;\n  selectedLabel: TripNode;\n  onLabelSelect: (node: TripNode) => void;\n  renderer: CanvasTilesRenderer;\n  tripLayer: TripGraphLayer;\n\n  selectedBezier: BezierEdge;\n  onBezierSelect?: (bezier: BezierEdge) => void;\n  onBezierMoved?: (bezier: BezierEdge) => void;\n  onLabelMoved?: (node: TripNode) => void;\n\n  private startWorldPos: Point;\n  private startViewerPos: Point;\n  private applyDelta: (delta: IPoint, dviewer: IPoint) => void;\n\n  constructor(renderer: CanvasTilesRenderer, graph: TripGraph, tripLayer: TripGraphLayer) {\n    this.graph = graph;\n    this.renderer = renderer;\n    this.tripLayer = tripLayer;\n  }\n\n\n  acceptTouchEvent(viewer: IPoint, world: IPoint, type: string) {\n    if (type === 'wheel') {\n      return false;\n    }\n\n    this.startWorldPos = new Point(world);\n    this.startViewerPos = new Point(viewer);\n    const clickedLabel = this.tripLayer.findLabelAtWorldPos(this.startWorldPos);\n    if (clickedLabel) {\n      this.selectLabel(clickedLabel);\n      const properties = clickedLabel.properties;\n      this.applyDelta = function(delta: IPoint, dviewer: IPoint) {\n        if (properties.labelCoord) {\n          properties.labelCoord.x += delta.x;\n          properties.labelCoord.y += delta.y;\n          properties.userPlacement = new Point(properties.labelCoord);\n        }\n        if (properties.labelPixelOffset) {\n          properties.labelPixelOffset.add(\n              Point.times(1/this.renderer.pixelRatio, dviewer));\n          properties.userPlacementPixelOffset = new Point(properties.labelPixelOffset);\n        }\n        properties.labelBbox.min.x += delta.x;\n        properties.labelBbox.min.y += delta.y;\n        properties.labelBbox.max.x += delta.x;\n        properties.labelBbox.max.y += delta.y;\n        TripGraph.placeLeaderLine(clickedLabel, this.renderer.pinchZoom,\n                                  this.renderer.pixelRatio);\n        if (this.onLabelMoved) {\n          this.onLabelMoved(clickedLabel);\n        }\n      };\n      return true;\n    } else {\n      this.deselectLabel();\n\n      const p = this.closestBezier(world);\n\n      const threshold = this.renderer.pinchZoom.worldDistanceFromViewerDistance(\n          10 * this.renderer.pixelRatio);\n\n      if (p && p.d < threshold) {\n        this.selectBezier(p);\n\n        if (!p.bezier) {\n          return true;\n        }\n\n        const me = this;\n        const pointToMove = function(ptOrArray?: Point | Point[]) {\n          me.applyDelta = function(delta: IPoint, dviewer: IPoint) {\n            if (!ptOrArray) { return; }\n            const a: Point[] =\n              (Array.isArray(ptOrArray) ? ptOrArray : [ptOrArray]);\n            for (let point of a) {\n              point.x += delta.x;\n              point.y += delta.y;\n            }\n            if (this.onBezierMoved) {\n              this.onBezierMoved(p);\n            }\n          };\n        };\n\n        const movePointWithOpposite = function(a, pivot, b) {\n          me.applyDelta = function(delta, dviewer) {\n            a.x += delta.x;\n            a.y += delta.y;\n            pivot.x += delta.x / 2;\n            pivot.y += delta.y / 2;\n          };\n        };\n\n        if (p.edge.controlPoints.length === 2) {\n          pointToMove(p.edge.controlPoints[p.t < .5 ? 0 : 1]);\n        } else if (p.edge.controlPoints.length === 5) {\n          if (p.bezier.points[1].x === p.edge.controlPoints[0].x\n              && p.bezier.points[1].y === p.edge.controlPoints[0].y) {\n            if (p.t < .5) {\n              pointToMove(p.edge.controlPoints[0]);\n            } else if (p.t < .9) {\n              movePointWithOpposite(p.edge.controlPoints[1],\n                                    p.edge.controlPoints[2],\n                                    p.edge.controlPoints[3]);\n            } else {\n              pointToMove([p.edge.controlPoints[1],\n                          p.edge.controlPoints[2],\n                          p.edge.controlPoints[3]]);\n            }\n          } else {\n            if (p.t < .1) {\n              pointToMove([p.edge.controlPoints[1],\n                          p.edge.controlPoints[2],\n                          p.edge.controlPoints[3]]);\n            } else if (p.t < .5) {\n              movePointWithOpposite(p.edge.controlPoints[3],\n                                    p.edge.controlPoints[2],\n                                    p.edge.controlPoints[1]);\n            } else {\n              pointToMove(p.edge.controlPoints[4]);\n            }\n          }\n        } else {\n          pointToMove(Point.nearest(world, p.edge.controlPoints));\n        }\n        return true;\n      } else {\n        this.selectBezier();\n      }\n    }\n\n    this.applyDelta = undefined;\n    return false;\n  };\n\n  selectLabel(label?: TripNode) {\n    if (this.selectedLabel) {\n      delete this.selectedLabel.properties.frame;\n    }\n    this.selectedLabel = undefined;\n    this.selectBezier();\n    this.selectedLabel = label;\n    if (this.onLabelSelect) {\n      this.onLabelSelect(label);\n    }\n    if (label) {\n      label.properties = label.properties || {};\n      label.properties.frame = '#000000';\n    }\n    this.renderer.refreshIfNotMoving();\n  };\n\n  deselectLabel() { return this.selectLabel(); };\n\n  handleMouseDown(event: any) {\n    event.preventDefault();\n  }\n\n  handleMouseMove(event: any) {\n    event.preventDefault();\n    const viewerPos = Utils.eventPosInElementCoordinates(\n        event, event.target || event.srcElement);\n    this.handleMotion(viewerPos);\n  }\n\n  handleMotion(viewerPos: Point) {\n    if (!this.applyDelta) {\n      return;\n    }\n\n    const worldPos = this.renderer.pinchZoom.worldPosFromViewerPos(\n        viewerPos.x, viewerPos.y);\n\n    const deltaWorld = Point.minus(worldPos, this.startWorldPos);\n    this.startWorldPos = worldPos;\n\n    const deltaViewer = Point.minus(viewerPos, this.startViewerPos);\n    this.startViewerPos = new Point(viewerPos);\n\n    this.applyDelta(deltaWorld, deltaViewer);\n    this.renderer.refreshIfNotMoving();\n  }\n\n  handleMouseUp(event: any) {\n    event.preventDefault();\n    this.applyDelta = undefined;\n  }\n\n  handleMouseWheel(event: any) {\n    event.preventDefault();\n  }\n\n  handleStart(event: any) {\n    event.preventDefault();\n  }\n\n  handleEnd(event: any) {\n    event.preventDefault();\n    this.applyDelta = undefined;\n  }\n\n  handleMove(event: any) {\n    event.preventDefault();\n    if (event.touches.length !== 1) {\n      this.applyDelta = undefined;\n      return;\n    }\n\n    const viewerPos = Utils.eventPosInElementCoordinates(\n        event.touches[0], event.target || event.srcElement);\n    this.handleMotion(viewerPos);\n  }\n\n  edgeProperty(edge: TripEdge, prop: string) {\n    return this.graph.edgeProperty(edge, prop);\n  }\n\n  closestBezier(p) {\n    let nearest;\n    for (let e of this.graph.edges) {\n      const route = this.graph.getEdgeRoute(e);\n      if (route) {\n        for (let routePoint of route.geom) {\n          const dist = Point.dist(p, routePoint);\n          if (!nearest || dist < nearest.d) {\n            nearest = {\n              d: dist,\n              edge: e,\n              bezier: undefined\n            };\n          }\n        }\n      } else {\n        const curves = this.graph.bezier(e);\n        for (let b of curves) {\n          const candidate = b.project(p);\n          if (!nearest || candidate.d < nearest.d) {\n            nearest = candidate;\n            nearest.edge = e;\n            nearest.bezier = b;\n          }\n        }\n      }\n    }\n    return nearest;\n  }\n\n  selectBezier(b?: BezierEdge) {\n    if (this.selectedBezier) {\n      const edge = this.selectedBezier.edge;\n      delete edge.drawMiddlePoint;\n      if (edge.properties._lineWidth !== undefined) {\n        edge.properties.lineWidth = edge.properties._lineWidth;\n        delete edge.properties._lineWidth;\n      } else {\n        delete edge.properties.lineWidth;\n      }\n    }\n    this.selectedBezier = b;\n\n    if (b) {\n      const edge = b.edge;\n      edge.drawMiddlePoint = true;\n      if (edge.properties.lineWidth !== undefined) {\n        edge.properties._lineWidth = edge.properties.lineWidth;\n      }\n      edge.properties.lineWidth = 5;\n    }\n    if (this.selectedLabel) {\n      this.deselectLabel();\n    }\n\n    if (this.onBezierSelect) {\n      this.onBezierSelect(this.selectedBezier);\n    }\n    this.renderer.refreshIfNotMoving();\n  }\n\n  /*\n  splitCurve() {\n    if (!this.selectedBezier) {\n      return;\n    }\n\n    const edge = this.selectedBezier.edge;\n\n    this.graph.splitEdge(edge);\n  }\n  */\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/trip-graph-editor.ts","import { TripGraph } from './trip-graph';\nimport { TripEdge, TripEdgeProperties } from './trip-edge';\nimport { TripNode, TripNodeProperties } from './trip-node';\nimport { BoundingBox } from './bounding-box';\nimport { Size2D } from './size2d';\nimport { TripSaved } from './trip-saved';\nimport { Point, IPoint } from './point';\nimport { T, Location, CanvasTilesRenderer, CanvasTilesRendererParams, PinchZoom } from './tiles';\n\ndeclare const d3: any;\ndeclare const Bezier: any;\n\nexport interface TripGraphLayerParams {\n  renderer: CanvasTilesRenderer;\n  graph: TripGraph;\n  defaultRadius?: number;\n  defaultFontSize?: number;\n  defaultEdgeProp?: TripEdgeProperties;\n  hideLabels?: boolean;\n  hideNodePoints?: boolean;\n};\n\nexport class TripGraphLayer {\n  public graph: TripGraph;\n  public defaultTextProp: TripNodeProperties;\n  public defaultEdgeProp: TripEdgeProperties;\n\n  public renderer: CanvasTilesRenderer;\n  public defaultRadius: number;\n  private icons: any;\n\n  private iconsToLoad: number;\n  private failedIcons: number;\n  public hideLabels: boolean;\n  public hideNodePoints: boolean;\n  public forceLeaderLines: boolean;\n\n  public markedPlaces: IPoint[];\n\n  private missingData: number;\n\n  constructor(private params: TripGraphLayerParams) {\n    this.markedPlaces = [];\n    this.renderer = params.renderer;\n    this.defaultRadius = params.defaultRadius || 6;\n    this.icons = {};\n    this.defaultTextProp = {\n      fontSize: params.defaultFontSize || 20,\n      stroke: 'rgba(255,255,255,.8)',\n      fill: '#000000'\n    };\n    this.defaultEdgeProp =\n      params.defaultEdgeProp || { lineWidth: 1, lineColor: '#000000' };\n    this.hideLabels = !!params.hideLabels;\n    this.hideNodePoints = !!params.hideNodePoints;\n\n    if (!this.renderer) {\n      throw(new Error('TripGraphLayer: no renderer !'));\n    }\n    this.graph = params.graph || new TripGraph(undefined, this.defaultEdgeProp);\n    this.missingData = 1;\n  }\n\n  isReady() : boolean {\n    return this.missingData == 0;\n  }\n\n  draw(canvas: HTMLCanvasElement, pinchZoom: any, bboxTopLeft: any, bboxBottomRight: any) {\n    const graph = this.graph;\n    const context = canvas.getContext('2d');\n    const pixelRatio = this.renderer.pixelRatio;\n\n    this.markedPlaces = [];\n    this.missingData = 0;\n\n    for (let e of graph.edges) {\n      this.drawEdge(context, pinchZoom, e, pixelRatio, 'curve');\n    }\n    for (let e of graph.edges) {\n      this.drawEdge(context, pinchZoom, e, pixelRatio, 'mark');\n    }\n\n    context.setLineDash([]);\n\n    for (let i in graph.nodes) {\n      const node = graph.nodes[i];\n      node.convertToPixelOffset(pinchZoom, pixelRatio);\n      node.viewerPos = pinchZoom.viewerPosFromWorldPos(node.coord);\n    }\n\n    if (!this.hideNodePoints) {\n      for (let i in graph.nodes) {\n        const node = graph.nodes[i];\n        this.drawNodePoint(context, pinchZoom, node);\n      }\n    }\n\n    for (let i in graph.nodes) {\n      if (this.forceLeaderLines ||\n          !this.hideLabels || i.match(/-(takeoff)|(landing)$/)) {\n        const node = graph.nodes[i];\n        this.drawLeaderLine(context, pinchZoom, node);\n      }\n    }\n    for (let i in graph.nodes) {\n      if (!this.hideLabels || i.match(/-(takeoff)|(landing)$/)) {\n        const node = graph.nodes[i];\n        this.drawNodeLabel(context, pinchZoom, node);\n      }\n    }\n\n    this.markedPlaces = this.markedPlaces.map(\n        (x) => pinchZoom.worldPosFromViewerPos(x));\n\n    this.fillClicMap(canvas, pinchZoom);\n  }\n\n  drawEdge(context: CanvasRenderingContext2D, pinchZoom: any,\n           edge: TripEdge, pixelRatio: number, restrict: string) {\n    this.setEdgeStrokeStyle(context, edge);\n\n    if (this.edgeProperty(edge, 'geom') == 'route') {\n      this.drawRoad(context, pinchZoom, edge, pixelRatio, restrict);\n    } else {\n      this.drawEdgeBezier(context, pinchZoom, edge, pixelRatio, restrict);\n    }\n  }\n\n  drawRoad(context, pinchZoom, edge, pixelRatio, restrict) {\n    const mean = this.edgeProperty(edge, 'travelMean');\n    const route = this.graph.getEdgeRoute(edge);\n    if (restrict == 'curve') {\n      if (route) {\n        const road = edge.properties.route.geom;\n        context.beginPath();\n        const first = pinchZoom.viewerPosFromWorldPos(road[0]);\n        context.moveTo(first.x, first.y);\n        for (let i = 1; i < road.length; ++i) {\n          const p = pinchZoom.viewerPosFromWorldPos(road[i]);\n          context.lineTo(p.x, p.y);\n        }\n        context.stroke();\n      } else {\n        // no road yet, let's try to get one.\n        this.missingData += 1;\n        if (!edge.properties) {\n          edge.properties = { };\n        }\n        this.graph.getEdgeDirections(edge, this.edgeProperty(edge, 'travelMean'))\n          .then((data) => { edge.properties.route = data; this.renderer.refresh(); })\n          .catch((err) => {\n            // We can't get a curve!\n            console.log(err);\n            // Let's replace it by a straight line.\n            edge.properties.geom = 'straight';\n            this.renderer.refresh();\n          });\n      }\n    } else if (restrict == 'mark') {\n      if (route && route.midpoint) {\n        const first = new Point(pinchZoom.viewerPosFromWorldPos(route.geom[0]));\n        const last = new Point(pinchZoom.viewerPosFromWorldPos(route.geom[route.geom.length - 1]));\n        if (Point.dist(last, first) > 80 * pixelRatio) {\n          const mid = route.midpoint;\n          // Search for the intersection between the route starting at 'mid'\n          // and a circle of radius 16 * pixelRatio (see drawEdgeMarkIcon).\n          const circleRadius = 16 * pixelRatio;\n          const midInView = new Point(pinchZoom.viewerPosFromWorldPos(route.geom[mid]));\n          let tangent;\n          for (let i = mid; i < route.geom.length; ++i) {\n            const currentPoint = new Point(pinchZoom.viewerPosFromWorldPos(route.geom[i]));\n            const dist = Point.dist(midInView, currentPoint);\n            if (dist > circleRadius) {\n              tangent = Point.minus(currentPoint, midInView);\n              break;\n            }\n          }\n          if (!tangent) {\n            return;\n          }\n\n          const n = new Point(tangent.y, -tangent.x);\n          this.drawEdgeMark(\n              // we want to place the icon center right on the curve, which is\n              // not the default for splines.\n              Point.plus(midInView, Point.times(8 * pixelRatio / tangent.norm(), tangent)),\n              n, tangent, context, pixelRatio, edge, restrict);\n        }\n      }\n    }\n  }\n\n  drawEdgeBezier(context: CanvasRenderingContext2D, pinchZoom: any,\n                 edge: TripEdge, pixelRatio: number, restrict: string) {\n    const bezierCurves = this.graph.bezier(edge);\n    for (let bezier of bezierCurves ) {\n      this.drawBezier(context, pinchZoom, bezier, pixelRatio, edge, restrict);\n    }\n    if (restrict != 'mark') {\n      if (bezierCurves.length > 1 && edge.drawMiddlePoint) {\n        for (let i in bezierCurves) {\n          const p = pinchZoom.viewerPosFromWorldPos(bezierCurves[i].points[3]);\n          const radius = 5 * pixelRatio;\n          context.beginPath();\n          context.arc(p.x, p.y, radius, 0, 2 * Math.PI, false);\n          context.fillStyle = '#000000';\n          context.fill();\n        }\n      }\n    }\n  }\n\n  drawBezier(context: CanvasRenderingContext2D, pinchZoom: any,\n                    curve: any, pixelRatio: number,\n                    edge: TripEdge, restrict?: string) {\n    context.save();\n\n    const ptArray = new Array(8);\n    const points = curve.points;\n    for (let j = 0; j < 4; ++j) {\n      const p = pinchZoom.viewerPosFromWorldPos(points[j]);\n      ptArray[j * 2] = p.x;\n      ptArray[j * 2 + 1] = p.y;\n    }\n\n    const bezier = new Bezier(ptArray);\n    const l = bezier.length();\n    const numArrows = Math.min(2, Math.floor(l / (pixelRatio * 40)));\n\n    const viewcurve = bezier.points;\n\n    if (restrict != 'mark') {\n      context.beginPath();\n      context.moveTo(viewcurve[0].x, viewcurve[0].y);\n      context.bezierCurveTo(\n          viewcurve[1].x, viewcurve[1].y,\n          viewcurve[2].x, viewcurve[2].y,\n          viewcurve[3].x, viewcurve[3].y);\n\n      context.stroke();\n    }\n\n    for (let i = 1; i < numArrows; ++i) {\n      const t = i / numArrows;\n      let p = new Point(bezier.get(t));\n      const n = new Point(bezier.normal(t));\n      const tangent = new Point(bezier.derivative(t));\n\n      this.drawEdgeMark(p, n, tangent, context, pixelRatio, edge, restrict);\n    }\n    context.restore();\n  }\n\n  drawEdgeMark(p: Point, n: Point, tangent: Point,\n               context: CanvasRenderingContext2D, pixelRatio: number,\n               edge: TripEdge, restrict: string) {\n    const mean = this.edgeProperty(edge, 'travelMean');\n    switch(mean) {\n      case 'Bike':\n      case 'Boat':\n      case 'Bus':\n      case 'Car':\n      case 'Helicopter':\n      case 'Plane':\n      case 'Train':\n      case 'Walk':\n        if (restrict != 'curve') {\n          this.drawEdgeMarkIcon(p, n, tangent, context, pixelRatio, edge);\n        }\n        break;\n      case 'Unspecified':\n      default:\n        if (restrict != 'mark') {\n          TripGraphLayer.drawEdgeMarkTriangle(p, n, tangent, context, pixelRatio);\n        }\n    }\n  }\n\n  static drawEdgeMarkTriangle(p: Point, n: Point, tangent: Point,\n                      context: CanvasRenderingContext2D, pixelRatio: number) {\n    const size = 10 * pixelRatio;\n    tangent.mul(size / tangent.norm());\n    p = Point.plus(p, Point.times(.5, tangent));\n    const base = Point.minus(p, tangent);\n\n    context.beginPath();\n    context.moveTo(base.x + (size / 2) * n.x, base.y + (size / 2) * n.y);\n    context.lineTo(p.x, p.y);\n    context.lineTo(base.x - (size / 2) * n.x, base.y - (size / 2) * n.y);\n    context.closePath();\n    context.fill();\n  }\n\n  drawEdgeMarkIcon(p: Point, n: Point, tangent: Point,\n                   context: CanvasRenderingContext2D, pixelRatio: number,\n                   edge: TripEdge) {\n    context.fillStyle = '#fff';\n    context.setLineDash([]);\n    context.lineWidth = 1 * pixelRatio;\n\n    const radius = 10 * pixelRatio;\n    const arrowLength = 6 * pixelRatio;\n\n    tangent = tangent.mul(1 / tangent.norm());\n    const head = Point.plus(p, Point.times((radius + arrowLength) / 2, tangent));\n    const center = Point.minus(p, Point.times((radius + arrowLength) / 2, tangent));\n    const circleBase = Point.plus(center, Point.times(radius, tangent));\n    const delta = (new Point(-tangent.y, tangent.x)).mul(4 * pixelRatio);\n    const circleStart = Point.plus(circleBase, delta);\n    const circleEnd = Point.minus(circleBase, delta);\n\n    const p1 = Point.minus(circleStart, center);\n    const angle1 = Math.atan2(p1.y, p1.x);\n    const p2 = Point.minus(circleEnd, center);\n    const angle2 = Math.atan2(p2.y, p2.x);\n\n    context.beginPath();\n    context.arc(center.x, center.y, radius, angle1, angle2);\n    context.lineTo(head.x, head.y);\n    context.closePath();\n    context.fill();\n    context.stroke();\n\n    context.fillStyle = '#000';\n    context.textAlign = 'center';\n    context.textBaseline=\"middle\"; \n    context.font = Math.round(pixelRatio * 10) + \"px FontAwesome\";\n\n    const icons = {\n      'Bike': \"\\uf206\",\n      'Boat': \"\\uf21a\",\n      'Bus': \"\\uf207\",\n      'Car': \"\\uf1b9\",\n      'Helicopter': 'H',\n      'Plane': \"\\uf072\",\n      'Train': \"\\uf238\",\n      'Walk': \"\\uf183\"\n    }\n\n    const mean = this.edgeProperty(edge, 'travelMean');\n    if (mean == 'Plane') {\n      context.save();\n      context.translate(center.x, center.y);\n      context.rotate(Math.PI / 4 + Math.atan2(tangent.y, tangent.x));\n      context.translate(-center.x, -center.y);\n    }\n\n    context.fillText(icons[mean], center.x, center.y);\n    this.markedPlaces.push(center);\n\n    if (mean == 'Plane') {\n      context.restore();\n    }\n  }\n\n  edgeProperty(edge: TripEdge, prop: string) {\n    return edge.properties[prop] || this.defaultEdgeProp[prop];\n  }\n\n  setEdgeStrokeStyle(context: CanvasRenderingContext2D, edge: TripEdge) {\n    let style = this.edgeProperty(edge, 'lineColor');\n    context.strokeStyle = style;\n    context.fillStyle = style;\n    context.lineWidth = this.renderer.pixelRatio * (\n        this.edgeProperty(edge, 'lineWidth'));\n    this.setDashStyle(context, this.edgeProperty(edge, 'dashed'));\n  };\n\n  nodeRadius(node: TripNode): number {\n    let r = this.defaultRadius;\n    if (node.properties && node.properties.radius) {\n      r = node.properties.radius;\n    }\n    return r * this.renderer.pixelRatio;\n  };\n\n  drawNodePoint(context: CanvasRenderingContext2D, pinchZoom: any, node: TripNode) {\n    if (node.properties && node.properties.point == false) {\n      return;\n    }\n    let pos = node.viewerPos;\n    this.drawPoint(context, pos, this.renderer.pixelRatio, node.properties || {});\n  }\n\n  drawNodeLabel(context: CanvasRenderingContext2D, pinchZoom: any, node: TripNode) {\n    if (node.label || node.labelIcon) {\n      let pos = node.labelPixelPos(pinchZoom, this.renderer.pixelRatio);\n      if (node.label) {\n        TripGraphLayer.drawText(context, node.label, pos,\n                 this.renderer.pixelRatio, node.properties || {},\n                 this.defaultTextProp);\n      }\n      if (node.labelIcon) {\n        const icon = this.getIcon(node.labelIcon.url);\n        if(icon) {\n          if (node.labelIcon.autorotate != undefined) {\n            let coord = pinchZoom.viewerPosFromWorldPos(node.coord);\n            node.labelIcon.angle = node.labelIcon.autorotate + Math.atan2(\n                coord.y - pos.y,\n                coord.x - pos.x);\n          }\n          this.drawIcon(context, icon, node.labelIcon,\n                        pos, this.renderer.pixelRatio);\n        } else {\n          this.missingData++;\n          this.loadIcons(() => this.renderer.refresh());\n        }\n      }\n      if (node.properties && node.properties.frame && node.label) {\n        let size = TripGraphLayer.measureText(\n            context, node.label,\n            this.renderer.pixelRatio, node.properties || {},\n            this.defaultTextProp);\n        context.strokeStyle = node.properties.frame;\n        size.width += 3 * this.renderer.pixelRatio;\n        size.height += 3 * this.renderer.pixelRatio;\n        context.rect(pos.x - size.width / 2,\n                     pos.y - size.height / 2,\n                     size.width, size.height);\n        context.stroke();\n      }\n    }\n  }\n\n  setDashStyle(context: CanvasRenderingContext2D, dashed?: number[]) {\n    let scaled = [];\n    if (dashed) {\n      for (let entry of dashed) {\n        scaled.push(this.renderer.pixelRatio * entry);\n      }\n    }\n\n    context.setLineDash(scaled);\n  }\n\n  drawLeaderLine(context: CanvasRenderingContext2D, pinchZoom: any, node: TripNode) {\n    if (!node.properties) {\n      return;\n    }\n    const prop = node.properties;\n    if (prop.leaderLineAnchor || prop.leaderLineAnchorPixelOffset) {\n      let pixelRatio = this.renderer.pixelRatio;\n      let p = node.leaderLineAnchorPos(pinchZoom, pixelRatio);\n      context.lineWidth = (node.properties.leaderLineWidth || 1) * pixelRatio;\n      context.beginPath();\n\n      let pos = pinchZoom.viewerPosFromWorldPos(node.coord);\n      let radius = this.nodeRadius(node);\n\n      const maxLength =\n        (node.properties\n         && node.properties.maxLeaderLineLength !== undefined\n         ? node.properties.maxLeaderLineLength * pixelRatio : 3 * radius); \n\n      if (Point.dist(p, pos) > maxLength) {\n        if (node.properties.dashed) {\n          this.setDashStyle(context, node.properties.dashed);\n        }\n\n        context.moveTo(p.x, p.y);\n        context.lineTo(pos.x, pos.y);\n        context.strokeStyle = node.properties.leaderLineColor || '#000000';\n        context.stroke();\n        if (node.properties.dashed) {\n          context.setLineDash([]);\n        }\n      }\n    }\n  };\n\n  drawPoint(context: CanvasRenderingContext2D, p: IPoint,\n            pixelRatio: number, properties: TripNodeProperties) {\n      context.strokeStyle = \"rgba(0,0,0,1)\";\n      context.fillStyle = \"rgba(255,255,255,1)\";\n      context.lineWidth = 2 * pixelRatio;\n      context.beginPath();\n      const radius = (properties.radius || this.defaultRadius) * pixelRatio;\n      context.arc(p.x, p.y, radius, 0, 2 * Math.PI, false);\n      context.stroke();\n      context.fill();\n\n      let style = properties.markStyle;\n      if (!style && properties.firstVisited) {\n        style = 'first';\n      }\n      if (style === 'first') {\n        context.fillStyle = \"rgba(0, 0, 0, 1)\";\n        context.beginPath();\n        context.arc(p.x, p.y, radius * .6, 0, 2 * Math.PI, false);\n        context.fill();\n      }\n  };\n\n  static measureText(context: CanvasRenderingContext2D, text: string,\n                     pixelRatio: number, properties: TripNodeProperties,\n                     defaultTextProp: TripNodeProperties) {\n    let lines = text.split('\\n');\n    let size = TripGraphLayer.setTextStyle(\n        context, pixelRatio, properties, defaultTextProp);\n\n    // Because we can't measure text exactly in mapbox gl js, we add a margin.\n    // It is no big deal to overestimate width.\n    const expandFactor = 1.1;\n\n    let r = { width: 0, height: size * lines.length * expandFactor };\n\n    for (let i in lines) {\n      r.width = Math.max(r.width, expandFactor * context.measureText(lines[i]).width);\n    }\n\n    return r;\n  }\n\n  static setTextStyle(context: CanvasRenderingContext2D, pixelRatio: number,\n                     properties: TripNodeProperties,\n                     defaultTextProp: TripNodeProperties): number {\n    properties = properties || {};\n    let fontSize = properties.fontSize || defaultTextProp.fontSize;\n    fontSize *= pixelRatio;\n    context.font = fontSize + 'px ' + (properties.font || \"'PT Sans', sans-serif\");\n    context.strokeStyle = properties.stroke || defaultTextProp.stroke ;\n    context.lineWidth = (properties.haloWidth || 4) * pixelRatio;\n    context.fillStyle = properties.fill || defaultTextProp.fill;\n    return parseInt(''+ fontSize);\n  };\n\n  static drawText(context: CanvasRenderingContext2D, text: string,\n                  pos: IPoint, pixelRatio: number,\n                  properties: TripNodeProperties,\n                  defaultTextProp: TripNodeProperties) {\n    let offset = (properties.textOffset != undefined ? properties.textOffset: 20)\n      * pixelRatio;\n\n    let dx, dy;\n    let placement = ((properties.textPlacement || 'S') + '').toUpperCase();\n\n    // horizontal settings\n    switch (placement) {\n      default:\n      case 'C':\n      case 'N':\n      case 'S':\n        context.textAlign = 'center';\n        dx = 0;\n        break;\n\n      case 'E':\n      case 'NE':\n        context.textAlign = 'start';\n        dx = offset;\n        break;\n\n      case 'O':\n      case 'W':\n        context.textAlign = 'end';\n        dx = -offset;\n        break;\n    }\n\n    // vertical settings\n    switch (placement) {\n      case 'C':\n      case 'E':\n      case 'W':\n      case 'O':\n        context.textBaseline = 'middle';\n        dy = 0;\n        break;\n\n      case 'N':\n      case 'NE':\n        context.textBaseline = 'bottom';\n        dy = -offset;\n        break;\n\n      default:\n      case 'S':\n        context.textBaseline = 'top';\n        dy = offset;\n        break;\n    }\n    let x: number = pos.x + dx;\n    let y: number = pos.y + dy;\n\n    let h: number = TripGraphLayer.setTextStyle(\n        context, pixelRatio, properties, defaultTextProp);\n\n    let lines = text.split('\\n');\n\n    context.shadowBlur = 3 * pixelRatio;\n    context.shadowColor = '#ffffff';\n\n    context.lineWidth = 2 * pixelRatio;\n\n    let vshift: number = (lines.length - 1) / 2;\n    for (let i = 0 ; i < lines.length; ++i) {\n      let line_y: number = y + (i - vshift) * h;\n      context.strokeText(lines[i], x, line_y);\n      context.fillText(lines[i], x, line_y);\n    }\n\n    context.shadowColor = 'transparent';\n  }\n\n  drawIcon(context:CanvasRenderingContext2D, iconData: any, icon: any,\n           pos: IPoint, pixelRatio:number) {\n    if (!iconData) {\n      return;\n    }\n    let width = (icon.width ? icon.width * pixelRatio: 16 * pixelRatio);\n    let height = (icon.height ? icon.height * pixelRatio: width);\n    let ratioX = 'ratioX' in icon ? icon.ratioX : .5;\n    let ratioY = 'ratioY' in icon ? icon.ratioY : .5;\n    let dx = width * ratioX;\n    let dy = height * ratioY;\n    if (icon.angle) {\n      context.save();\n      context.translate(pos.x, pos.y);\n      context.rotate(icon.angle);\n      context.drawImage(iconData, -dx, -dy, width, height);\n      context.restore();\n\n      this.markedPlaces.push(Point.plus(pos, Point.rotate(\n                  new Point(width/2 - dx, height/2 - dy), icon.angle)));\n    } else {\n      context.drawImage(iconData, pos.x - dx, pos.y - dy, width, height);\n      this.markedPlaces.push({\n        x: pos.x - dx + width / 2,\n        y: pos.y - dy + height / 2\n      });\n    }\n  }\n\n  getLabelIconSize(context: CanvasRenderingContext2D, node: TripNode): Size2D {\n    let pixelRatio = this.renderer.pixelRatio;\n    let labelIcon = node.labelIcon;\n\n    return {\n      width: (labelIcon.width || 16) * pixelRatio,\n      height: (labelIcon.height || labelIcon.width || 16) * pixelRatio,\n    };\n  };\n\n  computeNodeSizeWithMargin(context: CanvasRenderingContext2D, node: TripNode): Size2D {\n    let result;\n    if (node.label) {\n      let pixelRatio = this.renderer.pixelRatio;\n      result = TripGraphLayer.measureText(context, node.label, pixelRatio,\n                                        node.properties, this.defaultTextProp);\n    } else if (node.labelIcon) {\n      result = this.getLabelIconSize(context, node);\n      result.width *= 1.4;\n      result.height *= 1.4;\n    }\n    if (!result) {\n      throw('no label and no labIcon for node');\n    }\n    const margin = 2 * this.renderer.pixelRatio;\n    result.width += 2 * margin;\n    result.height += 2 * margin;\n    return result;\n  }\n\n  setLabelBbox(node: TripNode, context?: CanvasRenderingContext2D,\n               entry?: {x: number, y: number, width: number, height: number}) {\n    if(!node\n       || (!node.label && !node.labelIcon)\n       || !node.properties\n       || (!node.properties.labelCoord && !node.properties.labelPixelOffset)) {\n      return;\n    }\n\n    if (!context) {\n      context = this.renderer.canvas.getContext('2d');\n    }\n\n    const pinchZoom = this.renderer.pinchZoom;\n    if (!entry) {\n      const size = this.computeNodeSizeWithMargin(context, node);\n      const pos = node.labelPixelPos(pinchZoom, this.renderer.pixelRatio);\n      entry = {\n        x: pos.x,\n        y: pos.y,\n        width: size.width,\n        height: size.height\n      };\n    }\n\n    let properties = node.properties;\n    let halfSize = Point.times(1/2, new Point(entry.width, entry.height));\n    properties.labelBbox = new BoundingBox({\n      min: pinchZoom.worldPosFromViewerPos(Point.minus(entry, halfSize)),\n      max: pinchZoom.worldPosFromViewerPos(Point.plus(entry, halfSize))\n    });\n  }\n\n  nodeName(node: TripNode) {\n    if (node.label) {\n      return node.label;\n    } else if (node.labelIcon) {\n      return 'icon:' + node.labelIcon.url;\n    }\n    throw('no label and no labIcon for node');\n  }\n\n\n  // Modify TripGraph to place labels at appropriate places\n  placeLabels(context: CanvasRenderingContext2D, preferLastPosition: boolean) {\n    let pinchZoom = this.renderer.pinchZoom;\n    let pixelRatio = this.renderer.pixelRatio;\n    let labelArray = [];\n    let anchorArray = [];\n    for (let i in this.graph.nodes) {\n      let node = this.graph.nodes[i];\n      if (!node.label && !node.labelIcon) {\n        continue;\n      }\n      let pos = pinchZoom.viewerPosFromWorldPos(node.coord);\n      let radius = this.defaultRadius;\n      if (node.properties && node.properties.radius) {\n        radius = node.properties.radius;\n      }\n      anchorArray.push({\n        x: pos.x,\n        y: pos.y,\n        r: (node.properties.point !== false ? radius * pixelRatio : -1)\n      });\n      let size = this.computeNodeSizeWithMargin(context, node);\n      let name = this.nodeName(node);\n\n      let initialPos = pos;\n      if (node.properties.point === false) {\n        initialPos.x -= size.width / 2;\n        initialPos.y -= size.height / 2;\n      }\n\n      let userPlacement = undefined;\n      if (preferLastPosition) {\n        userPlacement = initialPos;\n      }\n      if (node.properties && node.properties.userPlacement) {\n        userPlacement = initialPos = pinchZoom.viewerPosFromWorldPos(\n            node.properties.userPlacement);\n      }\n      if (node.properties && node.properties.userPlacementPixelOffset) {\n        userPlacement = initialPos =\n          Point.plus(pos, Point.times(pixelRatio, node.properties.userPlacementPixelOffset));\n      }\n\n      const newLabel = {\n        x: initialPos.x,\n        y: initialPos.y,\n        name: name,\n        width: size.width,\n        height: size.height,\n        node: node,\n        userPlacement: userPlacement\n      };\n\n      labelArray.push(newLabel);\n    }\n    let labeler = d3.labeler()\n      .label(labelArray)\n      .anchor(anchorArray)\n      .width(this.renderer.canvas.width)\n      .height(this.renderer.canvas.height);\n\n    let originalEnergy = labeler.alt_energy();\n    let me = this;\n    let bezierBbox = [];\n    let bezierLUT = [];\n    for (let e in this.graph.edges) {\n      const route = this.graph.getEdgeRoute(this.graph.edges[e]);\n      if (route) {\n        let points = [];\n        for (let p of route.geom) {\n          const pViewer = pinchZoom.viewerPosFromWorldPos(p);\n          if (points.length == 0 || \n              Point.dist(points[points.length - 1], pViewer) > 4 * pixelRatio) {\n            points.push(pViewer);\n          }\n        }\n        const bbox = new BoundingBox();\n        bbox.addArray(points);\n\n        bezierBbox.push(bbox);\n        bezierLUT.push(points);\n      } else {\n        // Bezier or straight cases\n        let curves = this.graph.bezier(this.graph.edges[e]);\n        for (let i in curves) {\n          let curve = curves[i];\n          let bbox = curve.bbox();\n          bezierBbox.push({\n            min: pinchZoom.viewerPosFromWorldPos(bbox.x.min, bbox.y.min),\n            max: pinchZoom.viewerPosFromWorldPos(bbox.x.max, bbox.y.max)\n          });\n          let lut = curve.getLUT(30);\n          let transformedLut = [];\n          for (let i in lut) {\n            transformedLut.push(pinchZoom.viewerPosFromWorldPos(lut[i]));\n          }\n          bezierLUT.push(transformedLut);\n        }\n      }\n    }\n\n    labeler.alt_energy(function(index, lab, anc) {\n      let curveOverlaps = 0;\n\n      let box = labeler.boxOfLabel(index);\n      let labBbox = new BoundingBox();\n      labBbox.addPoint(new Point(box.left, box.top));\n      labBbox.addPoint(new Point(box.right, box.bottom));\n\n      for (let i in bezierBbox) {\n        if (!BoundingBox.overlaps(bezierBbox[i], labBbox)) {\n          continue;\n        }\n\n        let lut = bezierLUT[i];\n        for (let j in lut) {\n          if (labBbox.contains(lut[j])) {\n            curveOverlaps++;\n          }\n        }\n      }\n      let energy = curveOverlaps * 10 + originalEnergy(index);\n\n      const userPlacement = labelArray[index].userPlacement;\n      if (userPlacement) {\n        const userPrefEnergy = Point.dist(userPlacement, labelArray[index]);\n        energy += userPrefEnergy;\n      }\n\n      return energy;\n    });\n\n    let finalEnergy = labeler.start(5000, 1);\n\n    for (let i in labelArray) {\n      let entry = labelArray[i];\n      if (!entry.node.properties) {\n        entry.node.properties = {};\n      }\n      const properties = entry.node.properties;\n\n      const nodePos = pinchZoom.viewerPosFromWorldPos(entry.node.coord);\n      //properties.labelCoord = pinchZoom.worldPosFromViewerPos(entry);\n      properties.labelPixelOffset = Point.minus(entry, nodePos).mul(1/pixelRatio);\n      if ('labelCoord' in properties) {\n        delete properties.labelCoord;\n      }\n\n      this.setLabelBbox(entry.node, context, entry);\n\n      TripGraph.placeLeaderLine(entry.node, pinchZoom, pixelRatio);\n      properties.textPlacement = 'C';\n      properties.textOffset = 0;\n    }\n  }\n\n  static shallowCopy( original: any ): any {\n      // First create an empty object with\n      // same prototype of our original source\n      let clone = Object.create( Object.getPrototypeOf( original ) ) ;\n\n      let i , keys = Object.getOwnPropertyNames( original ) ;\n\n      for ( i = 0 ; i < keys.length ; i ++ )\n      {\n          // copy each property into the clone\n          Object.defineProperty( clone , keys[ i ] ,\n              Object.getOwnPropertyDescriptor( original , keys[ i ] )\n          ) ;\n      }\n\n      return clone ;\n  }\n\n  forEachNode(cb: (node: TripNode) => void) {\n    for (let i in this.graph.nodes) {\n      cb(this.graph.nodes[i]);\n    }\n  }\n\n  getIcon(url) {\n    if (!this.icons[url]\n        || this.icons[url].loading) {\n      return undefined;\n    }\n    return this.icons[url];\n  }\n\n  loadIcons(cb: (err?: Error) => void) {\n    if (this.iconsToLoad > 0) {\n      return;\n    }\n\n    const me = this;\n    this.iconsToLoad = 1;\n    this.failedIcons = 0;\n    const iconLoaded = function() {\n      me.iconsToLoad--;\n      if (cb && me.iconsToLoad === 0) {\n        if (me.failedIcons > 0) {\n          cb(new Error(me.failedIcons + ' icons failed to load.'));\n        } else {\n          cb();\n        }\n      }\n    };\n\n    this.forEachNode((node) => {\n      if (node.labelIcon) {\n        const url = node.labelIcon.url;\n        if (me.icons[url]) {\n          return;\n        }\n        me.icons[url] = { loading: true };\n        me.iconsToLoad++;\n\n        const prefix = (window as any).imageUrlPrefix || '';\n        me.renderer.loadImage(prefix + node.labelIcon.url,\n          function(data) {\n            me.icons[url] = data;\n            iconLoaded();\n          },\n          function(err) {\n            console.log('Failed to load: ' + url + ' (prefix: ' + prefix + ')');\n            me.failedIcons++;\n            iconLoaded();\n          }\n        );\n      }\n    });\n\n    iconLoaded();\n  }\n\n  findLabelAtWorldPos(pos: IPoint): TripNode {\n    const nodes = this.graph.nodes;\n    for (let i in nodes) {\n      if (nodes.hasOwnProperty(i)) {\n        let node = this.graph.nodes[i];\n        if (node.properties\n            && (node.properties.labelCoord || node.properties.labelPixelOffset)) {\n          this.setLabelBbox(node);\n        }\n        if (node.properties && node.properties.labelBbox\n            && BoundingBox.contains(node.properties.labelBbox, pos)) {\n          return node;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  findNodePointAtViewerPos(pos: IPoint): TripNode {\n    const graph = this.graph;\n    for (let i in graph.nodes) {\n      const node = graph.nodes[i];\n\n      if (node.properties && node.properties.point == false) {\n        continue;\n      }\n\n      const properties = node.properties;\n      const radius = (properties.radius || this.defaultRadius) * this.renderer.pixelRatio;\n      if (Point.dist(node.viewerPos, pos) < radius) {\n        return node;\n      }\n    }\n    return undefined;\n  }\n\n  fillClicMap(canvas: HTMLCanvasElement, pinchZoom: PinchZoom) {\n    const elem = document.getElementById('image-clic-map');\n    const graph = this.graph;\n\n    if (!elem) {\n      return;\n    }\n\n    let html = '';\n    for (let i in graph.nodes) {\n      const node = graph.nodes[i];\n\n      if (!node.label) {\n        continue;\n      }\n\n      const size = this.computeNodeSizeWithMargin(canvas.getContext('2d'), node);\n      const pos = node.labelPixelPos(pinchZoom, this.renderer.pixelRatio);\n      const coords = [\n        pos.x - size.width / 2,\n        pos.y - size.height / 2,\n        pos.x + size.width / 2,\n        pos.y + size.height / 2,\n      ].map((x) => Math.round(x));\n      if (coords[0] >= canvas.width\n          || coords[1] >= canvas.height\n          || coords[2] < 0\n          || coords[3] < 0) {\n        continue;\n      }\n      html += '<area'\n                  +' href=\"' + (node.dbid || node.name) +'\"'\n                  + ' shape=\"rect\"'\n                  + ' alt=\"' + node.label + '\"'\n                  + ' coords=\"' + coords.join(',') + '\"'\n                  + '>\\n';\n    }\n    elem.innerHTML = html;\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/trip-graph-layer.ts","import { Point, IPoint } from './point';\nimport { TripNode } from './trip-node';\nimport { TripEdge, TripEdgeProperties, RouteData } from './trip-edge';\n\nimport { BoundingBox } from './bounding-box';\nimport { LatLon, getDirections, midPoint } from './open-route-service';\nimport { PinchZoom } from './tiles';\n\ndeclare var d3: any;\ndeclare var Bezier: any;\ndeclare var Utils: any;\n\nexport class TripGraph {\n  nodes: { [name: string]: TripNode };\n  edges: TripEdge[];\n  defaultEdgeProp: TripEdgeProperties;\n  mapStyle?: string;\n\n  static generateControlPoints(\n      p0: Point, p1: Point, p2: Point, p3: Point): Point[] {\n    const delta = Point.minus(p2, p1).mul(1 / 3);\n    const norm = new Point(-delta.y, delta.x);\n    return [\n      Point.plus(Point.plus(p1, delta), norm),\n      Point.plus(Point.minus(p2, delta), norm)\n    ];\n  };\n\n  static bezierFromPoints(points: IPoint[]): any {\n    const result = [];\n    for (let i = 0; i < 4; ++i) {\n      result.push(points[i].x);\n      result.push(points[i].y);\n    }\n    return new Bezier(result);\n  };\n\n  static bezierThroughPoints(points: IPoint[]) {\n    const result = [];\n    const t = .2;\n    for (let i = 1; i < points.length; ++i) {\n      const prev = (i === 1 ? points[i - 1] : points[i - 2]);\n      const a = points[i - 1];\n      const b = points[i];\n      const next = (i === (points.length - 1) ? points[i] : points[i + 1]);\n      result.push(TripGraph.bezierFromPoints([\n        a,\n        Point.plus(a, Point.times(t, Point.minus(b, prev))),\n        Point.plus(b, Point.times(t, Point.minus(a, next))),\n        b]));\n    }\n    return result;\n  };\n\n  static placeLeaderLine(node: TripNode, pinchZoom: PinchZoom, pixelRatio: number) {\n    if (!node.properties) {\n      node.properties = {};\n    }\n    const placement = node.properties.leaderLine || 'bestAnchor';\n\n    const bbox = node.properties.labelBbox;\n    let anchor;\n    if (placement === 'center') {\n      const  width = bbox.max.x - bbox.min.x;\n      const  center = new Point((bbox.min.x + bbox.max.x) / 2,\n                                (bbox.min.y + bbox.max.y) / 2);\n      const  toCoord = Point.minus(node.coord, center);\n      toCoord.mul(.02);\n      anchor = Point.plus(center, toCoord);\n    } else if (placement === 'closestOnBbox') {\n      anchor = BoundingBox.closestPoint(node.coord, bbox);\n    } else {\n      anchor = d3.labeler.closestLineAnchorPoint(\n            node.coord,\n            {\n              left: bbox.min.x,\n              right: bbox.max.x,\n              top: bbox.min.y,\n              bottom: bbox.max.y,\n              cx: (bbox.min.x + bbox.max.x) / 2,\n              cy: (bbox.min.y + bbox.max.y) / 2\n            }\n        );\n    }\n\n    node.properties.leaderLineAnchorPixelOffset = undefined;\n    node.properties.leaderLineAnchor = anchor;\n    node.convertToPixelOffset(pinchZoom, pixelRatio);\n  }\n  constructor(graph: any, defaultEdgeProp: TripEdgeProperties) {\n    const g = graph || {};\n    this.nodes = g.node || {};\n    this.edges = g.edges || [];\n    this.defaultEdgeProp = defaultEdgeProp;\n  }\n\n  createDefaultBezier() {\n    for (let i in this.edges) {\n      const e = this.edges[i];\n      const from = this.nodes[e.from];\n      const to = this.nodes[e.to];\n\n      const pts = TripGraph.generateControlPoints(undefined,\n                                                  from.coord, to.coord,\n                                                  undefined);\n      // we replace the array in place to avoid breaking the links\n      // to this object.\n      for (let i = 0; i < pts.length; ++i) {\n        e.controlPoints[i] = pts[i];\n      }\n    }\n  }\n\n  edgeProperty(edge: TripEdge, prop: string) {\n    return edge.properties[prop] || this.defaultEdgeProp[prop];\n  }\n\n  getEdgeRoute(edge: TripEdge) : RouteData {\n    if (this.edgeProperty(edge, 'geom') == 'route'\n          && edge.properties\n          && edge.properties.route\n          && edge.properties.route.geom\n          && this.edgeProperty(edge, 'travelMean') == edge.properties.route.mean) {\n      return edge.properties.route;\n    }\n    return undefined;\n  }\n\n  bezier(edge: TripEdge): any[] {\n    if (!edge.controlPoints || edge.properties.hidden) {\n      return [];\n    }\n\n    if (this.edgeProperty(edge, 'geom') == 'straight') {\n      return TripGraph.bezierThroughPoints(\n          [ this.nodes[edge.from].coord, this.nodes[edge.to].coord ]);\n    }\n\n    if (edge.controlPoints.length === 2) {\n      const points = [\n        this.nodes[edge.from].coord,\n        edge.controlPoints[0],\n        edge.controlPoints[1],\n        this.nodes[edge.to].coord\n      ];\n      return [TripGraph.bezierFromPoints(points)];\n    } else if (edge.controlPoints.length === 5) {\n      const points1 = [\n        this.nodes[edge.from].coord,\n        edge.controlPoints[0],\n        edge.controlPoints[1],\n        edge.controlPoints[2],\n      ];\n  \n      const points2 = [\n        edge.controlPoints[2],\n        edge.controlPoints[3],\n        edge.controlPoints[4],\n        this.nodes[edge.to].coord\n      ];\n      return [\n        TripGraph.bezierFromPoints(points1),\n        TripGraph.bezierFromPoints(points2)\n      ];\n    } else {\n      const allPoints = [this.nodes[edge.from].coord]\n        .concat(edge.controlPoints, [ this.nodes[edge.to].coord ]);\n      return TripGraph.bezierThroughPoints(allPoints);\n    }\n  }\n\n  bounds(): BoundingBox {\n    const r = new BoundingBox();\n    for (let i in this.nodes) {\n      if (!this.nodes[i].properties.skip) {\n        r.addPoint(this.nodes[i].coord);\n      }\n    }\n    for (let i in this.edges) {\n      const edge = this.edges[i];\n      const route = this.getEdgeRoute(edge);\n      if (route) {\n        for (let p of route.geom) {\n          r.addPoint(p);\n        }\n      } else {\n        const bezierCurves = this.bezier(edge);\n        for (let c of bezierCurves) {\n          const lut = c.getLUT(8);\n          for (let p of lut) {\n            r.addPoint(p);\n          }\n        }\n      } \n    }\n    return r;\n  }\n\n  // Returns a rectangle containing all the nodes with the desired aspect ratio\n  // and margin factor.\n  //\n  // aspectRatio: width / height\n  frame(aspectRatio?: number, marginRatio?: Point | number): BoundingBox {\n    const bounds = this.bounds();\n    marginRatio = marginRatio || 1.1;\n\n    if (!bounds.max || !bounds.min) {\n      // no point. Let's use the full world.\n      bounds.min = new Point(0, 0);\n      bounds.max = new Point(1, 1);\n      marginRatio = 1;\n    } else if (bounds.min.x === bounds.max.x) {\n      // degenerate case, most likely becase was only 1 point. We need an area\n      // to define a frame.\n      const delta = new Point(1/32, 1/32);\n      bounds.addPoint(Point.plus(bounds.min, delta));\n      bounds.addPoint(Point.minus(bounds.min, delta));\n    }\n\n    aspectRatio = aspectRatio\n      || (bounds.max.x - bounds.min.x) / (bounds.max.y - bounds.min.y);\n\n    const margin = (typeof(marginRatio) === 'number' ?\n                  new Point(marginRatio, marginRatio) : marginRatio);\n\n    const initialSize = Point.minus(bounds.max, bounds.min);\n    initialSize.x *= margin.x;\n    initialSize.y *= margin.y;\n\n    const widthFromHeight = initialSize.y * aspectRatio;\n\n    let size;\n    if (initialSize.x > widthFromHeight) {\n      size = new Point(initialSize.x, initialSize.x / aspectRatio);\n    } else {\n      size = new Point(initialSize.y * aspectRatio, initialSize.y);\n    }\n\n    size.mul(.5);\n    const center = Point.times(0.5, Point.plus(bounds.max, bounds.min));\n    const result = new BoundingBox();\n    result.addPoint(Point.minus(center, size));\n    result.addPoint(Point.plus(center, size));\n    return result;\n  }\n\n  location(aspectRatio?: number, marginRatio?: Point | number) {\n    const frame = this.frame(aspectRatio, marginRatio);\n    const dx = frame.max.x - frame.min.x;\n    return {\n      x: (frame.max.x + frame.min.x) / 2,\n      y: (frame.max.y + frame.min.y) / 2,\n      scale: Math.max(1 / (1<<15), (frame.max.x - frame.min.x))\n    };\n  }\n\n  public compareNodes(other: TripGraph) : boolean {\n    const dictHasAll = (d1, d2) => {\n      for (let n in d1) {\n        if (!(n in d2)) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    return (dictHasAll(this.nodes, other.nodes)\n            && dictHasAll(other.nodes, this.nodes));\n  }\n\n  public getEdgeDirections(edge: TripEdge, mean: string) : Promise<RouteData> {\n    const from = Utils.worldToLatLon(this.nodes[edge.from].coord) as LatLon;\n    const to = Utils.worldToLatLon(this.nodes[edge.to].coord) as LatLon;\n\n    return getDirections(from, to, mean)\n      .then((data: number[][]) => {\n        const points = data.map((coord) => new Point(Utils.latLonToWorld(coord)));\n        const route : RouteData = {\n          mean: mean,\n          geom: points,\n          from: edge.from,\n          to: edge.to,\n          midpoint: midPoint(points)\n        };\n        return route;\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/trip-graph.ts","module.exports = \".properties {\\n  font-size: 12px;\\n}\\n\\n.maptabset /deep/.panel-heading {\\n  padding: 10px 15px;\\n}\\n\\n.maptabset /deep/.panel {\\n  margin-bottom: 1px;\\n}\\n\\ntabset /deep/.nav-stacked {\\n  float: left;\\n}\\n\\ntabset /deep/.tab-content {\\n  float: left;\\n  width: 305px;\\n  margin-right: 6px;\\n}\\n\\n.inline {\\n  display: inline-block;\\n}\\n\\n.floatleft {\\n  float: left;\\n}\\n\\n.floatright {\\n  float: right;\\n}\\n\\n.nodeSelected {\\n  font-weight: bold;\\n}\\n\\n.nodeSkipped {\\n  color: gray;\\n}\\n\\n.small {\\n  width: 25px;\\n  height: 25px;\\n}\\n\\nbutton.delete {\\n  margin-top: 2px;\\n  margin-right: .8em;\\n  background-color: lightgray;\\n  color:red;\\n}\\n\\ndiv.maptabset {\\n  float: left;\\n}\\n\\ntab > button {\\n  width: 100%;\\n}\\n\\n/deep/.square {\\n  width: 10px;\\n  height: 10px;\\n  display: inline-block;\\n  margin: 3px;\\n}\\n\\n.hidden {\\n  display: none;\\n}\\n\\n.global-buttons {\\n  margin-bottom: 20px;\\n}\\n\\n.maptabset /deep/.nav-pills {\\n  margin-right: 6px;\\n}\\n\\n.maptabset /deep/.nav-item {\\n  border-right: 1px solid #ddd;\\n  margin: 0;\\n}\\n\\n.maptabset /deep/.nav-item.active {\\n  border-top: 1px #ddd solid;\\n  border-bottom: 1px #ddd solid;\\n  border-left: 1px #ddd solid;\\n  border-right: 0;\\n}\\n\\n.maptabset /deep/.nav-item.active /deep/a {\\n  color: #428bca;\\n  background-color: white;\\n}\\n\\n.maptabset /deep/.tab-content /deep/button {\\n  width: 100%;\\n}\\n\\n.spin-loader {\\n  position: absolute;\\n  bottom: -20px;\\n  left: 0px;\\n  right: 0px;\\n  top: -20px;\\n  z-index: 10000;\\n  background: url(/ng-map/assets/loader.gif) center center no-repeat;\\n  background-size: 80px 80px;\\n  background-color: rgba(0, 0, 0, 0.6);\\n  display: block;\\n}\\n\\n.maptabset select {\\n  height: 2em;\\n}\\n\\n.maptabset .legend {\\n  font-size: 12px;\\n  text-align: right;\\n  margin-top: 5px;\\n  display: table;\\n}\\n\\n.maptabset .legend p {\\n  display: table-cell;\\n  vertical-align: middle;\\n  height: 25px;\\n}\\n\\n.maptabset .legend i {\\n  color: #428bca;\\n}\\n\\n.maptabset .panel-default {\\n  margin-bottom: 7px;\\n}\\n\\n.maptabset .panel {\\n  -webkit-box-shadow: none;\\n  box-shadow: none;\\n}\\n\\n.route-action input {\\n  float: right;\\n  margin: 0;\\n  height: 12px;\\n}\\n\\n.route-action i {\\n  float: right;\\n  font-size: 10px;\\n  margin-right: 4px;\\n  color: #428bca;\\n}\\n\\n.button-separtor {\\n  margin: 10px 0;\\n}\\n\\n.map-colors {\\n  position: relative;\\n  padding: 5px 0px;\\n}\\n\\n.map-colors span {\\n  position: absolute;\\n  left:40px;\\n  top:11px;\\n}\\n\\n.heading .map-btn {\\n  margin-top: 10px;\\n}\\n\\n.in-margin-top {\\n  margin-top: auto;\\n  margin-bottom: auto;\\n}\\n\\n.fa-right-margin {margin-right: 7px;}\\n\\n.form-control-input {\\n  display: inline-block;\\n  margin-right: 10px;\\n  height: 34px;\\n  padding: 6px 12px;\\n  font-size: 12px;\\n  line-height: 1.42857143;\\n  color: #555555;\\n  background-color: #fff;\\n  background-image: none;\\n  border: 1px solid #ccc;\\n  border-radius: 4px;\\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\\n  -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\\n  -webkit-transition: border-color ease-in-out 0.15s, -webkit-box-shadow ease-in-out 0.15s;\\n  transition: border-color ease-in-out 0.15s, -webkit-box-shadow ease-in-out 0.15s;\\n  transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\\n  transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s, -webkit-box-shadow ease-in-out 0.15s;\\n}\\n\\n.italic {\\n  font-style: italic;\\n  padding-left: 12px;\\n  font-size: 12px;\\n}\\n\\n.btn-group {width: 100%;}\\n\\n.form-control {margin-top: 5px;}\\n\\naccordion-group p {\\n  padding-top:5px;\\n}\\n\\naccordion-group p .fa {\\n  margin-right: 10px;\\n  color:#428bca;\\n}\\n\\n#accordion-menu p {\\n  color: #333;\\n  background-color: #f5f5f5;\\n  cursor: pointer;\\n  padding: 10px 20px;\\n  margin: 0;\\n  border-top-left-radius: 4px;\\n  border-top-right-radius: 4px;\\n  border: 1px solid #ddd;\\n  -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.05);\\n  box-shadow: 0 1px 1px rgba(0,0,0,.05);\\n}\\n\\n#accordion-menu .content {\\n  border:1px solid #ddd;\\n  padding:20px 15px 10px;\\n  color: #333;\\n  background-color: white;\\n  border-color: #ddd;\\n  display: none;\\n  margin: 0;\\n}\\n\\n#accordion-menu ul li {\\n  list-style-type:none;\\n}\\n\\n#accordion-menu .collapsable-menu {display:none;}\\n\\n#accordion-menu .uncollapsable-menu {display:block;}\\n\\n#long-accord {\\n  max-height: 600px;\\n  padding-right: 5px;\\n}\\n\\n#long-accord::-webkit-scrollbar {\\n  background-color: #eee;\\n  width: 6px;\\n}\\n\\n#long-accord::-webkit-scrollbar-thumb {\\n  background-color: #999;\\n  border-radius: 6px;\\n}\\n\\n.thinbutton {\\n  padding-left: 10px;\\n  padding-right: 10px;\\n}\\n\\n#scaleSlider {\\n  padding: 15px;\\n}\\n\\n.hflex-container {\\n  display: -ms-flexbox;\\n  display: -webkit-box;\\n  display: flex;\\n  -ms-flex-direction: row;\\n  -webkit-box-orient: horizontal;\\n  -webkit-box-direction: normal;\\n          flex-direction: row;\\n  -ms-flex-wrap: nowrap;\\n  flex-wrap: nowrap;\\n  -ms-flex-pack: start;\\n  -webkit-box-pack: start;\\n          justify-content: flex-start;\\n  -ms-flex-line-pack: stretch;\\n  align-content: stretch;\\n  -ms-flex-align: start;\\n  -webkit-box-align: start;\\n          align-items: flex-start;\\n}\\n\\n.flex-item-wide,\\n.flex-item-narrow {\\n  -ms-flex-order: 0;\\n  -webkit-box-ordinal-group: 1;\\n          order: 0;\\n  -webkit-align-self: auto;\\n  -ms-flex-item-align: auto;\\n  -ms-grid-row-align: auto;\\n      align-self: auto;\\n}\\n\\n.flex-item-narrow {\\n  -ms-flex: 0 1 auto;\\n  -webkit-box-flex: 0;\\n          flex: 0 1 auto;\\n}\\n\\n.flex-item-wide {\\n  -ms-flex: 1 1 auto;\\n  -webkit-box-flex: 1;\\n          flex: 1 1 auto;\\n}\\n\\n.smallspacing {\\n  margin-top: 5px;\\n  margin-bottom: 5px;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/trip-map.component.css\n// module id = ./frontend/map_editor/src/app/trip-map/trip-map.component.css\n// module chunks = main","module.exports = \"<link href=\\\"https://fonts.googleapis.com/css?family=PT+Sans\\\" rel=\\\"stylesheet\\\">\\n\\n<div *ngIf=\\\"_errorMessage\\\" class=\\\"alert fade in alert-danger\\\">\\n  <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\" (click)=\\\"_errorMessage = null\\\"></button>\\n  {{_errorMessage}}\\n</div>\\n<div *ngIf=\\\"_infoMessage\\\" class=\\\"alert fade in alert-success\\\">\\n  <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\" (click)=\\\"_infoMessage = null\\\"></button>\\n  {{_infoMessage}}\\n</div>\\n\\n<p *ngIf=\\\"!_loadingMap && _numLocations ==0\\\">Please add at least one location in a day or event settings</p>\\n<p *ngIf=\\\"_loadingMap\\\">Loading...</p>\\n\\n<div *ngIf=\\\"_numLocations > 0 && !_visitedPlaceList.length\\\">\\n  <p>No map created yet.</p>\\n  <button (click)=\\\"fetchLocationsAndGenerateMap()\\\" class=\\\"btn btn-primary\\\">Create map</button>\\n</div>\\n<div [class.hidden]=\\\"!_visitedPlaceList.length\\\">\\n<div *ngIf=\\\"!hideUi()\\\" class=\\\"maptabset\\\">\\n<tabset [vertical]=\\\"true\\\" type=\\\"pills\\\">\\n  <tab (select)=\\\"lockMap(true)\\\">\\n    <ng-template tabHeading>\\n      <i class=\\\"glyphicon glyphicon-map-marker\\\"></i>\\n    </ng-template>\\n\\n    <div class=\\\"row heading\\\">\\n      <div class=\\\"col-md-5\\\">\\n        <select class=\\\"form-control btn-xs\\\" [ngModel]=\\\"_pageSizeName\\\" (change)=\\\"uiSetPageSize($event.target.value)\\\">\\n          <option *ngFor=\\\"let x of _pageSizes\\\"\\n                  class=\\\"form-control\\\"\\n                  required\\n                  [value]=\\\"x.key()\\\"\\n                  >{{x.name}}</option>\\n        </select>\\n      </div>\\n      <div class=\\\"col-md-7 legend\\\">\\n        <p>\\n          Display location <i class=\\\"glyphicon glyphicon-map-marker\\\"></i>\\n        </p>\\n      </div>\\n    </div>\\n    <div class=\\\"row heading\\\">\\n      <div class=\\\"col-md-5\\\">\\n        <button class=\\\"btn btn-default btn-xs map-btn\\\"\\n                  (click)=\\\"uiSetFrame()\\\">Auto scroll/zoom</button>\\n      </div>\\n\\n      <div class=\\\"col-md-7 legend\\\">\\n        <p>\\n          Line to next active location <i class=\\\"fa fa-road\\\"></i>\\n        </p>\\n      </div>\\n    </div>\\n    <hr class=\\\"button-separtor\\\">\\n    <accordion id=\\\"long-accord\\\" [closeOthers]=\\\"true\\\">\\n      <ng-container *ngFor=\\\"let intr of _interleaved\\\">\\n      <accordion-group *ngIf=\\\"intr.node\\\"\\n               [class.nodeSkipped]=\\\"intr.node && isSkipped(intr.node)\\\"\\n               [isOpen]=\\\"isNodeSelected(intr.node)\\\"\\n               #group\\n               >\\n        <div accordion-heading class=\\\"hflex-container\\\">\\n          <i class=\\\"fa fa-right-margin flex-item-narrow in-margin-top\\\"\\n            style=\\\"font-size: 14pt\\\"\\n            [ngClass]=\\\"{'fa-caret-down': group?.isOpen, 'fa-caret-right': !group?.isOpen}\\\"></i>\\n          <input [ngModel]=\\\"intr.node.label\\\"\\n            [disabled]=\\\"isSkipped(intr.node)\\\"\\n            (click)=\\\"$event.stopPropagation();\\\"\\n            (change)=\\\"setNodeLabel(intr.node, $event.target.value)\\\"\\n            class=\\\"form-control-input flex-item-wide\\\"/>\\n          <div class=\\\"route-action\\\">\\n            <input type=\\\"checkbox\\\"\\n              [ngModel]=\\\"!isSkipped(intr.node)\\\"\\n              (click)=\\\"toggleSkipNode(intr.node); $event.stopPropagation();\\\">\\n            <i class=\\\"glyphicon glyphicon-map-marker\\\"></i>\\n            <br>\\n            <input type=\\\"checkbox\\\" *ngIf=\\\"intr.edge\\\"\\n              [checked]=\\\"!intr.edge.properties.hidden && !isSkipped(intr.node)\\\"\\n              [disabled]=\\\"isSkipped(intr.node)\\\"\\n              (change)=\\\"toggleHideEdge(intr.edge)\\\"\\n              (click)=\\\"$event.stopPropagation();\\\">\\n            <i class=\\\"fa fa-road\\\" *ngIf=\\\"intr.edge\\\"></i>\\n          </div>\\n        </div>\\n        <div *ngIf=\\\"!isSkipped(intr.node)\\\" class=\\\"btn-group properties\\\">\\n          <div style=\\\"margin-bottom: 10px;\\\">\\n            <span>\\n              <label class=\\\"btn btn-default map-btn\\\"\\n                [ngModel]=\\\"intr.node.properties.landing\\\"\\n                (click)=\\\"toggleProperty(intr.node, 'landing')\\\" btnCheckbox>\\n                <img src=\\\"/ng-map/assets/landing.svg\\\" alt=\\\"Landing\\\" width=\\\"16px\\\" height=\\\"16px\\\" />\\n              </label>\\n              <label class=\\\"btn btn-default map-btn\\\"\\n                [ngModel]=\\\"intr.node.properties.takeoff\\\"\\n                (click)=\\\"toggleProperty(intr.node, 'takeoff')\\\" btnCheckbox>\\n                <img src=\\\"/ng-map/assets/takeoff.svg\\\" alt=\\\"Take-off\\\" width=\\\"16px\\\" height=\\\"16px\\\" />\\n              </label>\\n              <label class=\\\"btn btn-default map-btn\\\"\\n                [ngModel]=\\\"hasMark(intr.node)\\\"\\n                (click)=\\\"setProperty(intr.node, 'markStyle', (hasMark(intr.node) ? 'normal' : 'first'))\\\"\\n                btnCheckbox>\\n                <i class=\\\"fa fa-circle\\\" aria-hidden=\\\"true\\\"></i>\\n              </label>\\n            </span>\\n          </div>\\n          <hr class=\\\"smallspacing\\\"/>\\n          <div>\\n            <text-prop [(properties)]=\\\"intr.node.properties\\\"\\n                       [defaults]=\\\"_seqTrip._tripData.defaultTextProp\\\"\\n                       (onChange)=\\\"nodePropertiesChanged()\\\"></text-prop>\\n          </div>\\n\\n          <hr class=\\\"smallspacing\\\"/>\\n\\n          <edge-prop *ngIf=\\\"intr.edge && !intr.edge.properties.hidden\\\"\\n            [(properties)]=\\\"intr.edge.properties\\\"\\n            [defaults]=\\\"_seqTrip._tripData.defaultEdgeProp\\\"\\n            (onChange)=\\\"edgePropertiesChanged(intr.edge)\\\"></edge-prop>\\n        </div>\\n      </accordion-group>\\n      </ng-container>  <!-- ngFor on interleaved places and edges -->\\n    </accordion>\\n  </tab>\\n\\n  <tab (select)=\\\"lockMap(false)\\\">\\n    <ng-template tabHeading>\\n      <i class=\\\"fa fa-file\\\"></i>\\n    </ng-template>\\n      <div  class=\\\"panel panel-default\\\">\\n        <div class=\\\"panel-body\\\">\\n          <div>\\n            <label>Zoom / center</label>\\n          </div>\\n          <div>\\n            <input id=\\\"scaleSlider\\\" [ngModel]=\\\"scale()\\\"\\n              (change)=\\\"setScale($event.target.value)\\\"\\n              (input)=\\\"setScale($event.target.value)\\\"\\n              type=\\\"range\\\" min=\\\"0\\\" max=\\\"18\\\" step=\\\"0.000001\\\" />\\n          </div>\\n          <div>\\n            <input type=\\\"checkbox\\\" [checked]=\\\"_autoLockMap\\\"\\n              (change)=\\\"_autoLockMap = !_autoLockMap\\\" />\\n            <span>Auto lock map</span>\\n          </div>\\n        </div>\\n      </div>\\n      <accordion [closeOthers]=\\\"true\\\">\\n        <accordion-group>\\n          <p accordion-heading>\\n            <i class=\\\"fa fa-font\\\" aria-hidden=\\\"true\\\"></i>Default text properties\\n          </p>\\n          <div>\\n            <text-prop [(properties)]=\\\"_seqTrip._tripData.defaultTextProp\\\"\\n                        (onChange)=\\\"nodePropertiesChanged()\\\"\\n                        [noReset]=\\\"true\\\"></text-prop>\\n\\n          </div>\\n        </accordion-group>\\n\\n        <accordion-group>\\n          <p accordion-heading>\\n            <i class=\\\"fa fa-arrows-h\\\" aria-hidden=\\\"true\\\"></i>Default line properties\\n          </p>\\n          <div>\\n            <edge-prop [(properties)]=\\\"_seqTrip._tripData.defaultEdgeProp\\\"\\n                        (onChange)=\\\"edgePropertiesChanged()\\\"\\n                        [noReset]=\\\"true\\\"></edge-prop>\\n\\n          </div>\\n        </accordion-group>\\n      </accordion>\\n  </tab>\\n</tabset>\\n</div>\\n\\n<div class=\\\"floatleft\\\">\\n  <mapview #mapview\\n      (drop)=\\\"drop($event)\\\"\\n      (dragover)=\\\"allowDrop($event)\\\"\\n      style=\\\"display:block;\\\"\\n      [style.width.px]=\\\"_canvasWidth\\\"\\n      [style.height.px]=\\\"_canvasHeight\\\"\\n      [canvasWidth]=\\\"_canvasWidth\\\"\\n      [canvasHeight]=\\\"_canvasHeight\\\"\\n      [compactAttribution]=\\\"true\\\"\\n      [lang]=\\\"language\\\"\\n      ></mapview>\\n  <div id=\\\"map_attribution\\\" style=\\\"font-size: 8pt;\\\" [innerHtml]=\\\"attribution()\\\"></div>\\n</div>\\n\\n  <span class=\\\"floatright btn-group\\\" style=\\\"width:auto;\\\" dropdown>\\n    <button dropdownToggle type=\\\"button\\\" class=\\\"btn btn-default dropdown-toggle thinbutton\\\">\\n      <i class=\\\"fa fa-cogs\\\" aria-hidden=\\\"true\\\"></i><br/><span class=\\\"caret\\\"></span>\\n    </button>\\n    <ul *dropdownMenu class=\\\"dropdown-menu dropdown-menu-right\\\" role=\\\"menu\\\">\\n      <li role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"autoPlaceLabels()\\\">Auto place labels</a></li>\\n      <li role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"resetCurves()\\\">Reset curves</a></li>\\n      <li role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"resetLabels()\\\">Reset labels</a></li>\\n      <li class=\\\"divider dropdown-divider\\\"></li>\\n      <li role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"download('jpg')\\\">Export JPG</a></li>\\n      <li role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"download('png')\\\">Export PNG</a></li>\\n      <li *ngIf=\\\"superadmin\\\" role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"download('mbtiles')\\\">Export MBTiles</a></li>\\n      <li *ngIf=\\\"superadmin\\\" role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"download('mbtiles', { maxzoom: 14 })\\\">Export MBTiles (max details)</a></li>\\n      <li *ngIf=\\\"superadmin\\\" role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"download('mbtiles', { hillshading: 1})\\\">Export hillshading MBTiles</a></li>\\n      <li *ngIf=\\\"superadmin\\\" role=\\\"menuitem\\\"><a class=\\\"dropdown-item\\\" href=\\\"#\\\" (click)=\\\"download('mbtiles', { hillshading:1, maxzoom: 14 })\\\">Export hillshading MBTiles (max details)</a></li>\\n    </ul>\\n  </span>\\n\\n\\n</div>\\n\\n<div *ngIf=\\\"_showSpinner\\\" class=\\\"spin-loader\\\"></div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/trip-map.component.html\n// module id = ./frontend/map_editor/src/app/trip-map/trip-map.component.html\n// module chunks = main","import { Component, OnInit, ViewChild, ElementRef, HostListener } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\n\nimport { TripGraph } from './trip-graph';\nimport { TripGraphEditor } from './trip-graph-editor';\nimport { TripGraphLayer } from './trip-graph-layer';\nimport { ITripNode, TripNode, TripNodeProperties } from './trip-node';\nimport { TripEdge } from './trip-edge';\nimport { IPoint, Point } from './point';\nimport { SeqTrip } from './seq-trip';\nimport { T, Location, CanvasTilesRenderer, CanvasTilesRendererParams, PinchZoom } from './tiles';\nimport {forEach} from \"@angular/router/src/utils/collection\";\n\n//import { Map, Style, Layer } from 'mapbox-gl';\nimport { MapView, PrepareCanvasOptions } from './mapview.component';\nimport { PageSize } from './page-size';\n\nimport { TripLocation, MapParams, globalMapParams } from './map-params';\n\ndeclare var Utils: any;\n\ndeclare var $: any;\n\ndeclare interface CountryStyle {\n  lineWidth?: number;\n  color?: string;\n}\n\ndeclare interface WorldBackgroundLayerParams {\n  renderer: CanvasTilesRenderer;\n  onCountryClic: (country: {id: string}) => void;\n  onSeaClic: () => void;\n  landColor: string;\n  seaColor: string;\n  borderColor: string;\n  showRivers: boolean;\n  countryStyle: { [id: string]: CountryStyle; };\n}\ndeclare class WorldBackgroundLayer {\n  params: WorldBackgroundLayerParams;\n  constructor (parameters: WorldBackgroundLayerParams);\n};\n\ninterface EdgeOrNode {\n  edge?: TripEdge;\n  node?: TripNode;\n};\n\nconst enum ModificationEvent {\n  Location = 1,\n  Node,\n  NodeStyle,\n  Edge,\n  PageSize,\n  MapColor,\n  Frame,\n  LabelMoved,\n  CurveMoved,\n  Label,\n  LabelProperties,\n  EdgeProperties,\n  UpdatedLocations  // Added/removed location based on the trip program\n}\n\ninterface Selection {\n  _selectedNode: TripNode;\n  _selectedCountry: string;\n  _selectedEdge: TripEdge;\n}\n\n@Component({\n  selector: 'trip-map',\n  templateUrl: 'trip-map.component.html',\n  styleUrls: ['./trip-map.component.css'],\n})\nexport class TripMapComponent implements OnInit {\n\n  @ViewChild('mapview') mapview: MapView;\n\n  public _canvasWidth: number;\n  public _canvasHeight: number;\n\n  private _renderer: CanvasTilesRenderer;\n  private _worldLayer: WorldBackgroundLayer;\n  private _tripLayer: TripGraphLayer;\n  private _editor: TripGraphEditor;\n\n  private _graph: TripGraph;\n  private _selectedNode: TripNode;\n  private _selectedCountry: string;\n  private _selectedEdge: TripEdge;\n\n  private _autoRefresh: number;\n  private _saveTimeout?: any;\n\n  public _visitedPlaceList: TripNode[];\n  public _stages: TripEdge[];\n  public _interleaved: EdgeOrNode[];\n  public _seqTrip: SeqTrip;\n  public _infoMessage?: string;\n  public _errorMessage?: string;\n  public _numLocations: number;\n  public _autoLockMap: boolean;\n  public _runAfterInit?: () => void;\n\n  public language: string;\n  private _needLabelPlacement?;\n\n  private _kmlReader?: FileReader;\n\n  // true when the map is loading.\n  _loadingMap: boolean;\n  _pageSizes : PageSize[];\n  _pageSizeName : string;\n  _pageSizeMap: { [key: string] : PageSize };\n  _showSpinner: boolean;\n  _saved: boolean;\n  _scaleChangeTimeout;\n\n  role: string;\n  superadmin: boolean;\n\n  constructor(public http: HttpClient) {\n    const roleElement = document.querySelectorAll(\"meta[name^=role]\")[0];\n    this.role = (roleElement ? roleElement.getAttribute('content') : 'unknown');\n    this.superadmin = (this.role == 'super-admin');\n    this._canvasWidth = 512;\n    this._canvasHeight = 512;\n    this._selectedCountry = '';\n    this._loadingMap = false;\n    this._autoLockMap = true;\n\n    const pageWidth = 128;\n    const pageHeight = 190;\n    if (globalMapParams().preferences.page_sizes) {\n      this._pageSizes =\n        globalMapParams().preferences.page_sizes.map(PageSize.fromIPageSize);\n    } else {\n      this._pageSizes = [\n        new PageSize(\"Full page\", pageWidth, pageHeight),\n        new PageSize(\"Full page rotated\", pageHeight, pageWidth),\n        new PageSize(\"Square\", pageWidth, pageWidth),\n        new PageSize(\"Landscape\", pageWidth, pageHeight / 2),\n        /*\n        new PageSize(\"A4 Portrait\", 180, 267),\n        new PageSize(\"A4 Landscape\", 267, 180),\n        new PageSize(\"A3 Portrait\", 267, 390),\n        new PageSize(\"A3 Landscape\", 390, 267)\n        */\n      ];\n    }\n    this._pageSizeMap = {};\n    for (let s of this._pageSizes) {\n      this._pageSizeMap[s.key()] = s;\n    }\n    this._numLocations = 0;\n    this._showSpinner = false;\n\n    this._seqTrip = new SeqTrip();\n    this._graph = new TripGraph(undefined, this._seqTrip.defaultEdgeProp());\n\n    if (this._tripLayer) {\n      this._tripLayer.defaultTextProp = this._seqTrip.defaultTextProp();\n      this._tripLayer.defaultEdgeProp = this._seqTrip.defaultEdgeProp();\n    }\n    this._visitedPlaceList = this._seqTrip.places();\n    this._stages = this._seqTrip.stages();\n    this._interleaved = this.interleavedPlacesAndEvents();\n\n    this.setPageSize(this._pageSizes[0].key());\n    this.language = globalMapParams().language;\n    this._seqTrip.setLanguage(globalMapParams().language);\n  }\n\n  fetchRawLocations() : Promise<TripLocation[]> {\n    this._numLocations = 0;\n\n    const params = globalMapParams();\n    let promise;\n\n    if (params.locations) {\n      promise = Promise.resolve(\n          // We clone the data to make sure the original remains untouch,\n          // just in case fetchRawLocations() is called multiple times.\n          params.locations.map((x) => Object.assign({}, x)));\n    } else if (params.locations_url) {\n      promise = new Promise((resolve, reject) => {\n        this.http.get(params.locations_url, { responseType: 'json' })\n          .subscribe(\n          (data: any) => {\n            if (Array.isArray(data)) {\n              resolve(data as TripLocation[]);\n            } else {\n              reject('bad map data');\n            }\n          },\n          (err: any) => { reject(err); });\n      });\n    } else {\n      promise = Promise.resolve(undefined);\n    }\n\n    return promise.then((data) => {\n      if (data) {\n        this._numLocations = data.length;\n      }\n      return data;\n    });\n  }\n\n  translateLocations(locationData : TripLocation[]) : Promise<TripLocation[]> {\n    return new Promise((resolve, reject) => {\n      for (let i in locationData) {\n        // \"translations\" are sent with GeoTree points.\n        // In that case, we should NOT query geoname translations.\n        // We should honor \"translations\" as best as possible, or EN if\n        // target language is not available.\n        if (locationData[i].translations && locationData[i].translations[globalMapParams().language]) {\n          locationData[i].label = locationData[i].translations[globalMapParams().language];\n        }\n        else if (locationData[i].translations && locationData[i].translations['en']) {\n          locationData[i].label = locationData[i].translations['en'];\n        }\n      }\n      const missing_translations =\n        locationData\n        .filter((loc : TripLocation) => loc.geoname_id && !loc.translations)\n        .map((a : TripLocation) => a.geoname_id);\n      if (missing_translations.length == 0) {\n        resolve(locationData);\n        return;\n      }\n      const url = globalMapParams().geoname_service_url\n        + 'location?q=' + missing_translations.join(',')\n        + '&l=' + globalMapParams().language;\n\n      this.http.get(url, { responseType: 'json' })\n        .subscribe((data: any[]) => {\n         if (!data || !Array.isArray(data)) {\n           resolve(locationData);\n           return;\n         }\n         const dict = { };\n         for (let d of data) {\n           dict[d.id] = d;\n         }\n         for (let l of locationData) {\n           if (l.geoname_id && (l.geoname_id in dict) && dict[l.geoname_id].name) {\n             //console.log('Translated location: ' + l.label\n             //            + ' -> ' + dict[l.geoname_id].name);\n             l.label = dict[l.geoname_id].name;\n           } else {\n             //console.log('No geoname result for id: ' + l.geoname_id\n             //            + ' (' + l.label + ')');\n           }\n         }\n         return resolve(locationData);\n       },\n       (err: any) => { reject(err); });\n    });\n  }\n\n  fetchLocations() : Promise<TripLocation[]> {\n    return this.fetchRawLocations().then((data) => (data ? this.translateLocations(data) : undefined));\n  }\n\n  generateFromLocations(locations: TripLocation[]) {\n    this._seqTrip.reset();\n    this.updateWithLocations(locations, { resetLocation: true });\n    if (this._tripLayer) {\n      this._tripLayer.defaultTextProp = this._seqTrip.defaultTextProp();\n      this._tripLayer.defaultEdgeProp = this._seqTrip.defaultEdgeProp();\n    }\n    this.saveMap();\n  }\n\n  async updateWithLocations(locations: TripLocation[],\n                      options?: { resetLocation?: boolean; resetLabels?: boolean }) {\n    options = options || { };\n    const latLonToCoord = (lat: number, lon: number) => {\n      const p = Utils.latLonToWorld([lon, lat]);\n      return new Point(p);\n    };\n    const existingPlaces : { [key: number]: TripNode } = { };\n    for (let p of this._seqTrip.places()) {\n      if ('dbid' in p) {\n        existingPlaces[p.dbid] = p;\n      }\n    }\n\n    const places: TripNode[] = [];\n    let numNewPlaces = 0;\n    for (let l of locations) {\n      const coord = latLonToCoord(l.latitude, l.longitude);\n      const id = '' + l.id;\n      if (id in existingPlaces) {\n        const updatedPlace = existingPlaces[id];\n        updatedPlace.coord = coord;\n        if (!updatedPlace.label || options.resetLabels) {\n          updatedPlace.label = l.label;\n        }\n        places.push(updatedPlace);\n      } else {\n        let newNode = TripNode.parse({\n          dbid: id,\n          name: id,\n          label: l.label,\n          coord: coord,\n          properties: l.node_prop\n        });\n        if (l.following_edge_prop) {\n          newNode.followingEdgeProp = l.following_edge_prop;\n        }\n\n        // A place might be visited multiple times, this appearing several\n        // times in 'locations'. That's ok. However, we want all instances\n        // to share the same properties object.\n        for (let p of places) {\n          if (p.dbid == newNode.dbid) {\n            newNode.properties = p.properties;\n            break;\n          }\n        }\n        places.push(newNode);\n        ++numNewPlaces;\n      }\n    }\n\n    this._seqTrip.setPlaces(places);\n    this._seqTrip.markFirstLocation();\n\n    if (options.resetLocation) {\n      this._seqTrip.setLocation(this._seqTrip.makeGraph().location(\n              this._seqTrip.width_mm() / this._seqTrip.height_mm(), 1.2));\n    }\n\n    this._visitedPlaceList = this._seqTrip.places();\n    this._stages = this._seqTrip.stages();\n    this._interleaved = this.interleavedPlacesAndEvents();\n    await this.pushSeqTripToCanvas(options.resetLocation);\n    if (numNewPlaces > 0) {\n      this.placeLabels(true);\n      this._runAfterInit = () => { this.placeLabels(true); };\n    } else {\n      this._runAfterInit = () => { this.makeGraph(); };\n    }\n  }\n\n  destination(edge: TripEdge): TripNode {\n    if (this._tripLayer && edge.to in this._tripLayer.graph.nodes) {\n      return this._tripLayer.graph.nodes[edge.to];\n    } else {\n      return this._seqTrip.placeByName(edge.to);\n    }\n  }\n  origin(edge: TripEdge): TripNode {\n    if (this._tripLayer && edge.from in this._tripLayer.graph.nodes) {\n      return this._tripLayer.graph.nodes[edge.from];\n    } else {\n      return this._seqTrip.placeByName(edge.from);\n    }\n  }\n\n  ngOnInit() {\n    this.mapview.onMapReady = () => {\n      if (this.isReady()) {\n        console.log('Map is ready.');\n      }\n    };\n    this.loadMap();\n  }\n\n  pushSeqTripToCanvas(fullReset?: boolean) : Promise<void> {\n    for (let p of ['seaColor', 'borderColor', 'landColor', 'showRivers']) {\n      //this._worldLayer.params[p] = this._seqTrip[p]();\n    }\n    //this._worldLayer.params.countryStyle = this._seqTrip.world();\n\n    const pageSize = new PageSize(this._seqTrip.pageSizeName(),\n                                  this._seqTrip.width_mm(),\n                                  this._seqTrip.height_mm());\n    if (!this._pageSizeMap[pageSize.key()]) {\n      this._pageSizeMap[pageSize.key()] = pageSize;\n      this._pageSizes.push(pageSize);\n    }\n\n    this.setPageSize(pageSize.key(), false);\n\n    // Wait for setPageSize to propagate.\n    return new Promise((resolve, reject) => setTimeout(resolve, 20))\n      .then(() => {\n        if (this._renderer) {\n          this._renderer.setLocation(this._seqTrip.location());\n          this._graph = this.mapview.setSeqTrip(this._seqTrip);\n        }\n\n        if (fullReset === true) {\n          this.reset();\n        } else if (this._renderer) {\n          this.makeGraph();\n        }\n      });\n  }\n\n  ngAfterViewInit() {\n  }\n\n  // scale = 1 / ( 2^zoom )\n  // 1 / scale = 2^zoom\n  // log2(1/scale) = zoom\n  scale() : number {\n    const loc = this._seqTrip.location();\n    return Math.log2(1 / loc.scale);\n  }\n  setScale(s: number) {\n    const renderer = this._renderer;\n    if (!renderer) {\n      return;\n    }\n    const loc = renderer.getLocation();\n    loc.scale =  1 / Math.pow(2, s);\n    renderer.setLocation(loc);\n    this._seqTrip.setLocation(this._renderer.getLocation());\n\n    this.modified(ModificationEvent.Location);\n\n    if (this._scaleChangeTimeout) {\n      clearTimeout(this._scaleChangeTimeout);\n    }\n    this._scaleChangeTimeout = setTimeout(() => {\n      this.placeLabels(true);\n    }, 800);\n  }\n\n  prepareCanvas(cb?: () => void) {\n    if (!this._seqTrip) {\n      return;\n    }\n    this.mapview.prepareCanvas({\n      disableMouseWheel: !this.hideUi(),\n      trip: this._seqTrip,\n      graph: this._graph,\n      onLocationChange: (renderer: CanvasTilesRenderer) => {\n          if (this._loadingMap || !this._seqTrip || !this._tripLayer || !this._editor) {\n            return; // We let the map load before reacting to scroll/zoom.\n          }\n          const newLocation = renderer.getLocation();\n\n          let needsPlacement = false;\n\n          if (this._needLabelPlacement) {\n            clearTimeout(this._needLabelPlacement);\n            this._needLabelPlacement = undefined;\n            needsPlacement = true;\n          } else {\n            // Zoom changes might fuse/split nodes, forcing a replace label.\n            const fused = this._seqTrip.makeGraph(this._tripLayer);\n            needsPlacement = !fused.compareNodes(this._tripLayer.graph);\n          }\n\n          if (needsPlacement) {\n            // We postpone label placement once the user finished scrolling/moving\n            // the map. We wait for 500ms without motion.\n            this._needLabelPlacement = setTimeout(() => {\n              console.log('Placing labels after motion.');\n              this._seqTrip.setLocation(renderer.getLocation());\n              const fused = this._seqTrip.makeGraph(this._tripLayer);\n              this._graph = fused;\n              this._tripLayer.graph = fused;\n              this._editor.graph = fused;\n              this.placeLabels(true);\n              this._needLabelPlacement = undefined;\n            }, 500);\n          } else {\n            // No fusion/split.\n            this._seqTrip.setLocation(newLocation);\n          }\n          this.modified(ModificationEvent.Location);\n      },\n    alreadyCreated: (renderer: CanvasTilesRenderer) => {\n      if (cb) {\n        cb();\n      }\n    },\n    created: (renderer: CanvasTilesRenderer, tripLayer: TripGraphLayer) => {\n          this._renderer = renderer;\n          this._tripLayer = tripLayer;\n\n          // setTimeout is necessary to restart an angular check cycle.\n          // In ngAfterViewInit, we're not supposed to change the state.\n          setTimeout(async () => {\n            this.clearSelection();\n            this._editor = new TripGraphEditor(this._renderer, this._graph, tripLayer);\n            this._renderer.pinchZoom.touchEventHandlers.push(this._editor);\n            this._editor.onLabelMoved = (a) => { this.modified(ModificationEvent.LabelMoved); };\n            this._editor.onBezierMoved = (a) => { this.modified(ModificationEvent.CurveMoved); };\n\n            this._editor.onLabelSelect = (node: TripNode) => {\n              this.selectNode(node);\n            };\n            this._editor.onBezierSelect = (bezier: {edge: TripEdge}) => {\n              if (bezier) {\n                this.selectEdge(bezier.edge);\n              } else {\n                this.clearSelection();\n              }\n            };\n\n            await this.pushSeqTripToCanvas();\n            this.mapview.resize();\n\n            if (cb) { cb(); }\n          }, 10);\n        }\n    });\n  }\n\n  mapIsLocked() : boolean {\n    return this._renderer && this._renderer.pinchZoom && this._renderer.pinchZoom.locked;\n  }\n\n  lockMap(lock : boolean) {\n    if (this._renderer && this._renderer.pinchZoom) {\n      this._renderer.pinchZoom.locked = lock && this._autoLockMap;\n    }\n  }\n\n  ngOnDestroy() {\n    if (this._autoRefresh) {\n      clearInterval(this._autoRefresh);\n    }\n  }\n\n  clearSelection() {\n    this._selectedCountry = undefined;\n    this._selectedNode = undefined;\n    this._selectedEdge = undefined;\n  }\n\n  clearAndSaveSelection() : Selection {\n    const sel : Selection = {\n      _selectedCountry: this._selectedCountry,\n      _selectedNode: this._selectedNode,\n      _selectedEdge: this._selectedEdge\n    };\n    this.clearSelection();\n    return sel;\n  }\n\n  restoreSelection(sel : Selection) {\n    this._selectedCountry = sel._selectedCountry;\n    this._selectedNode = sel._selectedNode;\n    this._selectedEdge = sel._selectedEdge;\n  }\n\n  selectCountry(country?: string) {\n    this.clearSelection();\n    this._selectedCountry = country;\n    this.setCountryColor(country, this.countryColor(country));\n  }\n\n  setCountryColor(country: string, c: string) {\n    if (!country) {\n      return;\n    }\n\n    const wantsDefault = (c == 'default');\n\n    let modified = false;\n    let countryStyle; // = this._worldLayer.params.countryStyle[country];\n    if (countryStyle) {\n      if (!wantsDefault) {\n        modified = countryStyle.color !== c;\n        countryStyle.color = c;\n      } else {\n        modified = !!countryStyle.color;\n        delete countryStyle.color;\n        if (Object.keys(countryStyle).length == 0) {\n          delete  this._worldLayer.params.countryStyle[country];\n        }\n      }\n    } else {\n      if (!wantsDefault) {\n        modified = true;\n        countryStyle = this._worldLayer.params.countryStyle[country] = {\n          color: c\n        };\n      }\n    }\n    if (modified) {\n      this.modified(ModificationEvent.MapColor);\n    }\n  }\n\n  countryColor(country: string) {\n    if (this._worldLayer\n        && this._worldLayer.params.countryStyle[country]\n        && this._worldLayer.params.countryStyle[country].color) {\n      return this._worldLayer.params.countryStyle[country].color;\n    }\n    return this._seqTrip.landColor();\n  }\n\n  tunedCountries() : string[] {\n    if (this._worldLayer) {\n      return Object.keys(this._worldLayer.params.countryStyle);\n    } else {\n      return [];\n    }\n  }\n\n  selectNode(node: TripNode) {\n    this.clearSelection();\n\n    if (node) {\n      if (!node.properties) {\n        node.properties = { };\n      }\n      if (node.name in this._graph.nodes) {\n        this._selectedNode = this._graph.nodes[node.name];\n      }\n\n      if (node !== this._editor.selectedLabel) {\n        const savedCallback = this._editor.onLabelSelect;\n        const savedBezierCallback = this._editor.onBezierSelect;\n        this._editor.onLabelSelect = () => {};\n        this._editor.onBezierSelect = () => {};\n        if (node.name in this._editor.graph.nodes) {\n          this._editor.selectLabel(node);\n        } else {\n          this._editor.deselectLabel();\n        }\n        this._editor.onLabelSelect = savedCallback;\n        this._editor.onBezierSelect = savedBezierCallback;\n      }\n    }\n  }\n\n  isNodeSelected(node: TripNode) {\n    return (this._selectedNode && node\n        && this._selectedNode.properties === node.properties)\n        || (this._selectedEdge && this._selectedEdge.from.match(node.name));\n  }\n\n  selectEdge(edge: TripEdge) {\n    this.clearSelection();\n    this._selectedEdge = edge;\n  }\n\n  isEdgeSelected(edge: TripEdge) {\n    return this._selectedEdge && this._selectedEdge.properties === edge.properties;\n  }\n\n  nodeNames(): string[] {\n    return Object.keys(this._graph.nodes);\n  }\n\n  nodeArray(): TripNode[] {\n    const r: TripNode[] = [];\n    for (let k of Object.keys(this._graph.nodes)) {\n      r.push(this._graph.nodes[k]);\n    }\n    return r;\n  }\n\n  isSkipped(node: TripNode): boolean {\n    if (!node.properties || node.properties.skip === undefined) {\n      return false;\n    }\n    return node.properties.skip;\n  }\n\n  toggleHideEdge(edge: TripEdge) {\n    if (edge.properties.hidden) {\n      delete edge.properties.hidden;\n\n      for (let node of this._visitedPlaceList) {\n        if ((node.name == edge.from || node.name == edge.to)\n            && this.isSkipped(node)) {\n          this.toggleSkipNode(node);\n        }\n      }\n    } else {\n      edge.properties.hidden = true;\n    }\n    this.modified(ModificationEvent.Edge);\n  }\n\n  toggleSkipNode(node: TripNode) {\n    if (this.isSkipped(node)) {\n      delete node.properties.skip;\n    } else {\n      if (!node.properties) {\n        node.properties = { skip: true };\n      } else {\n        node.properties.skip = true;\n      }\n      /*\n      for (let edge of this._stages) {\n        if (edge.from == node.name || edge.to == node.name) {\n          edge.properties.hidden = true;\n        }\n      }\n     */\n    }\n    this.modified(ModificationEvent.Node);\n  }\n\n  toggleProperty(node: TripNode, property: string) {\n    node.properties[property] = !node.properties[property];\n    this.modified(ModificationEvent.Node);\n  }\n\n  setProperty(node: TripNode, property: string, value: any, ev: any) {\n    if (value !== undefined) {\n      node.properties[property] = value;\n    } else {\n      if (property in node.properties) {\n        delete node.properties[property];\n      }\n    }\n    this.modified(ModificationEvent.NodeStyle);\n  }\n\n  setNodeLabel(node: TripNode, newLabel: string) {\n    const oldLabel = node.label;\n    if (oldLabel === newLabel) {\n      return;\n    }\n    this._seqTrip.renameNodes(node.name, oldLabel, newLabel);\n    console.log('Renaming: \"' + oldLabel + '\" into \"' + newLabel + '\"');\n    const graph = this._graph;\n    for (let i in graph.nodes) {\n      let n = graph.nodes[i];\n      if (n.place === node || n.allPlaces.indexOf(node) >= 0) {\n        n.label = n.label.replace(oldLabel, newLabel);\n      }\n    }\n    node.label = newLabel;\n    this.modified(ModificationEvent.Label);\n  }\n\n  removeEdge(edge: TripEdge) {\n    const compareEdges =\n      (e: TripEdge) => e.from !== edge.from || e.to !== edge.to;\n\n    this._graph.edges = this._graph.edges.filter(compareEdges);\n    this._editor.graph.edges = this._editor.graph.edges.filter(compareEdges);\n  }\n\n  uiSetFrame(width?: number, height?: number) {\n    this.setFrame(width, height);\n    this.modified(ModificationEvent.Frame);\n    this.autoPlaceLabels();\n  }\n\n  setFrame(width?: number, height?: number) {\n    if (!this._renderer) {\n      return;\n    }\n\n    const w = this._canvasWidth;\n    const h = this._canvasHeight;\n\n    // Making a new graph makes sure to split all fused places first.\n    const newLocation = this._seqTrip.makeGraph().location(w / h, 1.2);\n    this._seqTrip.setLocation(newLocation);\n    this._renderer.setLocation(newLocation);\n  }\n\n  setMapboxLocation(loc: Location) {\n    this.mapview.setMapboxLocation(loc);\n  }\n\n\n  getLocation(): Location {\n    return this._renderer.getLocation();\n  }\n\n  autoPlaceLabels() {\n    this._seqTrip.clearUserPlacements();\n    this.placeLabels(false);\n  }\n\n  placeLabels(preferLastPosition: boolean) {\n    if (!this._tripLayer || !this._renderer || !this._seqTrip) {\n      return;\n    }\n    this.runBlockingTask((done: () => void) => {\n      this._tripLayer.placeLabels(this._renderer.canvas.getContext('2d'), preferLastPosition);\n      this.modified(ModificationEvent.LabelMoved);\n      this.mapview.refresh();\n      done();\n    });\n  }\n\n  runBlockingTask(task:(done: () => void) => void) {\n    this._showSpinner = true;\n\n    // make sure the interface updates\n    setTimeout(() => {\n      try {\n        task(() => { this._showSpinner = false; });\n      } catch (err) {\n        // make sure to hide the spinner even if there is an exception\n        this._showSpinner = false;\n        console.log(err);\n      }\n    }, 30);\n  }\n\n  update() {\n    this.placeLabels(true);\n  }\n\n  resetCurves() {\n    const graph = this._graph;\n\n    graph.createDefaultBezier();\n    const fused = this._seqTrip.makeGraph(this._tripLayer);\n\n    this._graph = fused;\n    this._tripLayer.graph = fused;\n    this._editor.graph = fused;\n\n    this._tripLayer.placeLabels(this._renderer.canvas.getContext('2d'), true);\n    this.mapview.refresh();\n    this.modified(ModificationEvent.CurveMoved);\n  }\n\n  makeGraph() {\n    this._graph =\n      this._seqTrip.makeGraph(this._tripLayer);\n    if (this._tripLayer) {\n      this._tripLayer.graph = this._graph;\n    } else {\n      console.log('Warning: makeGraph called before this._tripLayer is ready.');\n    }\n    if (this._editor) {\n      this._editor.graph = this._graph;\n    }\n    this._interleaved = this.interleavedPlacesAndEvents();\n  }\n\n  recreate() {\n    if (this._visitedPlaceList.length) {\n      this.makeGraph();\n      this._seqTrip.markFirstLocation();\n      this.placeLabels(true);\n    }\n  }\n\n  reset() {\n    if (this._visitedPlaceList.length) {\n      this.makeGraph();\n      this.setFrame();\n      this.placeLabels(false);\n    }\n  }\n\n  uiSetPageSize(pageSizeName: string, placeLabels?: boolean) {\n    this.setPageSize(pageSizeName, placeLabels);\n    this.modified(ModificationEvent.PageSize);\n  }\n\n  setPageSize(pageSizeName: string, placeLabels?: boolean) {\n    const pageSize = this._pageSizeMap[pageSizeName];\n    if (pageSize) {\n      this._pageSizeName = pageSizeName;\n      const width = pageSize.widthPt();\n      const height = pageSize.heightPt();\n\n      const factor = 1.1;\n      this._canvasWidth = width * factor;\n      this._canvasHeight = height * factor;\n      this._seqTrip.setSize(pageSize.name, pageSize.width_mm, pageSize.height_mm);\n      if (placeLabels !== false) {\n        this.setFrame(this._canvasWidth, this._canvasHeight);\n        setTimeout(() => { this.placeLabels(true); }, 20);\n      }\n    }\n    if (this.mapview) {\n      setTimeout(() => {\n        this.mapview.resize();\n      }, 0);\n    }\n  }\n\n  setLayerColors() {\n    this.mapview.setLayerColors(this._seqTrip);\n  }\n\n  setSeaColor(c: string) {\n    if (c != this._seqTrip.seaColor()) {\n      this._seqTrip.setSeaColor(c);\n      //this._worldLayer.params.seaColor = c;\n      this.setLayerColors();\n      this.modified(ModificationEvent.MapColor);\n    }\n  }\n  setBorderColor(c: string) {\n    if (c != this._seqTrip.borderColor()) {\n      this._seqTrip.setBorderColor(c);\n      this.setLayerColors();\n      //this._worldLayer.params.borderColor = c;\n      this.modified(ModificationEvent.MapColor);\n    }\n  }\n  setLandColor(c: string) {\n    if (c != this._seqTrip.landColor()) {\n      this._seqTrip.setLandColor(c);\n      this.setLayerColors();\n      //this._worldLayer.params.landColor = c;\n      this.modified(ModificationEvent.MapColor);\n    }\n  }\n  toggleShowRiver() {\n    this._seqTrip.toggleShowRiver();\n    this._worldLayer.params.showRivers = this._seqTrip.showRivers();\n    this.modified(ModificationEvent.MapColor);\n  }\n\n  fetchMap() : Promise<any> {\n    const params = globalMapParams();\n    if (params.map_settings) {\n      return Promise.resolve(params.map_settings);\n    }\n\n    return new Promise((resolve, reject) => {\n      this.http.get(params.map_settings_url, { responseType: 'json' })\n        .subscribe((data: any[]) => {\n          resolve(data);\n        },\n        (err: any) => { reject(err); });\n    });\n  }\n\n  /* The data flow is the following:\n   *\n   * existing map?\n   *   yes => update with locations, done.\n   *   no => #locations > 0 ?\n   *     no => ask the user to populate the field\n   *     yes => generate a new map from locations, save it.\n   */\n  loadMap() {\n    this._loadingMap = true;\n    this.fetchMap().then((data) => {\n        try {\n          this._seqTrip.load(data);\n          this._seqTrip.setLanguage(globalMapParams().language);\n          this._saved = true;\n          this._visitedPlaceList = this._seqTrip.places();\n          this._stages = this._seqTrip.stages();\n          this._interleaved = this.interleavedPlacesAndEvents();\n\n          return this.fetchLocations().then((locations) => {\n            if (locations) {\n              this.updateWithLocations(locations);\n            }\n          }).catch((err) => {\n            this.handleError(err);\n          });\n        } catch(e) {\n          // This error occurs when no map exists (seqTrip.load will throw).\n          // This is totally Ok, we just have to make a new map.\n          return this.fetchLocationsAndGenerateMap();\n        }\n      })\n    .then(() => this.pushSeqTripToCanvas(false))\n    .then(() => {\n        this.prepareCanvas(() => {\n            if (this._runAfterInit) {\n              this._runAfterInit();\n            }\n            this._loadingMap = false;\n        });\n     })\n    .catch((err) => {\n      this.pushSeqTripToCanvas(false);\n      this.prepareCanvas(() => { this._loadingMap = false; });\n      this.handleError(err);\n     });\n  }\n\n  isReady() : boolean {\n    return (!this._loadingMap) && this.mapview.isReady();\n  }\n\n  fetchLocationsAndGenerateMap() {\n    return this.fetchLocations()\n      .then((locations) => {\n        if (locations.length > 0) {\n          this.generateFromLocations(locations);\n        }\n      })\n  }\n\n  saveMap() {\n    const sel = this.clearAndSaveSelection();\n    if (this._editor) {\n      this._editor.deselectLabel();\n    }\n    // before we can save, we have to propagate edge edits in the graph to _seqTrip.\n    // TODO: improve the design for that.\n    if (this._graph) {\n      for (let e of this._graph.edges) {\n        e.propagateToOriginal();\n      }\n    }\n\n    const url = globalMapParams().map_settings_url;\n\n    if (!url) {\n      this._saved = true;\n    } else {\n      $.ajax({\n          type: 'PUT',\n          url: url,\n          dataType: 'text',\n          contentType: \"application/json\",\n          data: JSON.stringify({ _method: 'PUT', map_data: JSON.stringify(this._seqTrip.save()) }),\n          success: () => { this._saved = true; this._errorMessage = undefined; },\n          error: (jqXHR: any, textStatus: string, errorThrown: string ) => {\n            this.handleError(\"Error: Can't save map. Please check your internet connection.\");\n          }\n      });\n    }\n\n    this.restoreSelection(sel);\n  }\n\n  private handleError (error: any) {\n    // In a real world app, we might use a remote logging infrastructure\n    let errMsg: string;\n    if (typeof(error) == 'object') {\n      errMsg =  '' + ('message' in error ? error.message : error);\n    } else if (typeof(error) == 'string') {\n      errMsg = error;\n    } else {\n      errMsg = 'Undefined error';\n    }\n    console.log(error);\n    this._infoMessage = undefined;\n    this._errorMessage = errMsg;\n  }\n\n  nodePropertiesChanged() {\n    this.modified(ModificationEvent.LabelProperties)\n    this.modified(ModificationEvent.NodeStyle)\n  }\n\n  edgePropertiesChanged(edge?: TripEdge) {\n    this.modified(ModificationEvent.EdgeProperties)\n  }\n\n  modified(what: ModificationEvent) {\n    if (this._loadingMap) {\n      return;\n    }\n\n    this._saved = false;\n\n    if (what == ModificationEvent.Location) {\n      this.mapview.updateCanvas();\n    } else {\n      this.mapview.refresh();\n    }\n\n    switch (what) {\n      case ModificationEvent.UpdatedLocations:\n      case ModificationEvent.LabelMoved:\n      case ModificationEvent.CurveMoved:\n      case ModificationEvent.Location:\n        // no need to refresh: the canvas takes care of it.\n        break;\n\n      case ModificationEvent.NodeStyle:\n      case ModificationEvent.LabelProperties:\n      case ModificationEvent.EdgeProperties:\n      case ModificationEvent.MapColor:\n        this._seqTrip.markFirstLocation();\n        this.mapview.refresh();\n        break;\n\n      case ModificationEvent.Label:\n        this.placeLabels(true);\n        break;\n\n      case ModificationEvent.Node:\n      case ModificationEvent.Edge:\n      case ModificationEvent.Frame:\n        // replace labels, but preserve map frame\n        this.recreate();\n        break;\n\n      case ModificationEvent.PageSize:\n        // set page size already resets everything, including map frame\n        break;\n    }\n\n    if (this._saveTimeout) {\n      clearTimeout(this._saveTimeout);\n    }\n    this._saveTimeout = setTimeout(() => {\n        if (!this._loadingMap) { this.saveMap(); }\n      }, 500);\n  }\n\n  attribution() {\n    if (this.mapview) {\n      return this.mapview.attribution().join('|');\n    }\n    return '';\n  }\n\n  interleavedPlacesAndEvents() {\n    const result : EdgeOrNode[] = [];\n    const edgeStart : { [id: string] : { [id: string] : TripEdge } } = this._seqTrip.stagesAsDict();\n    const placesShown : { [id: string] : TripNode } = {};\n\n    const places = this._visitedPlaceList;\n\n    const addPlace = (p : TripNode) => {\n      if (p.dbid in placesShown) {\n        result.push({ node: placesShown[p.dbid] });\n      } else {\n        placesShown[p.dbid] = p;\n        result.push({ node: p });\n      }\n    };\n\n    const numStages = places.length - 1;\n    for (let i = 0; i < places.length; ++i) {\n      const p = places[i];\n      let toDbId;\n\n      if (i < numStages) {\n         toDbId = places[i + 1].dbid;\n\n        if (p.dbid === toDbId) {\n          continue;\n        }\n      }\n\n      addPlace(p);\n\n      if (toDbId !== undefined) {\n        if (p.dbid in edgeStart && toDbId in edgeStart[p.dbid]) {\n          result[result.length - 1].edge = edgeStart[p.dbid][toDbId];\n        }\n      }\n    }\n\n    return result;\n  }\n\n  download(format, args?) {\n    const randomString = (length) =>\n      Math.round((Math.pow(36, length + 1) - Math.random() * Math.pow(36, length))).toString(36).slice(1);\n\n    const key = randomString(16);\n    const url = globalMapParams().map_print_service_url + 'mapgen/' + key;\n    let pdfUrl = url + '/' + format;\n    if (args) {\n      pdfUrl += '?' +\n        Object.keys(args)\n        .map((key) => encodeURIComponent(key) + '=' + encodeURIComponent(args[key]))\n        .join('&');\n    }\n\n    const data = Object.assign({}, globalMapParams());\n\n    // For printing, no need to pass URL around, pass data.\n    data.map_settings = this._seqTrip.save();\n    if (data.map_settings_url) {\n      delete data.map_settings_url;\n    }\n    if (data.locations_url) {\n      delete data.locations_url;\n    }\n    data.hide_ui = true;  // No need to display interface when printing.\n\n    this.http.post(url, JSON.stringify({ global_map_params: data }), {\n      headers: new HttpHeaders({ 'content-type': 'application/json' })\n      })\n      .subscribe(\n        response => {\n          window.open(pdfUrl);\n        },\n        error => {\n          console.log(error);\n          this.handleError(error.message);\n        }\n      );\n  }\n\n  resetNodeToDefault(node : TripNode) {\n    for (let field of Object.keys(node.properties)) {\n      if (field != 'firstVisited') {\n        delete node.properties[field];\n      }\n    }\n    this.modified(ModificationEvent.Node);\n  }\n\n  resetLabels() {\n    this.fetchLocations().then((locations) => {\n        this.updateWithLocations(locations, { resetLabels: true });\n        this.modified(ModificationEvent.Label);\n      });\n  }\n\n  @HostListener('window:beforeunload', ['$event'])\n  doSomething($event) {\n    if(!this._loadingMap && this._numLocations > 0 && !this._saved) {\n      $event.returnValue='Your data will be lost!';\n    }\n  }\n\n  hideUi() {\n    return globalMapParams().hide_ui || false;\n  }\n\n  allowDrop(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'copy';\n  }\n\n  drag(ev) {\n    ev.preventDefault();\n  }\n\n  readKmlFile(data: string) {\n    const parser = new DOMParser();\n    const kml = parser.parseFromString(data, \"text/xml\");\n    const marks = kml.getElementsByTagName(\"Placemark\");\n\n\n    for (let i = 0; i < marks.length; ++i) {\n      const placemark = marks[i];\n      const name = placemark.getElementsByTagName(\"name\")[0].textContent;\n      const coords = placemark.getElementsByTagName(\"coordinates\")[0]\n        .textContent.split(\",\").map(parseFloat) ;\n\n      let n = parseInt(name);\n      if (isNaN(n)) {\n        n = i + 1;\n      }\n\n      this._seqTrip.setAdditionalPlace(TripNode.parse({\n        coord: new Point(Utils.latLonToWorld(coords)),\n        name: 'kml-' + n,\n        label: '' + n,\n        properties: {\n          point: false,\n          blackdot: true,\n          numberedName: name.replace(/^[0-9]*\\. */, ''),\n        },\n      }));\n    }\n  }\n\n  readJsonFile(data: string) {\n    try {\n      const geojson = JSON.parse(data);\n\n      for (let feature of geojson) {\n        if (feature.type != 'Feature'\n            || feature.geometry.type != 'Point'\n            || !feature.properties) {\n          continue;\n        }\n\n        const n = feature.properties.index;\n\n        this._seqTrip.setAdditionalPlace(TripNode.parse({\n          coord: new Point(Utils.latLonToWorld(feature.geometry.coordinates)),\n          name: 'kml-' + n,\n          label: '' + n,\n          properties: {\n            point: false,\n            blackdot: true,\n            numberedName: feature.properties.name,\n            articleId: feature.properties.articleID,\n          },\n        }));\n      }\n    } catch(err) {\n      console.log(err);\n    }\n  }\n\n  drop(ev) {\n    ev.stopPropagation();\n    ev.preventDefault();\n\n    if (!this._kmlReader) {\n      this._kmlReader = new FileReader();\n      this._kmlReader.onload = (event: Event) => {\n          this._seqTrip.filterAdditionalPlace((node: TripNode) => !node.name.match(/^kml-/));\n          const data = this._kmlReader.result;\n          if (data[0] == '[') {\n            this.readJsonFile(data);\n          } else {\n            this.readKmlFile(data);\n          }\n\n          this.makeGraph();\n          this.placeLabels(false);\n          this.modified(ModificationEvent.Label);\n        };\n    }\n    if (ev.dataTransfer && ev.dataTransfer.files.length > 0) {\n      this._kmlReader.readAsText(ev.dataTransfer.files[0]);\n    }\n  }\n\n  hasMark(node: TripNode): boolean {\n    const prop = node.properties;\n    if (!prop) {\n      return false;\n    }\n    if (node.properties.markStyle) {\n      return node.properties.markStyle == 'first';\n    }\n    return !!node.properties.firstVisited;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/trip-map.component.ts","import {Point, IPoint } from './point';\nimport { BoundingBox } from './bounding-box';\nimport { PinchZoom } from './tiles';\nimport { TripEdgeProperties } from './trip-edge';\n\nexport interface TripNodeProperties {\n  point?: boolean;\n  leaderLine?: string;\n  dashed?: number[];\n  leaderLineWidth?: number;\n  maxLeaderLineLength?: number;\n  labelBbox?: BoundingBox;\n  radius?: number;\n  leaderLineAnchor?: Point;\n  leaderLineAnchorPixelOffset?: Point;\n  labelColor?: string;\n\n  // labelCoord is expressed in map coordinates.\n  // It is obsolete.\n  // labelCoord = unproject(project(coord) + labelPixelOffset)\n  labelCoord?: Point;\n  userPlacement?: Point;  // same thing, osbolete\n\n  // labelPixelOffset = project(labelCoord) - project(coord)\n  labelPixelOffset?: Point;\n  userPlacementPixelOffset?: Point;\n\n  frame?: string;\n  leaderLineColor?: string;\n  fontSize?: number;\n  font?: string;\n  stroke?: string;\n  haloWidth?: number;\n  fill?: string;\n  textOffset?: number;\n  textPlacement?: string;\n  skip?: boolean;\n  landing?: boolean;\n  takeoff?: boolean;\n  markStyle?: string;\n  firstVisited?: boolean;\n  blackdot?: boolean;  // show a black dot under label (for KML import)\n\n  numberedName?: string;\n  articleId?: number | string;\n}\n\nexport interface ITripNode {\n  coord: IPoint | number[];\n  dbid?: number;\n  name?: string;\n  label?: string;\n  labelIcon?: {\n    url: string;\n    width?: number;\n    height?: number;\n    autorotate?: number;\n    angle?: number;\n    ratioX?: number;\n    ratioY?: number;\n  };\n  properties?: TripNodeProperties;\n\n  viewerPos?: Point;\n  place?: TripNode;\n}\n\nexport class TripNode implements ITripNode {\n  coord: Point;\n  dbid?: number;\n  name?: string;\n  label?: string;\n  labelIcon?: {\n    url: string;\n    width?: number;\n    height?: number;\n    autorotate?: number;\n    angle?: number;\n    ratioX?: number;\n    ratioY?: number;\n  };\n  properties?: TripNodeProperties;\n\n  viewerPos?: Point;\n  place?: TripNode;\n  allPlaces: TripNode[];\n\n  followingEdgeProp?: TripEdgeProperties;\n\n  constructor() {\n    this.allPlaces = [];\n  };\n\n  static parse(obj: any): TripNode {\n    const r = new TripNode();\n    r.coord = new Point(obj.coord);\n    if (obj.place) {\n      obj.place = TripNode.parse(obj.place);\n    }\n    if (obj.viewerPos) {\n      r.viewerPos = new Point(obj.viewerPos);\n    }\n    for (let m of ['dbid', 'name', 'label', 'labelIcon', 'properties']) {\n      if (obj[m]) {\n        r[m] = obj[m];\n      }\n    }\n    if (!r.name) {\n      if (r.dbid !== undefined) {\n        r.name = '' + r.dbid;\n      } else if (r.label) {\n        r.name = r.label;\n      }\n    }\n\n    r.properties = obj.properties || {};\n\n    if (r.properties.labelBbox) {\n      r.properties.labelBbox = new BoundingBox(r.properties.labelBbox);\n    }\n    if (r.properties.leaderLineAnchor) {\n      r.properties.leaderLineAnchor = new Point(r.properties.leaderLineAnchor);\n    }\n    if (r.properties.labelCoord) {\n      r.properties.labelCoord = new Point(r.properties.labelCoord);\n    }\n    if (r.properties.labelPixelOffset) {\n      r.properties.labelPixelOffset = new Point(r.properties.labelPixelOffset);\n    }\n\n    return r;\n  }\n\n  isSkipped():boolean {\n    if (this.label\n        && (!this.properties || this.properties.skip === undefined)) {\n      return false;\n    }\n    return this.properties.skip;\n  }\n\n  labelPixelPos(pinchZoom: PinchZoom, pixelRatio: number): Point {\n    let pos: Point;\n    if (this.properties && this.properties.labelPixelOffset) {\n      // new style\n      pos = Point.plus(\n          pinchZoom.viewerPosFromWorldPos(this.coord),\n          Point.times(pixelRatio, this.properties.labelPixelOffset));\n    } else {\n      // old style labelCoord, or coord directly\n      pos = pinchZoom.viewerPosFromWorldPos(\n        (this.properties && this.properties.labelCoord ?\n         this.properties.labelCoord : this.coord));\n    }\n    return pos;\n  }\n\n  leaderLineAnchorPos(pinchZoom: PinchZoom, pixelRatio: number): Point | undefined {\n    if (!this.properties\n        || (!this.properties.leaderLineAnchor &&\n            !this.properties.leaderLineAnchorPixelOffset)) {\n      return;\n    }\n    if (this.properties.leaderLineAnchorPixelOffset) { \n      return Point.plus(\n          pinchZoom.viewerPosFromWorldPos(this.coord),\n          Point.times(pixelRatio, this.properties.leaderLineAnchorPixelOffset));\n    }\n    return pinchZoom.viewerPosFromWorldPos(this.properties.leaderLineAnchor);\n  }\n\n  convertToPixelOffset(pinchZoom: PinchZoom, pixelRatio: number) {\n    if (this.properties.labelCoord) {\n      if (!this.properties.labelPixelOffset) {\n        // labelPixelOffset = project(labelCoord) - project(coord)\n        this.properties.labelPixelOffset = Point.minus(\n          pinchZoom.viewerPosFromWorldPos(this.properties.labelCoord),\n          pinchZoom.viewerPosFromWorldPos(this.coord)).mul(1 / pixelRatio);\n      }\n      delete this.properties.labelCoord;\n    }\n\n    if (this.properties.leaderLineAnchor) {\n      if (!this.properties.leaderLineAnchorPixelOffset) {\n        this.properties.leaderLineAnchorPixelOffset =\n          Point.minus(\n            pinchZoom.viewerPosFromWorldPos(this.properties.leaderLineAnchor),\n            pinchZoom.viewerPosFromWorldPos(this.coord)).mul(1 / pixelRatio);\n      }\n      delete this.properties.leaderLineAnchor;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/trip-node.ts","module.exports = \"<mapview #mapview\\n    style=\\\"display:block;\\\"\\n    [style.width.px]=\\\"width\\\"\\n    [style.height.px]=\\\"height\\\"\\n    [canvasWidth]=\\\"width\\\"\\n    [canvasHeight]=\\\"height\\\"\\n    [compactAttribution]=\\\"false\\\"\\n    [lang]=\\\"language\\\"\\n    ></mapview>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./frontend/map_editor/src/app/trip-map/view-seq.component.html\n// module id = ./frontend/map_editor/src/app/trip-map/view-seq.component.html\n// module chunks = main","import { AfterViewInit, Input, Component, ViewChild, ElementRef, HostListener } from '@angular/core';\n\nimport { CanvasTilesRenderer } from './tiles';\nimport { GetSeqTrip } from './some_map';\nimport { PageSize } from './page-size';\nimport { SeqTrip } from './seq-trip';\nimport { TripGraphLayer } from './trip-graph-layer';\n\ndeclare var tripLanguage;\n\n@Component({\n  selector: 'view-seq',\n  templateUrl: 'view-seq.component.html',\n})\nexport class ViewSeqComponent implements AfterViewInit {\n  @ViewChild('mapview') mapview;\n\n  public width = 1024;\n  public height = 1024;\n  private trip: SeqTrip;\n  public language: string;\n\n  constructor() {\n    this.trip = GetSeqTrip();\n    this.width = this.trip.width_mm() * PageSize.mmToPoint;\n    this.height = this.trip.height_mm() * PageSize.mmToPoint;\n    this.language = (window as any).tripLanguage || this.trip.language();\n  }\n  ngAfterViewInit() {\n    this.mapview.prepareCanvas({\n      trip: this.trip\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/app/trip-map/view-seq.component.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/environments/environment.ts","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { enableProdMode } from '@angular/core';\nimport { environment } from './environments/environment';\nimport { AppModule } from './app/app.module';\n\nif (true || environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// ./frontend/map_editor/src/main.ts"],"sourceRoot":"webpack:///"}